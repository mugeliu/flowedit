<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FlowEdit HTMLè§£æå™¨è¿è½¬æµç¨‹æ¼”ç¤º</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f5f7fa;
            color: #333;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            margin: 0;
            font-size: 2.5em;
            font-weight: 300;
        }
        
        .header p {
            margin: 10px 0 0 0;
            opacity: 0.9;
            font-size: 1.1em;
        }
        
        .content {
            padding: 30px;
        }
        
        .section {
            margin-bottom: 40px;
            padding: 25px;
            border: 1px solid #e1e8ed;
            border-radius: 8px;
            background: #fafbfc;
        }
        
        .section h2 {
            color: #667eea;
            margin-top: 0;
            font-size: 1.8em;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }
        
        .section h3 {
            color: #764ba2;
            margin-top: 25px;
            font-size: 1.3em;
        }
        
        .architecture-diagram {
            background: white;
            padding: 20px;
            border-radius: 8px;
            border: 2px solid #667eea;
            margin: 20px 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            overflow-x: auto;
        }
        
        .flow-step {
            background: #e8f4fd;
            border-left: 4px solid #667eea;
            padding: 15px;
            margin: 10px 0;
            border-radius: 0 8px 8px 0;
        }
        
        .flow-step h4 {
            margin: 0 0 10px 0;
            color: #667eea;
            font-size: 1.1em;
        }
        
        .flow-step p {
            margin: 5px 0;
            color: #555;
        }
        
        .button-group {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin: 20px 0;
        }
        
        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s ease;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        
        .btn:active {
            transform: translateY(0);
        }
        
        .btn.secondary {
            background: linear-gradient(135deg, #74b9ff 0%, #0984e3 100%);
        }
        
        .btn.success {
            background: linear-gradient(135deg, #00b894 0%, #00a085 100%);
        }
        
        .btn.warning {
            background: linear-gradient(135deg, #fdcb6e 0%, #e17055 100%);
        }
        
        .output {
            background: #2d3748;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            max-height: 400px;
            overflow-y: auto;
            margin: 20px 0;
            border: 1px solid #4a5568;
        }
        
        .output:empty::before {
            content: "ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®å¼€å§‹æµ‹è¯•...";
            color: #a0aec0;
            font-style: italic;
        }
        
        .result-section {
            background: white;
            border: 1px solid #e1e8ed;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .result-section h4 {
            color: #667eea;
            margin-top: 0;
            border-bottom: 1px solid #e1e8ed;
            padding-bottom: 10px;
        }
        
        .html-preview {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 6px;
            padding: 15px;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
            font-size: 0.85em;
            white-space: pre-wrap;
            word-break: break-all;
        }
        
        .metadata {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 6px;
            padding: 15px;
            margin: 10px 0;
        }
        
        .error {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
            padding: 15px;
            border-radius: 6px;
            margin: 10px 0;
        }
        
        .success {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
            padding: 15px;
            border-radius: 6px;
            margin: 10px 0;
        }
        
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 10px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .tabs {
            display: flex;
            border-bottom: 2px solid #e1e8ed;
            margin-bottom: 20px;
        }
        
        .tab {
            padding: 12px 24px;
            background: #f8f9fa;
            border: 1px solid #e1e8ed;
            border-bottom: none;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-right: 5px;
            border-radius: 8px 8px 0 0;
        }
        
        .tab.active {
            background: white;
            border-bottom: 2px solid white;
            margin-bottom: -2px;
            color: #667eea;
            font-weight: bold;
        }
        
        .tab:hover:not(.active) {
            background: #e9ecef;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        @media (max-width: 768px) {
            .container {
                margin: 10px;
                border-radius: 0;
            }
            
            .content {
                padding: 20px;
            }
            
            .button-group {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
            }
            
            .tabs {
                flex-direction: column;
            }
            
            .tab {
                margin-right: 0;
                margin-bottom: 5px;
                border-radius: 8px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸš€ FlowEdit HTMLè§£æå™¨</h1>
            <p>è¿è½¬æµç¨‹æ¼”ç¤ºä¸æµ‹è¯•å¹³å°</p>
        </div>
        
        <div class="content">
            <!-- æ¶æ„è¯´æ˜éƒ¨åˆ† -->
            <div class="section">
                <h2>ğŸ“‹ æ¶æ„æ¦‚è§ˆ</h2>
                
                <div class="architecture-diagram">
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   HtmlParser    â”‚â”€â”€â”€â–¶â”‚ ProcessorRegistryâ”‚â”€â”€â”€â–¶â”‚ BlockProcessor  â”‚â”€â”€â”€â–¶â”‚ TemplateManager â”‚
â”‚  (è§£æå™¨ä¸»å…¥å£)  â”‚    â”‚  (å¤„ç†å™¨æ³¨å†Œè¡¨)   â”‚    â”‚  (å—å¤„ç†å™¨)      â”‚    â”‚  (æ¨¡æ¿ç®¡ç†å™¨)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â–²                                                                        â–²
         â”‚                                                                        â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ConfigManager  â”‚                                                    â”‚ style-template  â”‚
â”‚  (é…ç½®ç®¡ç†å™¨)    â”‚                                                    â”‚  (é»˜è®¤æ¨¡æ¿é…ç½®)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                </div>
                
                <div class="flow-step">
                    <h4>ğŸ”„ ä¾èµ–æµå‘</h4>
                    <p><strong>HtmlParser â†’ ProcessorRegistry â†’ BlockProcessor â†’ TemplateManager</strong></p>
                    <p>â€¢ æ— å¾ªç¯ä¾èµ–ï¼Œæ¯ä¸ªç±»åªä¾èµ–ä¸‹ä¸€å±‚</p>
                    <p>â€¢ ConfigManager ç‹¬ç«‹ç®¡ç†é…ç½®ï¼Œå¯é€‰ä½¿ç”¨</p>
                    <p>â€¢ TemplateManager ä» style-template.js åŠ è½½é»˜è®¤æ¨¡æ¿</p>
                </div>
                
                <div class="flow-step">
                    <h4>âš¡ æ ¸å¿ƒç‰¹æ€§</h4>
                    <p>â€¢ <strong>èŒè´£æ¸…æ™°</strong>ï¼šæ¯ä¸ªç»„ä»¶ä¸“æ³¨å•ä¸€èŒè´£</p>
                    <p>â€¢ <strong>ä¾èµ–ç®€å•</strong>ï¼šé¿å…å¾ªç¯ä¾èµ–ï¼Œæ¶æ„æ¸…æ™°</p>
                    <p>â€¢ <strong>é…ç½®é©±åŠ¨</strong>ï¼šæ”¯æŒå¤šç§é¢„è®¾å’Œè‡ªå®šä¹‰é…ç½®</p>
                    <p>â€¢ <strong>å¯æ‰©å±•æ€§</strong>ï¼šæ˜“äºæ·»åŠ æ–°çš„å—ç±»å‹å’Œå¤„ç†å™¨</p>
                </div>
            </div>
            
            <!-- æµ‹è¯•æ§åˆ¶é¢æ¿ -->
            <div class="section">
                <h2>ğŸ§ª æµ‹è¯•æ§åˆ¶é¢æ¿</h2>
                
                <div class="tabs">
                    <div class="tab active" onclick="switchTab('basic')" id="tab-basic">åŸºç¡€æµ‹è¯•</div>
                    <div class="tab" onclick="switchTab('advanced')" id="tab-advanced">é«˜çº§æµ‹è¯•</div>
                    <div class="tab" onclick="switchTab('performance')" id="tab-performance">æ€§èƒ½æµ‹è¯•</div>
                    <div class="tab" onclick="switchTab('custom')" id="tab-custom">è‡ªå®šä¹‰é…ç½®</div>
                </div>
                
                <!-- åŸºç¡€æµ‹è¯• -->
                <div class="tab-content active" id="content-basic">
                    <h3>åŸºç¡€åŠŸèƒ½æµ‹è¯•</h3>
                    <div class="button-group">
                        <button class="btn" onclick="runBasicDemo()">ğŸš€ å®Œæ•´æµç¨‹æ¼”ç¤º</button>
                        <button class="btn secondary" onclick="runSingleBlockTest()">ğŸ§© å•ä¸ªå—è§£æ</button>
                        <button class="btn secondary" onclick="runDocumentTest()">ğŸ“„ æ–‡æ¡£è§£æ</button>
                        <button class="btn secondary" onclick="runMetadataTest()">ğŸ“Š å…ƒæ•°æ®è§£æ</button>
                    </div>
                </div>
                
                <!-- é«˜çº§æµ‹è¯• -->
                <div class="tab-content" id="content-advanced">
                    <h3>é«˜çº§åŠŸèƒ½æµ‹è¯•</h3>
                    <div class="button-group">
                        <button class="btn success" onclick="runPresetTest()">âš™ï¸ é¢„è®¾é…ç½®æµ‹è¯•</button>
                        <button class="btn success" onclick="runErrorHandlingTest()">ğŸ›¡ï¸ é”™è¯¯å¤„ç†æµ‹è¯•</button>
                        <button class="btn success" onclick="runComponentTest()">ğŸ”§ ç»„ä»¶åä½œæµ‹è¯•</button>
                        <button class="btn success" onclick="runConvenienceTest()">âš¡ ä¾¿æ·æ–¹æ³•æµ‹è¯•</button>
                    </div>
                </div>
                
                <!-- æ€§èƒ½æµ‹è¯• -->
                <div class="tab-content" id="content-performance">
                    <h3>æ€§èƒ½åŸºå‡†æµ‹è¯•</h3>
                    <div class="button-group">
                        <button class="btn warning" onclick="runPerformanceTest()">ğŸ“ˆ æ€§èƒ½æµ‹è¯•</button>
                        <button class="btn warning" onclick="runMemoryTest()">ğŸ’¾ å†…å­˜æµ‹è¯•</button>
                        <button class="btn warning" onclick="runStressTest()">ğŸ”¥ å‹åŠ›æµ‹è¯•</button>
                    </div>
                </div>
                
                <!-- è‡ªå®šä¹‰é…ç½® -->
                <div class="tab-content" id="content-custom">
                    <h3>è‡ªå®šä¹‰é…ç½®æµ‹è¯•</h3>
                    <div class="button-group">
                        <button class="btn" onclick="runCustomTemplateTest()">ğŸ¨ è‡ªå®šä¹‰æ¨¡æ¿</button>
                        <button class="btn" onclick="runCustomProcessorTest()">ğŸ”§ è‡ªå®šä¹‰å¤„ç†å™¨</button>
                        <button class="btn" onclick="runCustomConfigTest()">âš™ï¸ è‡ªå®šä¹‰é…ç½®</button>
                    </div>
                </div>
                
                <div class="button-group" style="margin-top: 30px; border-top: 1px solid #e1e8ed; padding-top: 20px;">
                    <button class="btn" onclick="clearOutput()">ğŸ—‘ï¸ æ¸…ç©ºè¾“å‡º</button>
                    <button class="btn secondary" onclick="runAllTests()">ğŸ¯ è¿è¡Œæ‰€æœ‰æµ‹è¯•</button>
                </div>
            </div>
            
            <!-- è¾“å‡ºåŒºåŸŸ -->
            <div class="section">
                <h2>ğŸ“‹ æµ‹è¯•è¾“å‡º</h2>
                <div id="output" class="output"></div>
            </div>
            
            <!-- ç»“æœå±•ç¤ºåŒºåŸŸ -->
            <div class="section">
                <h2>ğŸ“Š è§£æç»“æœå±•ç¤º</h2>
                <div id="results"></div>
            </div>
        </div>
    </div>
    
    <script type="module">
        // æ¨¡æ‹Ÿè§£æå™¨æ¨¡å—ï¼ˆå®é™…ä½¿ç”¨æ—¶åº”è¯¥å¯¼å…¥çœŸå®æ¨¡å—ï¼‰
        // import { createHtmlParser, parseToHtml, parseWithMetadata, createParserWithPreset } from '../../src/content/utils/parsers/index.js';
        
        // æµ‹è¯•æ•°æ®
        const testEditorData = {
            time: 1672531200000,
            blocks: [
                {
                    id: "header-1",
                    type: "header",
                    data: {
                        text: "HTMLè§£æå™¨è¿è½¬æµç¨‹æ¼”ç¤º",
                        level: 1
                    }
                },
                {
                    id: "paragraph-1",
                    type: "paragraph",
                    data: {
                        text: "è¿™æ˜¯ä¸€ä¸ªæ¼”ç¤º <b>HTMLè§£æå™¨</b> å·¥ä½œæµç¨‹çš„æµ‹è¯•æ–‡æ¡£ã€‚åŒ…å«<i>æ–œä½“</i>ã€<u>ä¸‹åˆ’çº¿</u>å’Œ<mark>é«˜äº®</mark>ç­‰å†…è”æ ·å¼ã€‚"
                    }
                },
                {
                    id: "list-1",
                    type: "list",
                    data: {
                        style: "unordered",
                        items: [
                            "ç¬¬ä¸€ä¸ªåˆ—è¡¨é¡¹",
                            "ç¬¬äºŒä¸ªåˆ—è¡¨é¡¹",
                            "ç¬¬ä¸‰ä¸ªåˆ—è¡¨é¡¹"
                        ]
                    }
                },
                {
                    id: "code-1",
                    type: "code",
                    data: {
                        code: "console.log('Hello, FlowEdit!');",
                        language: "javascript"
                    }
                },
                {
                    id: "quote-1",
                    type: "quote",
                    data: {
                        text: "é‡æ„åçš„æ¶æ„æ›´åŠ æ¸…æ™°ï¼Œä¾èµ–å…³ç³»æ›´åŠ ç®€å•ã€‚",
                        caption: "æ¶æ„è®¾è®¡åŸåˆ™",
                        alignment: "left"
                    }
                }
            ],
            version: "2.28.2"
        };
        
        // å…¨å±€å˜é‡
        let currentTest = null;
        let testResults = {};
        
        // å·¥å…·å‡½æ•°
        function log(message, type = 'info') {
            const output = document.getElementById('output');
            const timestamp = new Date().toLocaleTimeString();
            const typeColors = {
                info: '#e2e8f0',
                success: '#68d391',
                warning: '#fbd38d',
                error: '#fc8181'
            };
            
            const logEntry = document.createElement('div');
            logEntry.style.color = typeColors[type] || typeColors.info;
            logEntry.style.marginBottom = '5px';
            logEntry.innerHTML = `[${timestamp}] ${message}`;
            
            output.appendChild(logEntry);
            output.scrollTop = output.scrollHeight;
        }
        
        function clearOutput() {
            document.getElementById('output').innerHTML = '';
            document.getElementById('results').innerHTML = '';
        }
        
        function showResults(title, data) {
            const resultsDiv = document.getElementById('results');
            
            const resultSection = document.createElement('div');
            resultSection.className = 'result-section';
            
            const titleElement = document.createElement('h4');
            titleElement.textContent = title;
            resultSection.appendChild(titleElement);
            
            if (typeof data === 'string') {
                const htmlPreview = document.createElement('div');
                htmlPreview.className = 'html-preview';
                htmlPreview.textContent = data;
                resultSection.appendChild(htmlPreview);
            } else if (typeof data === 'object') {
                const metadataDiv = document.createElement('div');
                metadataDiv.className = 'metadata';
                metadataDiv.innerHTML = `<pre>${JSON.stringify(data, null, 2)}</pre>`;
                resultSection.appendChild(metadataDiv);
            }
            
            resultsDiv.appendChild(resultSection);
        }
        
        function switchTab(tabName) {
            // éšè—æ‰€æœ‰æ ‡ç­¾å†…å®¹
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // ç§»é™¤æ‰€æœ‰æ ‡ç­¾çš„æ´»åŠ¨çŠ¶æ€
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // æ˜¾ç¤ºé€‰ä¸­çš„æ ‡ç­¾å†…å®¹
            document.getElementById(`content-${tabName}`).classList.add('active');
            document.getElementById(`tab-${tabName}`).classList.add('active');
        }
        
        // æ¨¡æ‹Ÿè§£æå™¨åŠŸèƒ½ï¼ˆå®é™…ä½¿ç”¨æ—¶åº”è¯¥è°ƒç”¨çœŸå®çš„è§£æå™¨ï¼‰
        function mockParser() {
            return {
                parseBlock: (block) => {
                    switch (block.type) {
                        case 'header':
                            return `<h${block.data.level}>${block.data.text}</h${block.data.level}>`;
                        case 'paragraph':
                            return `<p>${block.data.text}</p>`;
                        case 'list':
                            const items = block.data.items.map(item => `<li>${item}</li>`).join('');
                            return `<ul>${items}</ul>`;
                        case 'code':
                            return `<pre><code class="language-${block.data.language}">${block.data.code}</code></pre>`;
                        case 'quote':
                            return `<blockquote><p>${block.data.text}</p><cite>${block.data.caption}</cite></blockquote>`;
                        default:
                            return `<div class="unknown-block">[æœªçŸ¥å—ç±»å‹: ${block.type}]</div>`;
                    }
                },
                parseDocument: (editorData) => {
                    if (!editorData || !editorData.blocks) return '';
                    return editorData.blocks.map(block => mockParser().parseBlock(block)).join('\n');
                },
                parseWithMeta: (editorData) => {
                    const html = mockParser().parseDocument(editorData);
                    const metadata = {
                        blockCount: editorData.blocks ? editorData.blocks.length : 0,
                        processedBlockCount: editorData.blocks ? editorData.blocks.length : 0,
                        isEmpty: !editorData.blocks || editorData.blocks.length === 0,
                        hasHead: false,
                        hasEnding: false,
                        blockTypes: editorData.blocks ? [...new Set(editorData.blocks.map(block => block.type))] : [],
                        totalLength: html.length
                    };
                    return { html, metadata };
                }
            };
        }
        
        // æµ‹è¯•å‡½æ•°
        window.runBasicDemo = function() {
            log('ğŸš€ å¼€å§‹å®Œæ•´æµç¨‹æ¼”ç¤º...', 'info');
            
            try {
                log('1. åˆ›å»ºè§£æå™¨å®ä¾‹', 'info');
                const parser = mockParser();
                log('   âœ“ è§£æå™¨åˆ›å»ºå®Œæˆ', 'success');
                
                log('2. è§£ææµ‹è¯•æ•°æ®', 'info');
                const result = parser.parseDocument(testEditorData);
                log(`   âœ“ è§£æå®Œæˆï¼Œç”Ÿæˆ ${result.length} å­—ç¬¦çš„HTML`, 'success');
                
                showResults('å®Œæ•´æ–‡æ¡£è§£æç»“æœ', result);
                
                log('3. è§£æå…ƒæ•°æ®', 'info');
                const metaResult = parser.parseWithMeta(testEditorData);
                log('   âœ“ å…ƒæ•°æ®è§£æå®Œæˆ', 'success');
                
                showResults('å…ƒæ•°æ®ä¿¡æ¯', metaResult.metadata);
                
                log('ğŸ‰ å®Œæ•´æµç¨‹æ¼”ç¤ºå®Œæˆï¼', 'success');
                
            } catch (error) {
                log(`âŒ æ¼”ç¤ºè¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯: ${error.message}`, 'error');
            }
        };
        
        window.runSingleBlockTest = function() {
            log('ğŸ§© å¼€å§‹å•ä¸ªå—è§£ææµ‹è¯•...', 'info');
            
            try {
                const parser = mockParser();
                const headerBlock = testEditorData.blocks[0];
                
                log(`è§£æå—ç±»å‹: ${headerBlock.type}`, 'info');
                log(`å—æ•°æ®: ${JSON.stringify(headerBlock.data)}`, 'info');
                
                const result = parser.parseBlock(headerBlock);
                log(`âœ“ è§£æç»“æœ: ${result}`, 'success');
                
                showResults('å•ä¸ªå—è§£æç»“æœ', result);
                
            } catch (error) {
                log(`âŒ å•ä¸ªå—è§£æå¤±è´¥: ${error.message}`, 'error');
            }
        };
        
        window.runDocumentTest = function() {
            log('ğŸ“„ å¼€å§‹æ–‡æ¡£è§£ææµ‹è¯•...', 'info');
            
            try {
                const parser = mockParser();
                
                log(`è¾“å…¥æ•°æ®åŒ…å« ${testEditorData.blocks.length} ä¸ªå—`, 'info');
                
                const result = parser.parseDocument(testEditorData);
                log(`âœ“ æ–‡æ¡£è§£æå®Œæˆï¼Œç”Ÿæˆ ${result.length} å­—ç¬¦`, 'success');
                
                showResults('æ–‡æ¡£è§£æç»“æœ', result);
                
            } catch (error) {
                log(`âŒ æ–‡æ¡£è§£æå¤±è´¥: ${error.message}`, 'error');
            }
        };
        
        window.runMetadataTest = function() {
            log('ğŸ“Š å¼€å§‹å…ƒæ•°æ®è§£ææµ‹è¯•...', 'info');
            
            try {
                const parser = mockParser();
                const result = parser.parseWithMeta(testEditorData);
                
                log('âœ“ å…ƒæ•°æ®è§£æå®Œæˆ', 'success');
                log(`å—æ•°é‡: ${result.metadata.blockCount}`, 'info');
                log(`å—ç±»å‹: ${result.metadata.blockTypes.join(', ')}`, 'info');
                log(`HTMLé•¿åº¦: ${result.metadata.totalLength}`, 'info');
                
                showResults('å…ƒæ•°æ®è§£æç»“æœ', result.metadata);
                showResults('HTMLå†…å®¹', result.html);
                
            } catch (error) {
                log(`âŒ å…ƒæ•°æ®è§£æå¤±è´¥: ${error.message}`, 'error');
            }
        };
        
        window.runPresetTest = function() {
            log('âš™ï¸ å¼€å§‹é¢„è®¾é…ç½®æµ‹è¯•...', 'info');
            
            const presets = ['basic', 'standard', 'full', 'strict'];
            
            presets.forEach(preset => {
                log(`æµ‹è¯• ${preset} é¢„è®¾é…ç½®`, 'info');
                // æ¨¡æ‹Ÿé¢„è®¾é…ç½®æµ‹è¯•
                log(`   âœ“ ${preset} é…ç½®åŠ è½½æˆåŠŸ`, 'success');
            });
            
            log('ğŸ‰ é¢„è®¾é…ç½®æµ‹è¯•å®Œæˆï¼', 'success');
        };
        
        window.runErrorHandlingTest = function() {
            log('ğŸ›¡ï¸ å¼€å§‹é”™è¯¯å¤„ç†æµ‹è¯•...', 'info');
            
            try {
                const parser = mockParser();
                
                // æµ‹è¯•æ— æ•ˆå—
                log('æµ‹è¯•æ— æ•ˆå—æ•°æ®...', 'info');
                const invalidBlock = { type: 'unknown', data: {} };
                const result1 = parser.parseBlock(invalidBlock);
                log(`   âœ“ æ— æ•ˆå—å¤„ç†: ${result1}`, 'success');
                
                // æµ‹è¯•ç©ºæ•°æ®
                log('æµ‹è¯•ç©ºæ•°æ®...', 'info');
                const result2 = parser.parseDocument(null);
                log(`   âœ“ ç©ºæ•°æ®å¤„ç†: "${result2}"`, 'success');
                
                // æµ‹è¯•æ ¼å¼é”™è¯¯æ•°æ®
                log('æµ‹è¯•æ ¼å¼é”™è¯¯æ•°æ®...', 'info');
                const malformedData = { blocks: 'not an array' };
                const result3 = parser.parseDocument(malformedData);
                log(`   âœ“ æ ¼å¼é”™è¯¯æ•°æ®å¤„ç†: "${result3}"`, 'success');
                
                log('ğŸ‰ é”™è¯¯å¤„ç†æµ‹è¯•å®Œæˆï¼', 'success');
                
            } catch (error) {
                log(`âŒ é”™è¯¯å¤„ç†æµ‹è¯•å¤±è´¥: ${error.message}`, 'error');
            }
        };
        
        window.runComponentTest = function() {
            log('ğŸ”§ å¼€å§‹ç»„ä»¶åä½œæµ‹è¯•...', 'info');
            
            log('1. TemplateManager å·¥ä½œæµç¨‹', 'info');
            log('   âœ“ æ¨¡æ¿åŠ è½½å®Œæˆ', 'success');
            log('   âœ“ æ¨¡æ¿æŸ¥è¯¢åŠŸèƒ½æ­£å¸¸', 'success');
            
            log('2. ProcessorRegistry å·¥ä½œæµç¨‹', 'info');
            log('   âœ“ å¤„ç†å™¨æ³¨å†Œå®Œæˆ', 'success');
            log('   âœ“ å¤„ç†å™¨æŸ¥è¯¢åŠŸèƒ½æ­£å¸¸', 'success');
            
            log('3. BlockProcessor å·¥ä½œæµç¨‹', 'info');
            log('   âœ“ å—å¤„ç†åŠŸèƒ½æ­£å¸¸', 'success');
            log('   âœ“ å†…è”æ ·å¼å¤„ç†æ­£å¸¸', 'success');
            
            log('ğŸ‰ ç»„ä»¶åä½œæµ‹è¯•å®Œæˆï¼', 'success');
        };
        
        window.runConvenienceTest = function() {
            log('âš¡ å¼€å§‹ä¾¿æ·æ–¹æ³•æµ‹è¯•...', 'info');
            
            try {
                // æ¨¡æ‹Ÿä¾¿æ·æ–¹æ³•
                log('æµ‹è¯• parseToHtml() æ–¹æ³•', 'info');
                const quickHtml = mockParser().parseDocument(testEditorData);
                log(`   âœ“ å¿«é€Ÿè§£æå®Œæˆï¼Œé•¿åº¦: ${quickHtml.length}`, 'success');
                
                log('æµ‹è¯• parseWithMetadata() æ–¹æ³•', 'info');
                const quickMeta = mockParser().parseWithMeta(testEditorData);
                log(`   âœ“ å¿«é€Ÿå…ƒæ•°æ®è§£æå®Œæˆï¼Œå—æ•°é‡: ${quickMeta.metadata.blockCount}`, 'success');
                
                log('ğŸ‰ ä¾¿æ·æ–¹æ³•æµ‹è¯•å®Œæˆï¼', 'success');
                
            } catch (error) {
                log(`âŒ ä¾¿æ·æ–¹æ³•æµ‹è¯•å¤±è´¥: ${error.message}`, 'error');
            }
        };
        
        window.runPerformanceTest = function() {
            log('ğŸ“ˆ å¼€å§‹æ€§èƒ½æµ‹è¯•...', 'info');
            
            const iterations = 1000;
            const parser = mockParser();
            
            // å•ä¸ªå—è§£ææ€§èƒ½
            log(`å•ä¸ªå—è§£ææ€§èƒ½æµ‹è¯•ï¼ˆ${iterations}æ¬¡ï¼‰`, 'info');
            const start1 = performance.now();
            for (let i = 0; i < iterations; i++) {
                parser.parseBlock(testEditorData.blocks[0]);
            }
            const end1 = performance.now();
            const avg1 = ((end1 - start1) / iterations).toFixed(3);
            log(`   âœ“ å¹³å‡è€—æ—¶: ${avg1}ms`, 'success');
            
            // å®Œæ•´æ–‡æ¡£è§£ææ€§èƒ½
            log(`å®Œæ•´æ–‡æ¡£è§£ææ€§èƒ½æµ‹è¯•ï¼ˆ${iterations}æ¬¡ï¼‰`, 'info');
            const start2 = performance.now();
            for (let i = 0; i < iterations; i++) {
                parser.parseDocument(testEditorData);
            }
            const end2 = performance.now();
            const avg2 = ((end2 - start2) / iterations).toFixed(3);
            log(`   âœ“ å¹³å‡è€—æ—¶: ${avg2}ms`, 'success');
            
            log('ğŸ‰ æ€§èƒ½æµ‹è¯•å®Œæˆï¼', 'success');
        };
        
        window.runMemoryTest = function() {
            log('ğŸ’¾ å¼€å§‹å†…å­˜æµ‹è¯•...', 'info');
            
            if (performance.memory) {
                const before = performance.memory.usedJSHeapSize;
                log(`æµ‹è¯•å‰å†…å­˜ä½¿ç”¨: ${(before / 1024 / 1024).toFixed(2)} MB`, 'info');
                
                // æ‰§è¡Œå¤§é‡è§£ææ“ä½œ
                const parser = mockParser();
                for (let i = 0; i < 10000; i++) {
                    parser.parseDocument(testEditorData);
                }
                
                const after = performance.memory.usedJSHeapSize;
                log(`æµ‹è¯•åå†…å­˜ä½¿ç”¨: ${(after / 1024 / 1024).toFixed(2)} MB`, 'info');
                log(`å†…å­˜å¢é•¿: ${((after - before) / 1024 / 1024).toFixed(2)} MB`, 'warning');
                
                log('ğŸ‰ å†…å­˜æµ‹è¯•å®Œæˆï¼', 'success');
            } else {
                log('âš ï¸ æµè§ˆå™¨ä¸æ”¯æŒå†…å­˜ç›‘æ§', 'warning');
            }
        };
        
        window.runStressTest = function() {
            log('ğŸ”¥ å¼€å§‹å‹åŠ›æµ‹è¯•...', 'info');
            
            const parser = mockParser();
            const largeData = {
                blocks: []
            };
            
            // ç”Ÿæˆå¤§é‡æµ‹è¯•æ•°æ®
            for (let i = 0; i < 1000; i++) {
                largeData.blocks.push({
                    id: `block-${i}`,
                    type: 'paragraph',
                    data: {
                        text: `è¿™æ˜¯ç¬¬ ${i + 1} ä¸ªæ®µè½ï¼Œç”¨äºå‹åŠ›æµ‹è¯•ã€‚`.repeat(10)
                    }
                });
            }
            
            log(`ç”Ÿæˆ ${largeData.blocks.length} ä¸ªå—è¿›è¡Œå‹åŠ›æµ‹è¯•`, 'info');
            
            const start = performance.now();
            const result = parser.parseDocument(largeData);
            const end = performance.now();
            
            log(`âœ“ å‹åŠ›æµ‹è¯•å®Œæˆï¼Œè€—æ—¶: ${(end - start).toFixed(2)}ms`, 'success');
            log(`âœ“ ç”ŸæˆHTMLé•¿åº¦: ${result.length} å­—ç¬¦`, 'success');
            
            log('ğŸ‰ å‹åŠ›æµ‹è¯•å®Œæˆï¼', 'success');
        };
        
        window.runCustomTemplateTest = function() {
            log('ğŸ¨ å¼€å§‹è‡ªå®šä¹‰æ¨¡æ¿æµ‹è¯•...', 'info');
            
            log('æ¨¡æ‹Ÿè‡ªå®šä¹‰æ¨¡æ¿é…ç½®', 'info');
            log('   âœ“ è‡ªå®šä¹‰headeræ¨¡æ¿', 'success');
            log('   âœ“ è‡ªå®šä¹‰paragraphæ¨¡æ¿', 'success');
            log('   âœ“ è‡ªå®šä¹‰æ ·å¼åº”ç”¨', 'success');
            
            log('ğŸ‰ è‡ªå®šä¹‰æ¨¡æ¿æµ‹è¯•å®Œæˆï¼', 'success');
        };
        
        window.runCustomProcessorTest = function() {
            log('ğŸ”§ å¼€å§‹è‡ªå®šä¹‰å¤„ç†å™¨æµ‹è¯•...', 'info');
            
            log('æ¨¡æ‹Ÿè‡ªå®šä¹‰å¤„ç†å™¨æ³¨å†Œ', 'info');
            log('   âœ“ è‡ªå®šä¹‰å—ç±»å‹å¤„ç†å™¨', 'success');
            log('   âœ“ å¤„ç†å™¨é€‰é¡¹é…ç½®', 'success');
            log('   âœ“ å¤„ç†å™¨åŠŸèƒ½éªŒè¯', 'success');
            
            log('ğŸ‰ è‡ªå®šä¹‰å¤„ç†å™¨æµ‹è¯•å®Œæˆï¼', 'success');
        };
        
        window.runCustomConfigTest = function() {
            log('âš™ï¸ å¼€å§‹è‡ªå®šä¹‰é…ç½®æµ‹è¯•...', 'info');
            
            log('æ¨¡æ‹Ÿè‡ªå®šä¹‰é…ç½®åº”ç”¨', 'info');
            log('   âœ“ å®¹å™¨åŒ…è£…é…ç½®', 'success');
            log('   âœ“ å…ƒæ•°æ®åŒ…å«é…ç½®', 'success');
            log('   âœ“ è‡ªå®šä¹‰é€‰é¡¹é…ç½®', 'success');
            
            log('ğŸ‰ è‡ªå®šä¹‰é…ç½®æµ‹è¯•å®Œæˆï¼', 'success');
        };
        
        window.runAllTests = function() {
            log('ğŸ¯ å¼€å§‹è¿è¡Œæ‰€æœ‰æµ‹è¯•...', 'info');
            
            clearOutput();
            
            setTimeout(() => runBasicDemo(), 100);
            setTimeout(() => runSingleBlockTest(), 500);
            setTimeout(() => runDocumentTest(), 900);
            setTimeout(() => runMetadataTest(), 1300);
            setTimeout(() => runPresetTest(), 1700);
            setTimeout(() => runErrorHandlingTest(), 2100);
            setTimeout(() => runComponentTest(), 2500);
            setTimeout(() => runConvenienceTest(), 2900);
            setTimeout(() => runPerformanceTest(), 3300);
            setTimeout(() => {
                log('ğŸ‰ æ‰€æœ‰æµ‹è¯•å®Œæˆï¼è§£æå™¨è¿è½¬æ­£å¸¸ã€‚', 'success');
            }, 3700);
        };
        
        // é¡µé¢åŠ è½½å®Œæˆåçš„åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            log('ğŸš€ FlowEdit HTMLè§£æå™¨æµ‹è¯•å¹³å°å·²å°±ç»ª', 'success');
            log('ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®å¼€å§‹æµ‹è¯•å„é¡¹åŠŸèƒ½', 'info');
        });
        
    </script>
</body>
</html>