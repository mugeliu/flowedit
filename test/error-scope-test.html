<!DOCTYPE html>
<html>
<head>
    <title>错误监听测试</title>
</head>
<body>
    <h1>错误监听范围测试</h1>
    
    <button id="webPageError">触发网页错误</button>
    <button id="extensionError">触发扩展错误</button>
    
    <script>
    // 模拟网页的错误
    document.getElementById('webPageError').onclick = function() {
        // 这会触发一个错误
        nonExistentFunction();
    };
    
    // 模拟内容脚本设置的监听器
    window.addEventListener('error', function(event) {
        console.log('[测试监听器] 捕获到错误:', {
            message: event.message,
            filename: event.filename,
            isFromExtension: event.filename.includes('chrome-extension://')
        });
    });
    
    // 模拟内容脚本的错误
    document.getElementById('extensionError').onclick = function() {
        // 假设这是扩展的代码
        chrome.storage.local.get('test');  // 如果不在扩展环境会报错
    };
    </script>
</body>
</html>