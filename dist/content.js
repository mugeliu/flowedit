!function(){"use strict";const e={enabled:!0,position:"last",editor:{placeholder:"åœ¨æ­¤è¾“å…¥å†…å®¹...",tools:{header:{levels:[2,3,4],defaultLevel:2,placeholder:"è¯·è¾“å…¥æ ‡é¢˜"}}}},t={toolbar:"#js_toolbar_0",editor:'div[contenteditable="true"].ProseMirror',proseMirror:"#ueditor_0 .ProseMirror",buttonArea:"#js_button_area",sidebar:"#js_side_article_list"};function n(e,t={}){const n=document.createElement(e);return t.className&&(n.className=t.className),t.id&&(n.id=t.id),t.innerHTML&&(n.innerHTML=t.innerHTML),t.textContent&&(n.textContent=t.textContent),t.cssText&&(n.style.cssText=t.cssText),n}function o(e,t=document){try{return t.querySelector(e)}catch(n){return console.error(`æŸ¥è¯¢é€‰æ‹©å™¨å¤±è´¥: ${e}`,n),null}}const s={enableRemoteStyles:!1,remoteStyleUrl:null,cacheExpiry:864e5,autoInjectStyles:!0,wrapperClassName:"flow-editor-content",skipEmptyBlocks:!0,theme:"default",contentStyleId:"flowedit-content-styles",blockStyles:{paragraph:{className:"flow-paragraph",styles:{margin:"0 0 16px 0","line-height":"1.6",color:"#333"}},header:{className:"flow-header",styles:{margin:"24px 0 16px 0","font-weight":"bold",color:"#222"},levelStyles:{1:{"font-size":"2em"},2:{"font-size":"1.5em"},3:{"font-size":"1.25em"},4:{"font-size":"1.1em"},5:{"font-size":"1em"},6:{"font-size":"0.9em"}}},list:{className:"flow-list",styles:{margin:"0 0 16px 0","padding-left":"20px"}},quote:{className:"flow-quote",styles:{margin:"16px 0",padding:"16px","border-left":"4px solid #ddd","background-color":"#f9f9f9","font-style":"italic"}},code:{className:"flow-code",styles:{margin:"16px 0",padding:"16px","background-color":"#f5f5f5","border-radius":"4px","font-family":'Monaco, Consolas, "Courier New", monospace',"font-size":"14px","overflow-x":"auto"}}}},r={default:{name:"Default",description:"é»˜è®¤ä¸»é¢˜ï¼Œå¹³è¡¡çš„è®¾è®¡é£æ ¼",blockStyles:{paragraph:{styles:{color:"#333","line-height":"1.6"}},header:{styles:{color:"#222","font-weight":"bold"}},quote:{styles:{"border-left":"4px solid #007bff","background-color":"#f8f9fa"}}}},minimal:{name:"Minimal",description:"æç®€ä¸»é¢˜ï¼Œç®€æ´çš„è®¾è®¡é£æ ¼",blockStyles:{paragraph:{styles:{color:"#000","line-height":"1.5"}},header:{styles:{color:"#000","font-weight":"600"}},quote:{styles:{"border-left":"2px solid #000","background-color":"#fff"}}}},modern:{name:"Modern",description:"ç°ä»£ä¸»é¢˜ï¼Œæ—¶å°šçš„è®¾è®¡é£æ ¼",blockStyles:{paragraph:{styles:{color:"#1a1a1a","line-height":"1.7"}},header:{styles:{color:"#1a1a1a","font-weight":"700"}},quote:{styles:{"border-left":"4px solid #6366f1","background-color":"#f8fafc"}}}}},i={enabled:!0,prefix:"flow_styles_",expiry:864e5},l={requiredBlockTypes:["paragraph","header"],forbiddenCssProperties:["javascript","expression","behavior","binding","import","include","moz-binding"],maxCssValueLength:200};const a=new class{constructor(){this.config={...s}}get(e){return e?this.config[e]:this.config}set(e,t){"object"==typeof e?this.config={...this.config,...e}:this.config[e]=t}reset(){this.config={...s}}applyTheme(e){const t=r[e];t&&(this.config.theme=e,Object.keys(t.blockStyles).forEach((e=>{this.config.blockStyles[e]&&(this.config.blockStyles[e].styles={...this.config.blockStyles[e].styles,...t.blockStyles[e].styles})})))}getCurrentTheme(){return r[this.config.theme]||r.default}getBlockStyles(e,t=null){const n=this.config.blockStyles[e];if(!n)return{};let o={...n.styles};return"header"===e&&t&&n.levelStyles&&n.levelStyles[t]&&(o={...o,...n.levelStyles[t]}),o}getBlockClassName(e){const t=this.config.blockStyles[e];return t?t.className:""}validate(){return"object"==typeof this.config&&null!==this.config&&"object"==typeof this.config.blockStyles}};const c=new class{constructor(){this.isInitialized=!1,this.syncTimer=null,this.lastSyncTime=null,this.currentVersion=null,this.syncInterval=36e5}async initialize(){if(this.isInitialized)return!0;try{if(!(await this.checkUserAuth()))return console.log("ç”¨æˆ·æœªç™»å½•ï¼Œä½¿ç”¨é»˜è®¤æ ·å¼"),this.isInitialized=!0,!0;const e=await this.getCachedStyleVersion(),t=await this.getRemoteStyleVersion();if(e&&e===t)console.log("æ ·å¼å·²æ˜¯æœ€æ–°ç‰ˆæœ¬");else{console.log("æ£€æµ‹åˆ°æ ·å¼æ›´æ–°ï¼Œå¼€å§‹åŒæ­¥...");await this.syncStyles()&&await this.setCachedStyleVersion(t)}return this.startPeriodicSync(),this.isInitialized=!0,this.lastSyncTime=Date.now(),!0}catch(e){return console.error("æ ·å¼åŒæ­¥æœåŠ¡åˆå§‹åŒ–å¤±è´¥:",e),this.isInitialized=!0,!1}}async checkUserAuth(){return!1}async getRemoteStyleVersion(){try{return"v1.0.0"}catch(e){return console.error("è·å–è¿œç¨‹æ ·å¼ç‰ˆæœ¬å¤±è´¥:",e),null}}async syncStyles(){try{return console.log("æ ·å¼åŒæ­¥å®Œæˆï¼ˆæ¨¡æ‹Ÿï¼‰"),!0}catch(e){return console.error("æ ·å¼åŒæ­¥å¤±è´¥:",e),!1}}async manualSync(){console.log("å¼€å§‹æ‰‹åŠ¨åŒæ­¥æ ·å¼...");try{const e=await this.getRemoteStyleVersion(),t=await this.getCachedStyleVersion();if(!e||e===t)return console.log("æ ·å¼å·²æ˜¯æœ€æ–°ç‰ˆæœ¬ï¼Œæ— éœ€åŒæ­¥"),!0;if(await this.syncStyles())return await this.setCachedStyleVersion(e),this.lastSyncTime=Date.now(),console.log("æ‰‹åŠ¨åŒæ­¥å®Œæˆ"),!0}catch(e){console.error("æ‰‹åŠ¨åŒæ­¥å¤±è´¥:",e)}return!1}startPeriodicSync(){this.syncTimer&&clearInterval(this.syncTimer),this.syncTimer=setInterval((async()=>{console.log("æ‰§è¡Œå®šæ—¶æ ·å¼åŒæ­¥..."),await this.manualSync()}),this.syncInterval),console.log(`å®šæ—¶åŒæ­¥å·²å¯åŠ¨ï¼Œé—´éš”: ${this.syncInterval/1e3/60} åˆ†é’Ÿ`)}stopPeriodicSync(){this.syncTimer&&(clearInterval(this.syncTimer),this.syncTimer=null,console.log("å®šæ—¶åŒæ­¥å·²åœæ­¢"))}async getCachedStyleVersion(){try{return(await chrome.storage.local.get(["styleVersion"])).styleVersion||null}catch(e){return console.error("è·å–ç¼“å­˜æ ·å¼ç‰ˆæœ¬å¤±è´¥:",e),null}}async setCachedStyleVersion(e){try{return await chrome.storage.local.set({styleVersion:e}),this.currentVersion=e,!0}catch(t){return console.error("è®¾ç½®ç¼“å­˜æ ·å¼ç‰ˆæœ¬å¤±è´¥:",t),!1}}async cacheStyles(e){try{return await chrome.storage.local.set({userStyles:e,stylesCacheTime:Date.now()}),!0}catch(t){return console.error("ç¼“å­˜æ ·å¼æ•°æ®å¤±è´¥:",t),!1}}async getCachedStyles(){try{const e=await chrome.storage.local.get(["userStyles","stylesCacheTime"]),t=864e5;return e.stylesCacheTime&&Date.now()-e.stylesCacheTime>t?(console.log("æ ·å¼ç¼“å­˜å·²è¿‡æœŸ"),null):e.userStyles||null}catch(e){return console.error("è·å–ç¼“å­˜æ ·å¼æ•°æ®å¤±è´¥:",e),null}}async clearCache(){try{return await chrome.storage.local.remove(["styleVersion","userStyles","stylesCacheTime"]),this.currentVersion=null,this.lastSyncTime=null,console.log("æ ·å¼ç¼“å­˜å·²æ¸…é™¤"),!0}catch(e){return console.error("æ¸…é™¤æ ·å¼ç¼“å­˜å¤±è´¥:",e),!1}}getSyncStatus(){return{isInitialized:this.isInitialized,currentVersion:this.currentVersion,lastSyncTime:this.lastSyncTime,isPeriodicSyncActive:!!this.syncTimer}}destroy(){this.stopPeriodicSync(),this.isInitialized=!1,this.currentVersion=null,this.lastSyncTime=null}},d={paragraph:{tag:"p",className:"flow-paragraph",styles:{margin:"0 0 16px 0","line-height":"1.6",color:"#333","font-size":"16px"}},header:{h1:{tag:"h1",className:"flow-header-1",styles:{"font-size":"32px","font-weight":"bold",margin:"0 0 24px 0","line-height":"1.2",color:"#1a1a1a"}},h2:{tag:"h2",className:"flow-header-2",styles:{"font-size":"24px","font-weight":"bold",margin:"0 0 20px 0","line-height":"1.3",color:"#1a1a1a"}},h3:{tag:"h3",className:"flow-header-3",styles:{"font-size":"20px","font-weight":"bold",margin:"0 0 16px 0","line-height":"1.4",color:"#1a1a1a"}}},list:{tag:"ul",className:"flow-list",styles:{margin:"0 0 16px 0","padding-left":"20px"},itemStyles:{margin:"0 0 8px 0","line-height":"1.6"}},quote:{tag:"blockquote",className:"flow-quote",styles:{margin:"0 0 16px 0",padding:"16px 20px","border-left":"4px solid #e0e0e0","background-color":"#f9f9f9","font-style":"italic",color:"#666"}},code:{tag:"pre",className:"flow-code",styles:{margin:"0 0 16px 0",padding:"16px","background-color":"#f5f5f5",border:"1px solid #e0e0e0","border-radius":"4px","font-family":'Monaco, Consolas, "Courier New", monospace',"font-size":"14px","overflow-x":"auto"}}};let h=new Map,y=!1;const p=new class{constructor(){this.styles={...d},this.remoteStyleUrl=null,this.cacheExpiry=a.get("cacheExpiry")}setRemoteStyleUrl(e){this.remoteStyleUrl=e}getBlockStyle(e,t={}){switch(e){case"paragraph":default:return this.styles.paragraph;case"header":const e=t.level||1;return this.styles.header[`h${e}`]||this.styles.header.h1;case"list":return this.styles.list;case"quote":return this.styles.quote;case"code":return this.styles.code}}async loadRemoteStyles(){try{const e=await c.getCachedStyles();if(e)return this.mergeStyles(e),y=!0,console.log("ä½¿ç”¨æ ·å¼åŒæ­¥æœåŠ¡ç¼“å­˜çš„æ ·å¼"),!0;if(this.remoteStyleUrl){const e=`${i.prefix}${this.remoteStyleUrl}`,t=this.getCachedStyles(e);if(t)return this.mergeStyles(t),y=!0,console.log("ä½¿ç”¨æœ¬åœ°ç¼“å­˜çš„è¿œç¨‹æ ·å¼"),!0}if(!this.remoteStyleUrl)return console.warn("è¿œç¨‹æ ·å¼URLæœªè®¾ç½®ï¼Œæ— æ³•åŒæ­¥æ ·å¼"),!1;console.log("è§¦å‘æ ·å¼åŒæ­¥...");if(await c.manualSync()){const e=await c.getCachedStyles();if(e)return this.mergeStyles(e),y=!0,!0}return console.warn("æ— æ³•è·å–è¿œç¨‹æ ·å¼ï¼Œå°†ä½¿ç”¨é»˜è®¤æ ·å¼"),!1}catch(e){return console.error("åŠ è½½è¿œç¨‹æ ·å¼å¤±è´¥:",e),!1}}mergeStyles(e){this.styles={...this.styles,...e}}validateStyleFormat(e){if(!e||"object"!=typeof e)return!1;if(!l.requiredBlockTypes.every((t=>e[t])))return!1;const t=e=>{if(!e||"object"!=typeof e)return!0;for(const[t,n]of Object.entries(e)){if(l.forbiddenCssProperties.some((e=>t.toLowerCase().includes(e.toLowerCase()))))return!1;if("string"==typeof n&&n.length>l.maxCssValueLength)return!1}return!0},n=e=>{for(const o of Object.values(e))if(o&&"object"==typeof o){if(o.styles&&!t(o.styles))return!1;if(!n(o))return!1}return!0};return n(e)}getCachedStyles(e){const t=h.get(e);return t&&Date.now()-t.timestamp<i.expiry?t.data:null}setCachedStyles(e,t){h.set(e,{data:t,timestamp:Date.now()})}clearCache(){h.clear(),y=!1}getAllStyles(){return this.styles}isRemoteStylesLoaded(){return y}async initialize(){try{await c.initialize();const e=await c.getCachedStyles();return e?(this.mergeStyles(e),y=!0,console.log("æ ·å¼ç®¡ç†å™¨åˆå§‹åŒ–å®Œæˆï¼Œå·²åŠ è½½ç¼“å­˜æ ·å¼")):console.log("æ ·å¼ç®¡ç†å™¨åˆå§‹åŒ–å®Œæˆï¼Œä½¿ç”¨é»˜è®¤æ ·å¼"),!0}catch(e){return console.error("æ ·å¼ç®¡ç†å™¨åˆå§‹åŒ–å¤±è´¥:",e),!1}}};const u=new class{constructor(){this.processors={paragraph:this.processParagraph.bind(this),header:this.processHeader.bind(this),list:this.processList.bind(this),quote:this.processQuote.bind(this),code:this.processCode.bind(this),delimiter:this.processDelimiter.bind(this),image:this.processImage.bind(this),table:this.processTable.bind(this)}}processBlock(e){if(!e||!e.type)return console.warn("æ— æ•ˆçš„å—æ•°æ®:",e),this.createEmptyBlock();const t=this.processors[e.type];if(!t)return console.warn(`æœªçŸ¥çš„å—ç±»å‹: ${e.type}`),this.processParagraph(e);try{return t(e)}catch(n){return console.error(`å¤„ç†å—å¤±è´¥ (${e.type}):`,n),this.createEmptyBlock()}}processParagraph(e){const t=(e.data||{}).text||"",n=p.getBlockStyle("paragraph");return{type:"paragraph",tag:n.tag,className:n.className,styles:n.styles,content:this.sanitizeText(t),isEmpty:!t.trim()}}processHeader(e){const t=e.data||{},n=t.text||"",o=Math.min(Math.max(t.level||1,1),6),s=p.getBlockStyle("header",{level:o});return{type:"header",level:o,tag:s.tag,className:s.className,styles:s.styles,content:this.sanitizeText(n),isEmpty:!n.trim()}}processList(e){const t=e.data||{},n=t.items||[],o=t.style||"unordered",s=p.getBlockStyle("list"),r=n.map((e=>({content:this.sanitizeText(e),isEmpty:!e.trim()})));return{type:"list",listStyle:o,tag:"ordered"===o?"ol":"ul",className:s.className,styles:s.styles,itemStyles:s.itemStyles,items:r,isEmpty:0===r.length||r.every((e=>e.isEmpty))}}processQuote(e){const t=e.data||{},n=t.text||"",o=t.caption||"",s=p.getBlockStyle("quote");return{type:"quote",tag:s.tag,className:s.className,styles:s.styles,content:this.sanitizeText(n),caption:this.sanitizeText(o),isEmpty:!n.trim()}}processCode(e){const t=(e.data||{}).code||"",n=p.getBlockStyle("code");return{type:"code",tag:n.tag,className:n.className,styles:n.styles,content:this.escapeHtml(t),isEmpty:!t.trim()}}processDelimiter(e){return{type:"delimiter",tag:"hr",className:"flow-delimiter",styles:{margin:"32px 0",border:"none","border-top":"1px solid #e0e0e0",height:"1px"},content:"",isEmpty:!1}}processImage(e){var t;const n=e.data||{},o=(null==(t=n.file)?void 0:t.url)||n.url||"",s=n.caption||"",r=n.withBorder||!1,i=n.withBackground||!1,l=n.stretched||!1;return{type:"image",tag:"figure",className:"flow-image",styles:{margin:"0 0 16px 0","text-align":"center"},url:o,caption:this.sanitizeText(s),withBorder:r,withBackground:i,stretched:l,isEmpty:!o}}processTable(e){const t=e.data||{},n=t.content||[],o=t.withHeadings||!1,s=n.map((e=>e.map((e=>this.sanitizeText(e)))));return{type:"table",tag:"table",className:"flow-table",styles:{margin:"0 0 16px 0","border-collapse":"collapse",width:"100%",border:"1px solid #e0e0e0"},content:s,withHeadings:o,isEmpty:0===s.length}}createEmptyBlock(){return{type:"paragraph",tag:"p",className:"flow-paragraph",styles:{},content:"",isEmpty:!0}}sanitizeText(e){if("string"!=typeof e)return"";const t=["b","i","u","strong","em","mark","code","a"];return e.replace(/<\/?([a-zA-Z][a-zA-Z0-9]*)\b[^>]*>/g,((e,n)=>t.includes(n.toLowerCase())?e:""))}escapeHtml(e){if("string"!=typeof e)return"";const t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};return e.replace(/[&<>"']/g,(e=>t[e]))}processBlocks(e){return Array.isArray(e)?e.map((e=>this.processBlock(e))).filter((e=>e)):(console.warn("blockså¿…é¡»æ˜¯æ•°ç»„"),[])}registerProcessor(e,t){"function"==typeof t?this.processors[e]=t:console.warn("å¤„ç†å™¨å¿…é¡»æ˜¯å‡½æ•°")}};const g=new class{constructor(){this.generators={paragraph:this.generateParagraph.bind(this),header:this.generateHeader.bind(this)}}generateBlockHtml(e){if(!e||e.isEmpty)return"";const t=this.generators[e.type];if(!t)return console.warn(`æœªçŸ¥çš„å—ç±»å‹: ${e.type}`),this.generateParagraph(e);try{return`<section>${t(e)}</section>`}catch(n){return console.error(`ç”ŸæˆHTMLå¤±è´¥ (${e.type}):`,n),""}}generateParagraph(e){const{content:t}=e;return`<span leaf="">${t}</span>`}generateHeader(e){const{tag:t,className:n,content:o}=e;return`<${t} class="${n}">${o}</${t}>`}async generateHTML(e,t={}){const{skipEmpty:n=!0}=t;return u.processBlocks(e).map((e=>this.generateBlockHtml(e))).filter((e=>!n||e.trim())).join("\n")}registerGenerator(e,t){"function"==typeof t?this.generators[e]=t:console.warn("ç”Ÿæˆå™¨å¿…é¡»æ˜¯å‡½æ•°")}};async function f(e,s={}){try{const{targetSelector:r=t.editor,append:i=!0,insertPosition:l="cursor",styleOptions:a={}}=s,c=await g.generateHTML(e,{...a}),d=await async function(e,t={}){const{targetSelector:s='div[contenteditable="true"].ProseMirror',append:r=!0,insertPosition:i="cursor"}=t;try{const t=o(s);if(!t)return console.error("æ‰¾ä¸åˆ°ç›®æ ‡ç¼–è¾‘å™¨:",s),!1;const l=n("div",{innerHTML:e});return l.querySelectorAll("section").forEach((e=>{if(r)t.appendChild(e.cloneNode(!0));else switch(i){case"start":t.insertBefore(e.cloneNode(!0),t.firstChild);break;case"end":t.appendChild(e.cloneNode(!0));break;default:t.innerHTML="",t.appendChild(e.cloneNode(!0))}})),console.log("å†…å®¹æ’å…¥æˆåŠŸ"),!0}catch(l){return console.error("æ’å…¥å†…å®¹å¤±è´¥:",l),!1}}(c,{targetSelector:r,append:i,insertPosition:l});return d}catch(r){return console.error("ä¿å­˜åˆ°åŸç¼–è¾‘å™¨å¤±è´¥:",r),!1}}function m(){return!!(window.EditorJS&&window.Paragraph&&window.Header)}async function w(e,t){if(!m())try{await new Promise(((e,t)=>{chrome.runtime.sendMessage("inject_editorjs_bundle",(n=>{n&&"injected"===n.status?setTimeout((()=>{m()?e():t(new Error("ç¼–è¾‘å™¨è„šæœ¬åŠ è½½å¤±è´¥"))}),100):t(new Error("ç¼–è¾‘å™¨æ³¨å…¥å¤±è´¥"))}))}))}catch(n){throw new Error("ç¼–è¾‘å™¨åŠ è½½å¤±è´¥: "+n.message)}return function(e,t){if(!document.getElementById(e))throw new Error(`${e}å…ƒç´ ä¸å­˜åœ¨ï¼Œè¯·æ£€æŸ¥DOMç»“æ„`);try{return new EditorJS({holder:e,tools:{paragraph:{class:Paragraph,inlineToolbar:!0},header:{class:Header,inlineToolbar:!0,config:{placeholder:t.tools.header.placeholder,levels:t.tools.header.levels,defaultLevel:t.tools.header.defaultLevel}}},data:{time:Date.now(),blocks:[{type:"paragraph",data:{text:"ä½¿ç”¨editor.jså¼€å§‹ç¼–å†™æ‚¨çš„å†…å®¹..."}}],version:"2.28.2"},placeholder:t.placeholder})}catch(n){throw console.error("ç¼–è¾‘å™¨åˆå§‹åŒ–å¤±è´¥:",n),n}}(e,t)}let b=null,x={},S=[],k=null;async function v(){if(b)return void console.warn("æ™ºèƒ½ç¼–è¾‘å™¨å·²ç»æ¿€æ´»");const s=o(t.editor);if(s)try{x=function(e){const t={};return e.forEach((e=>{const n=document.getElementById(e);n&&(t[e]=n.style.display,n.style.display="none")})),t}(["ueditor_0","article_setting_area"]),S=function(){const e=document.getElementById(t.buttonArea.replace("#",""));if(!e)return[];const n=Array.from(e.children),o=n.map((e=>({element:e,display:e.style.display})));return n.forEach((e=>{e.style.display="none"})),o}(),function(e){const t=n("div",{id:"smart-editor-container",className:"flowedit-editor-container"}),s=o("#edui1_iframeholder");s?s.appendChild(t):e.parentNode.insertBefore(t,e.nextSibling);const r=n("div",{id:"editor-holder",className:"flowedit-editor-holder"});t.appendChild(r),console.log("æ™ºèƒ½ç¼–è¾‘å™¨ç•Œé¢åˆ›å»ºå®Œæˆ")}(s),k=function(e={}){const{onSave:s,onCancel:r}=e,i=n("div",{className:"flowedit-editor-action-bar"}),l=n("button",{textContent:"ğŸ’¾ ä¿å­˜",className:"flowedit-editor-save-btn"}),a=n("button",{textContent:"â†©ï¸ å–æ¶ˆ",className:"flowedit-editor-cancel-btn"});i.appendChild(l),i.appendChild(a);const c=o(t.buttonArea);return c?c.appendChild(i):(console.warn("æ‰¾ä¸åˆ°æŒ‰é’®åŒºåŸŸï¼Œå°†æ§åˆ¶æ æ·»åŠ åˆ°body"),document.body.appendChild(i)),s&&"function"==typeof s&&l.addEventListener("click",s),r&&"function"==typeof r&&a.addEventListener("click",r),console.log("æ™ºèƒ½ç¼–è¾‘å™¨æ§åˆ¶æ åˆ›å»ºå®Œæˆ"),i}({onSave:E,onCancel:C}),await new Promise((e=>setTimeout(e,50))),b=await w("editor-holder",e.editor),console.log("æ™ºèƒ½ç¼–è¾‘å™¨æ¿€æ´»æˆåŠŸ")}catch(r){console.error("æ™ºèƒ½æ’å…¥åŠŸèƒ½å¯åŠ¨å¤±è´¥:",r),alert("æ™ºèƒ½æ’å…¥åŠŸèƒ½å¯åŠ¨å¤±è´¥"),C()}else alert("æ‰¾ä¸åˆ°ç¼–è¾‘å™¨å®¹å™¨")}function C(){var e,t;S.length>0&&(S.forEach((({element:e,display:t})=>{e.style.display=t})),S=[]),Object.keys(x).length>0&&(e=x,Object.entries(e).forEach((([e,t])=>{const n=document.getElementById(e);n&&(n.style.display=t)})),x={}),function(){const e=document.getElementById("smart-editor-container");e&&(e.remove(),console.log("æ™ºèƒ½ç¼–è¾‘å™¨ç•Œé¢å·²ç§»é™¤"))}(),k&&((t=k)&&(t.remove(),console.log("æ™ºèƒ½ç¼–è¾‘å™¨æ§åˆ¶æ å·²ç§»é™¤")),k=null),b&&(!function(e){if(e)try{e.destroy()}catch(t){console.warn("ç¼–è¾‘å™¨é”€æ¯é”™è¯¯:",t)}}(b),b=null),console.log("æ™ºèƒ½ç¼–è¾‘å™¨å·²åœç”¨")}async function E(e={}){if(b)try{const t=await b.save();console.log("ä¿å­˜çš„æ•°æ®:",t);await f(t.blocks,{usePreloadedStyles:!0,...e})?console.log("å†…å®¹å·²æˆåŠŸä¿å­˜åˆ°åŸç¼–è¾‘å™¨"):console.error("ä¿å­˜åˆ°åŸç¼–è¾‘å™¨å¤±è´¥")}catch(t){console.error("ä¿å­˜å¤±è´¥:",t)}finally{C()}else console.error("ç¼–è¾‘å™¨æœªåˆå§‹åŒ–")}async function z(){try{await v()}catch(e){console.error("æ™ºèƒ½æ’å…¥æŒ‰é’®ç‚¹å‡»å¤„ç†å¤±è´¥:",e)}}function T(e){const n=document.querySelector(t.sidebar);if(n){const t="none"===n.style.display;n.style.display=t?"":"none";const o=e.currentTarget;t?o.classList.add("on"):o.classList.remove("on")}}function N(){const e=o(t.toolbar);if(!e)return console.debug("æ‰¾ä¸åˆ°å·¥å…·æ åŒºåŸŸï¼Œå¯èƒ½é¡µé¢æœªç™»å½•"),!1;const s=function(){const e=n("button",{className:"flowedit-switch",innerHTML:'\n      <div class="flowedit-switch-track"></div>\n      <div class="flowedit-switch-thumb"></div>\n    '});return e.addEventListener("click",T),e}(),r=o(t.sidebar);s&&r?e.firstElementChild?e.insertBefore(s,e.firstElementChild):e.appendChild(s):console.warn("ä¾§è¾¹æ åˆ‡æ¢æŒ‰é’®åˆå§‹åŒ–å¤±è´¥ï¼šç¼ºå°‘å¿…è¦çš„DOMå…ƒç´ ");const i=function(){const e=n("button",{className:"flowedit-btn flowedit-smart-btn",textContent:"æ™ºèƒ½æ’å…¥"});return e.addEventListener("click",z),e}(),l=o(t.sidebar);return i&&l?e.appendChild(i):console.warn("æ™ºèƒ½æ’å…¥æŒ‰é’®åˆå§‹åŒ–å¤±è´¥ï¼šç¼ºå°‘å¿…è¦çš„DOMå…ƒç´ "),!0}const B=new class{constructor(){this.config={},this.initialized=!1}async initialize(){try{console.log("åˆå§‹åŒ–ç”¨æˆ·é…ç½®ç®¡ç†å™¨..."),this.initialized=!0,console.log("ç”¨æˆ·é…ç½®ç®¡ç†å™¨åˆå§‹åŒ–å®Œæˆ")}catch(e){throw console.error("ç”¨æˆ·é…ç½®ç®¡ç†å™¨åˆå§‹åŒ–å¤±è´¥:",e),e}}getUserConfig(e){return this.initialized?e?this.config[e]:this.config:(console.warn("ç”¨æˆ·é…ç½®ç®¡ç†å™¨æœªåˆå§‹åŒ–"),null)}async setUserConfig(e,t){try{return this.initialized?("object"==typeof e?this.config={...this.config,...e}:this.config[e]=t,console.log("ç”¨æˆ·é…ç½®å·²æ›´æ–°:",e),!0):(console.warn("ç”¨æˆ·é…ç½®ç®¡ç†å™¨æœªåˆå§‹åŒ–"),!1)}catch(n){return console.error("è®¾ç½®ç”¨æˆ·é…ç½®å¤±è´¥:",n),!1}}},I=new class{constructor(){this.initialized=!1,this.styleCache={},this.syncInterval=null}async initialize(){try{console.log("åˆå§‹åŒ–è¿œç¨‹æ ·å¼åŒæ­¥æœåŠ¡..."),this.initialized=!0,console.log("è¿œç¨‹æ ·å¼åŒæ­¥æœåŠ¡åˆå§‹åŒ–å®Œæˆ")}catch(e){throw console.error("è¿œç¨‹æ ·å¼åŒæ­¥æœåŠ¡åˆå§‹åŒ–å¤±è´¥:",e),e}}async manualSync(){try{return this.initialized?(console.log("å¼€å§‹æ‰‹åŠ¨åŒæ­¥è¿œç¨‹æ ·å¼..."),console.log("è¿œç¨‹æ ·å¼åŒæ­¥å®Œæˆ"),!0):(console.warn("è¿œç¨‹æ ·å¼åŒæ­¥æœåŠ¡æœªåˆå§‹åŒ–"),!1)}catch(e){return console.error("è¿œç¨‹æ ·å¼åŒæ­¥å¤±è´¥:",e),!1}}startAutoSync(e=3e4){this.syncInterval&&clearInterval(this.syncInterval),this.syncInterval=setInterval((async()=>{await this.manualSync()}),e),console.log(`è¿œç¨‹æ ·å¼è‡ªåŠ¨åŒæ­¥å·²å¯åŠ¨ï¼Œé—´éš”: ${e}ms`)}stopAutoSync(){this.syncInterval&&(clearInterval(this.syncInterval),this.syncInterval=null,console.log("è¿œç¨‹æ ·å¼è‡ªåŠ¨åŒæ­¥å·²åœæ­¢"))}};async function L(e={}){try{return console.log("å¼€å§‹åˆå§‹åŒ–FlowEditåº”ç”¨æœåŠ¡..."),await B.initialize(),await async function(e={}){try{if(await I.initialize(),!1!==e.enableAutoSync){const t=e.syncInterval||3e4;I.startAutoSync(t)}!1!==e.initialSync&&await I.manualSync(),console.log("è¿œç¨‹æ ·å¼ç³»ç»Ÿåˆå§‹åŒ–å®Œæˆ")}catch(t){console.error("è¿œç¨‹æ ·å¼ç³»ç»Ÿåˆå§‹åŒ–å¤±è´¥:",t)}}(e),console.log("FlowEditåº”ç”¨æœåŠ¡åˆå§‹åŒ–å®Œæˆ"),!0}catch(t){return console.error("FlowEditåº”ç”¨æœåŠ¡åˆå§‹åŒ–å¤±è´¥:",t),!1}}async function M(){N()?(!function(){const e="flow-editor-plugin-styles";if(!document.getElementById(e)){const t=document.createElement("style");t.id=e,t.setAttribute("data-flowedit-plugin-ui","true"),t.textContent="\n      /* FlowEdit æ’ä»¶UIæ ·å¼ */\n      \n  /* æ‰©å±•æŒ‰é’®åŸºç¡€æ ·å¼ */\n  .flowedit-btn {\n    display: inline-block;\n    height: 22px;\n    margin: 1px 4px;\n    vertical-align: middle;\n    cursor: pointer;\n    border: none;\n    outline: none;\n    box-sizing: border-box;\n  }\n  \n  /* æ™ºèƒ½æ’å…¥æŒ‰é’®æ ·å¼ */\n  .flowedit-smart-btn {\n    background-color: #07c160;\n    color: white;\n    border-radius: 4px;\n    padding: 0 12px;\n    font-size: 12px;\n    line-height: 22px;\n    transition: all 0.3s ease;\n  }\n  \n  /* æ™ºèƒ½æ’å…¥æŒ‰é’®æ‚¬æµ®æ•ˆæœ */\n  .flowedit-smart-btn:hover {\n    background-color: #07c160;\n    background-image: linear-gradient(to bottom, #07C160 0, #07C160 100%);\n    border-color: #07C160;\n    color: #FFFFFF;\n    transform: translateY(-1px);\n    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n  }\n\n      \n  /* Switchå¼€å…³æ ·å¼ */\n  .flowedit-switch {\n    display: inline-block;\n    height: 22px;\n    margin: 1px 4px;\n    vertical-align: middle;\n    cursor: pointer;\n    position: relative;\n    width: 40px;\n    border: none;\n    outline: none;\n    box-sizing: border-box;\n  }\n  \n  .flowedit-switch-track {\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    background-color: #ccc;\n    border-radius: 11px;\n    transition: all 0.3s ease;\n  }\n  \n  .flowedit-switch-thumb {\n    position: absolute;\n    width: 18px;\n    height: 18px;\n    left: 2px;\n    bottom: 2px;\n    background-color: white;\n    border-radius: 50%;\n    transition: transform 0.3s ease;\n  }\n  \n  .flowedit-switch.on .flowedit-switch-track {\n    background-color: #07c160;\n  }\n  \n  .flowedit-switch.on .flowedit-switch-thumb {\n    transform: translateX(18px);\n  }\n\n      \n  /* æ™ºèƒ½æ’å…¥ç¼–è¾‘å™¨å®¹å™¨æ ·å¼ */\n  .flowedit-editor-container {\n    position: absolute;\n    top: 0;\n    left: 0;\n    z-index: 1;\n    width: calc(100% + 8px);\n    box-sizing: content-box;\n    margin-left: -95px;\n    padding: 0 91px;\n    background: #fff;\n  }\n  \n  /* æ™ºèƒ½æ’å…¥ç¼–è¾‘å™¨å ä½å…ƒç´ æ ·å¼ */\n  .flowedit-editor-holder {\n    margin-left: -95px;\n    padding: 0 91px;\n  }\n  \n  /* æ™ºèƒ½æ’å…¥æ§åˆ¶æ æ ·å¼ */\n  .flowedit-editor-action-bar {\n    padding: 20px 20px 15px 20px;\n    margin: 0;\n    background-color: #ffffff;\n    color: rgb(53, 53, 53);\n    font-family: mp-quote, 'PingFang SC', system-ui, -apple-system, BlinkMacSystemFont, 'Helvetica Neue', 'Hiragino Sans GB', 'Microsoft YaHei UI', 'Microsoft YaHei', Arial, sans-serif;\n    font-size: 14px;\n    line-height: 22.4px;\n    word-break: break-all;\n    box-sizing: content-box;\n    display: flex;\n    justify-content: flex-end;\n    gap: 10px;\n    z-index: 1000;\n  }\n  \n  /* æ™ºèƒ½æ’å…¥ä¿å­˜æŒ‰é’®æ ·å¼ */\n  .flowedit-editor-save-btn {\n    padding: 4px 12px;\n    height: 34px;\n    width: 98px;\n    display: inline-block;\n    background: #07c160;\n    color: white;\n    border: none;\n    border-radius: 4px;\n    cursor: pointer;\n    font-size: 14px;\n    transition: all 0.3s ease;\n  }\n  \n  /* æ™ºèƒ½æ’å…¥ä¿å­˜æŒ‰é’®æ‚¬æµ®æ•ˆæœ */\n  .flowedit-editor-save-btn:hover {\n    background-color: #07c160;\n    background-image: linear-gradient(to bottom, #07C160 0, #07C160 100%);\n    border-color: #07C160;\n    color: #FFFFFF;\n    transform: translateY(-1px);\n    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n  }\n  \n  /* æ™ºèƒ½æ’å…¥å–æ¶ˆæŒ‰é’®æ ·å¼ */\n  .flowedit-editor-cancel-btn {\n    padding: 4px 12px;\n    height: 34px;\n    width: 98px;\n    display: inline-block;\n    background: #999999;\n    color: white;\n    border: none;\n    border-radius: 4px;\n    cursor: pointer;\n    font-size: 14px;\n    transition: all 0.3s ease;\n  }\n  \n  /* æ™ºèƒ½æ’å…¥å–æ¶ˆæŒ‰é’®æ‚¬æµ®æ•ˆæœ */\n  .flowedit-editor-cancel-btn:hover {\n    background-color: #e7e7eb;\n    background-image: linear-gradient(to bottom, #E7E7EB 0, #E7E7EB 100%);\n    border-color: #DADBE0;\n    box-shadow: none;\n    -moz-box-shadow: none;\n    -webkit-box-shadow: none;\n    color: #353535;\n    transform: translateY(-1px);\n  }\n\n    ",document.head.appendChild(t),console.log("FlowEdit æ’ä»¶UIæ ·å¼å·²æ³¨å…¥")}}(),console.log("FlowEdit æ’ä»¶åŠŸèƒ½æ¨¡å—åˆå§‹åŒ–å®Œæˆ")):console.log("FlowEdit æ’ä»¶åŠŸèƒ½æ¨¡å—åˆå§‹åŒ–å¤±è´¥ï¼šé¡µé¢å¯èƒ½æœªç™»å½•")}(async function(){console.log("FlowEdit å†…å®¹è„šæœ¬å¯åŠ¨"),"loading"===document.readyState&&await new Promise((e=>{document.addEventListener("DOMContentLoaded",e)}));try{await L(),console.log("FlowEdit åº”ç”¨æœåŠ¡åˆå§‹åŒ–æˆåŠŸ")}catch(e){console.error("FlowEdit åº”ç”¨æœåŠ¡åˆå§‹åŒ–å¤±è´¥:",e)}await M()})().catch((e=>{console.error("FlowEdit å¯åŠ¨å¤±è´¥:",e)}))}();
