!function(){"use strict";const t=new class{constructor(){this.plugins=new Map,this.initialized=new Set}register(t,e){if(!e.initialize||"function"!=typeof e.initialize)throw new Error(`æ’ä»¶ ${t} å¿…é¡»æä¾› initialize æ–¹æ³•`);if(!e.cleanup||"function"!=typeof e.cleanup)throw new Error(`æ’ä»¶ ${t} å¿…é¡»æä¾› cleanup æ–¹æ³•`);this.plugins.set(t,e),console.log(`æ’ä»¶ ${t} å·²æ³¨å†Œ`)}async initializePlugin(t){const e=this.plugins.get(t);if(!e)return console.warn(`æ’ä»¶ ${t} æœªæ³¨å†Œ`),!1;if(this.initialized.has(t))return console.warn(`æ’ä»¶ ${t} å·²ç»åˆå§‹åŒ–`),!0;try{return e.isEnabled&&!e.isEnabled()?(console.log(`æ’ä»¶ ${t} å·²ç¦ç”¨ï¼Œè·³è¿‡åˆå§‹åŒ–`),!1):(await e.initialize(),this.initialized.add(t),console.log(`æ’ä»¶ ${t} åˆå§‹åŒ–æˆåŠŸ`),!0)}catch(n){return console.error(`æ’ä»¶ ${t} åˆå§‹åŒ–å¤±è´¥:`,n),!1}}async initializeAll(){const t={success:[],failed:[],skipped:[]};for(const[e]of this.plugins){await this.initializePlugin(e)?t.success.push(e):t.failed.push(e)}return console.log("æ’ä»¶åˆå§‹åŒ–å®Œæˆ:",t),t}cleanupPlugin(t){const e=this.plugins.get(t);if(!e)return console.warn(`æ’ä»¶ ${t} æœªæ³¨å†Œ`),!1;if(!this.initialized.has(t))return console.warn(`æ’ä»¶ ${t} æœªåˆå§‹åŒ–ï¼Œæ— éœ€æ¸…ç†`),!0;try{return e.cleanup(),this.initialized.delete(t),console.log(`æ’ä»¶ ${t} æ¸…ç†æˆåŠŸ`),!0}catch(n){return console.error(`æ’ä»¶ ${t} æ¸…ç†å¤±è´¥:`,n),!1}}cleanupAll(){const t={success:[],failed:[]};for(const e of this.initialized){this.cleanupPlugin(e)?t.success.push(e):t.failed.push(e)}return console.log("æ’ä»¶æ¸…ç†å®Œæˆ:",t),t}getRegisteredPlugins(){return Array.from(this.plugins.keys())}getInitializedPlugins(){return Array.from(this.initialized)}isRegistered(t){return this.plugins.has(t)}isInitialized(t){return this.initialized.has(t)}},e={placeholder:"å¼€å§‹è¾“å…¥å†…å®¹...",autofocus:!0,hideToolbar:!1,tools:{paragraph:{class:"Paragraph",inlineToolbar:!0},header:{class:"Header",inlineToolbar:!0,config:{levels:[1,2,3],defaultLevel:1,placeholder:"è¯·è¾“å…¥æ ‡é¢˜"},toolbox:[{title:"Heading 1",icon:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M6 7L6 12M6 17L6 12M6 12L12 12M12 7V12M12 17L12 12"/><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M19 17V10.2135C19 10.1287 18.9011 10.0824 18.836 10.1367L16 12.5"/></svg>',data:{level:1}},{title:"Heading 2",icon:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M6 7L6 12M6 17L6 12M6 12L12 12M12 7V12M12 17L12 12"/><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M16 11C16 10 19 9.5 19 12C19 13.9771 16.0684 13.9997 16.0012 16.8981C15.9999 16.9533 16.0448 17 16.1 17L19.3 17"/></svg>',data:{level:2}},{title:"Heading 3",icon:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M6 7L6 12M6 17L6 12M6 12L12 12M12 7V12M12 17L12 12"/><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M16 11C16 10.5 16.8323 10 17.6 10C18.3677 10 19.5 10.311 19.5 11.5C19.5 12.5315 18.7474 12.9022 18.548 12.9823C18.5378 12.9864 18.5395 13.0047 18.5503 13.0063C18.8115 13.0456 20 13.3065 20 14.8C20 16 19.5 17 17.8 17C17.8 17 16 17 16 16.3"/></svg>',data:{level:3}}]},quote:{class:"Quote",inlineToolbar:!0,config:{quotePlaceholder:"è¾“å…¥å¼•ç”¨å†…å®¹",captionPlaceholder:"å¼•ç”¨æ¥æº"}},image:{class:"ImageTool",inlineToolbar:!0,config:{endpoints:{}}},raw:{class:"RawTool"}},minHeight:300,logLevel:"WARN"},n={toolbar:"#js_toolbar_0",editorContent:'div[contenteditable="true"].ProseMirror',editorWrapper:"#edui1_iframeholder",buttonArea:"#bottom_main",sidebar:"#js_side_article_list",authorArea:"#js_author_area",ueditor:"#ueditor_0",botBar:".js_bot_bar"},o={head:'<section data-mpa-template="t" data-mpa-template-id="23968" data-mpa-category="style_single_material"><section style="display: flex;flex-direction: column;padding: 0 10px;" data-mid=""><section style="display: flex;flex-direction: column;align-self: flex-start;" data-mid=""><section nodeleaf="" style="display: flex;justify-content: center;align-items: center;z-index: 1;width: 16px;margin: 0 0 -1px 25px;" data-mid=""><img src="https://mmbiz.qpic.cn/mmbiz_png/dEf5U8O2YzjX7RPfmgLtXZGQ4emxXdzQs0UcN2m15pprg9EBQ6X6wYZvncMFvgT45MTASpAn6tyLMN2ibLGiawRA/0?from=appmsg" alt="" style="display: block;" data-mid=""></section><section style="background: #FFFFFF;border: 1px solid #0092FF;padding: 6px 18px 5px 19px;text-align: left;border-radius: 32px;" data-mid=""><p yb-mpa-mark="mark-style-text" style="font-size: 14px;color: #333333;line-height: 20px;word-break: break-word;" data-mid="">ç‚¹å‡»ä¸Šæ–¹<span style="color: #0092ff;" data-mid="">è“å­—</span>å…³æ³¨æˆ‘ä»¬</p></section><section nodeleaf="" style="display: flex;justify-content: center;align-items: center;width: 24px;align-self: center;margin: -6px 0 0 0;" data-mid=""><img src="https://mmbiz.qpic.cn/mmbiz_gif/YtIDLfKRkon8SLKBvmCfjvZ4I8azbdaFnZbM5cE2jjuApZCV2VwwWaUAgspNrka1Qn9VQnbH2064IVdEaFl37w/0?from=appmsg" alt="" style="display: block;" data-mid=""></section></section></section></section>',ending:'<section data-mpa-template="t" data-mpa-template-id="23502" data-mpa-category="style_single_material"><section style="display: flex;flex-direction: column;" data-mid=""><section style="align-self: center;display: flex;flex-direction: column;" data-mid=""><section style="width: 100px;margin: 0 0 -21px 16px;" data-mid=""><section style="text-align: center;margin: 0 0 -16px 0;" data-mid=""><p style="font-weight: bold;font-size: 20px;color: #F1F5FF;line-height: 28px;word-break: break-word;" data-mid="">HISTORY</p></section><section style="text-align: center;" data-mid=""><p style="font-weight: bold;font-size: 16px;color: #FFD750;line-height: 22px;word-break: break-word;" data-mid="">å¾€æœŸæ¨è </p></section></section><section style="display: flex;justify-content: center;align-items: center;width: 267px;" data-mid=""><img src="https://mmbiz.qpic.cn/mmbiz_png/JnFVjHuvmJ8D1wqQf1Fef720vyhcqcoLFlPOcljZibuqdMVpKMhfnRvkraoM2pZmlvPe4Ewm8Np90Gqq9BLBufw/0?from=appmsg" data-mid=""></section><section style="width: 267px;border: 1px solid #86A4FF;border-top: none !important;padding: 8px;" data-mid=""><section style="display: flex;flex-direction: column;padding: 10px 0 11px 0;background: #F1F5FF;" data-mid=""><section data-mpa-template-rows="1" style="width: 100%;padding: 21px 27px 20px 27px;" data-mid=""><section style="display: flex;align-items: flex-start;padding: 5px 5px 5px 5px;border-bottom: 1.3px dashed #86A4FF;" data-mid=""><section style="width: 9px;height: 9px;background: #86A4FF;margin: 5px 8px 0 0;transform: skewX(-10deg);" data-mid=""></section><section style="text-align: left;" data-mid=""><p style="font-size: 14px;color: #000000;line-height: 20px;word-break: break-word;" data-mid="">å½“å­£å‡ºæ¸¸ç©¿æ­åˆ†äº«</p></section></section>\n  <section style="display: flex;align-items: flex-start;padding: 5px 5px 5px 5px;border-bottom: 1.3px dashed #86A4FF;" data-mid=""><section style="width: 9px;height: 9px;background: #86A4FF;margin: 5px 8px 0 0;transform: skewX(-10deg);" data-mid=""></section><section style="text-align: left;" data-mid=""><p style="font-size: 14px;color: #000000;line-height: 20px;word-break: break-word;" data-mid="">å‡è„‚äººåˆæ˜¥ä½ç³–é¥®å“æ¨è</p></section></section><section style="display: flex;align-items: flex-start;padding: 5px 5px 5px 5px;border-bottom: 1.3px dashed #86A4FF;" data-mid=""><section style="width: 9px;height: 9px;background: #86A4FF;margin: 5px 8px 0 0;transform: skewX(-10deg);" data-mid=""></section><section style="text-align: left;" data-mid=""><p style="font-size: 14px;color: #000000;line-height: 20px;word-break: break-word;" data-mid="">äº”ä¸€è¸é’æ—…æ¸¸èƒœåœ°æ¨è</p></section></section></section></section></section></section></section></section>',inlineStyles:{bold:"font-weight: bold;",italic:"font-style: italic;",underline:"text-decoration: underline;",strikethrough:"text-decoration: line-through;",code:"background: rgba(26, 104, 64, 0.1); padding: 2px 4px; border-radius: 3px; font-family: 'Courier New', monospace; font-size: 0.9em;",mark:"background: rgba(26, 104, 64, 0.2); padding: 1px 2px; border-radius: 2px;",small:"font-size: 0.85em;",sup:"font-size: 0.75em; vertical-align: super;",sub:"font-size: 0.75em; vertical-align: sub;",link:"color: rgba(26, 104, 64, 1); text-decoration: underline; transition: color 0.2s ease;",cite:"display: block; margin-top: 0.5em; font-size: 0.9em; color: rgba(26, 104, 64, 0.7);"},header:{h1:'<section data-mpa-template="t" data-mpa-template-id="7371" data-mpa-category="style_single_material"><section style="width: 100%;padding: 0px 12px;" data-mid=""><section style="width: 100%;display: flex;align-items: center;justify-content: space-between;" data-mid=""><section style="display: flex;align-items: center;width: 100%;height: 5px;" data-mid=""><section style="flex-shrink: 0;width: 6px;height: 6px;background: #4499e7;border-radius: 50%;" data-mid=""><span leaf=""><br class="ProseMirror-trailingBreak"></span></section><section style="width: 100%;border-top: 1px solid #4499e7;height: 1px;" data-mid=""><span leaf=""><br class="ProseMirror-trailingBreak"></span></section></section><section style="flex-shrink: 0;min-width: 79px;text-align: center;background: #4499e7;padding: 5px 15px 4px 15px;" data-mid=""><p style="color: #ffffff;font-size: 16px;line-height: 17px;word-break: break-word;" data-mid=""><span leaf="">{{content}}</span><mpchecktext></mpchecktext></p></section><section style="display: flex;align-items: center;width: 100%;" data-mid=""><section style="width: 100%;border-top: 1px solid #4499e7;height: 1px;" data-mid=""><span leaf=""><br class="ProseMirror-trailingBreak"></span></section><section style="flex-shrink: 0;width: 6px;height: 6px;background: #4499e7;border-radius: 50%;" data-mid=""><span leaf=""><br class="ProseMirror-trailingBreak"></span></section></section></section></section></section>',h2:'<section data-block="header" data-level="2" style="text-indent: 0px; margin-bottom: 8px;">\n      <h2 style="font-size: 17px; color: rgba(26, 104, 64, 1); font-weight: bold; margin: 1.5em 8px 1em; border-bottom: 1px solid rgba(26, 104, 64, 0.3); padding-bottom: 0.3em;">\n        {{content}}\n      </h2>\n    </section>',h3:'<section data-block="header" data-level="3" style="text-indent: 0px; margin-bottom: 8px;">\n      <h3 style="font-size: 15px; color: rgba(26, 104, 64, 1); font-weight: bold; margin: 1.2em 8px 0.8em;">\n        {{content}}\n      </h3>\n    </section>',h4:'<section data-block="header" data-level="4" style="text-indent: 0px; margin-bottom: 8px;">\n      <h4 style="font-size: 14px; color: rgba(26, 104, 64, 1); font-weight: bold; margin: 1em 8px 0.6em;">\n        {{content}}\n      </h4>\n    </section>',h5:'<section data-block="header" data-level="5" style="text-indent: 0px; margin-bottom: 8px;">\n      <h5 style="font-size: 13px; color: rgba(26, 104, 64, 1); font-weight: bold; margin: 0.8em 8px 0.5em;">\n        {{content}}\n      </h5>\n    </section>',h6:'<section data-block="header" data-level="6" style="text-indent: 0px; margin-bottom: 8px;">\n      <h6 style="font-size: 12px; color: rgba(26, 104, 64, 1); font-weight: bold; margin: 0.6em 8px 0.4em;">\n        {{content}}\n      </h6>\n    </section>'},paragraph:{default:'<section mpa-font-style="mbraxlmy23cq" style="font-size: 14px; margin-bottom: 8px; line-height: 2em; margin-left: 32px; margin-right: 32px; visibility: visible;" data-mpa-action-id="mbraxlnm103x" data-pm-slice="0 0 []"><span leaf="" style="visibility: visible;"><span textstyle="" style="letter-spacing: 2px; visibility: visible;">{{content}}</span></span></section>'},quote:{default:'<section data-block="quote" style="text-indent: 0px; margin-bottom: 8px;">\n      <blockquote style="margin: 1.5em 8px; padding: 1em; border-left: 4px solid rgba(26, 104, 64, 0.5); background-color: rgba(26, 104, 64, 0.05); font-style: italic;">\n        {{content}}\n        {{caption}}\n      </blockquote>\n    </section>'},delimiter:{default:'<section data-block="delimiter" style="text-indent: 0px; margin-bottom: 8px;">\n      <div style="text-align: center; margin: 2em 8px; color: rgba(26, 104, 64, 0.6); font-size: 1.2em;">\n        ----\n      </div>\n    </section>'},raw:{default:""},list:{ordered:'<section data-block="list" data-style="ordered" style="text-indent: 0px; margin-bottom: 8px;">\n      <ol style="margin: 1.5em 8px; padding-left: 2em;">\n        {{items}}\n      </ol>\n    </section>',unordered:'<section data-block="list" data-style="unordered" style="text-indent: 0px; margin-bottom: 8px;">\n      <ul style="margin: 1.5em 8px; padding-left: 2em;">\n        {{items}}\n      </ul>\n    </section>'},code:{default:'<section data-block="code" style="text-indent: 0px; margin-bottom: 8px;">\n      <pre style="margin: 1.5em 8px; padding: 1em; background-color: rgba(26, 104, 64, 0.08); border-radius: 4px; overflow-x: auto;"><code style="font-family: \'Courier New\', monospace; font-size: 14px;">{{content}}</code></pre>\n    </section>'},listItem:'<li style="margin: 0.3em 0;">{{content}}</li>',fallback:{container:"margin: 1.5em 8px; padding: 0.5em; border: 1px dashed rgba(26, 104, 64, 0.3); background-color: rgba(26, 104, 64, 0.05);",warning:"color: rgba(26, 104, 64, 0.7); font-size: 0.8em;",content:"margin-top: 0.5em;"}};class i{constructor(t){this.templates=t}process(t,e){const n=this.preprocessData(t,e),o=this.getTemplate(n,e),i=this.renderContent(n,e);return this.postprocess(o,i,n,e)}preprocessData(t,e){return t}getTemplate(t,e){const n=e.type,o=this.templates[n];if(!o)return null;switch(n){case"header":return o[`h${Math.min(Math.max(t.level||1,1),6)}`]||o.default;case"list":return o["ordered"===t.style?"ordered":"unordered"]||o.default;default:return o.default||Object.values(o)[0]}}renderContent(t,e){return this.sanitizeHtml(this.processInlineStyles(t.text||t.content||""))}postprocess(t,e,n,o){return t?t.replace(/{{content}}/g,e):(console.warn(`æœªæ‰¾åˆ°å—ç±»å‹ ${o.type} çš„æ¨¡æ¿`),this.createFallbackHtml(o))}processInlineStyles(t){if(!t)return"";let e=String(t);const n=this.templates.inlineStyles,o={"<b>":`<strong style="${n.bold}">`,"</b>":"</strong>","<strong>":`<strong style="${n.bold}">`,"<i>":`<em style="${n.italic}">`,"</i>":"</em>","<em>":`<em style="${n.italic}">`,"<u>":`<u style="${n.underline}">`,"<s>":`<s style="${n.strikethrough}">`,"<del>":`<del style="${n.strikethrough}">`,"<code>":`<code style="${n.code}">`,"<mark>":`<mark style="${n.mark}">`,"<small>":`<small style="${n.small}">`,"<sup>":`<sup style="${n.sup}">`,"<sub>":`<sub style="${n.sub}">`};return e=this.processLinkTags(e),Object.entries(o).forEach((([t,n])=>{n.includes("style=")&&e.includes(t)||(e=e.replace(new RegExp(t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g"),n))})),e}processLinkTags(t){const e=this.templates.inlineStyles.link;return t.replace(/<a\s+href=["']([^"']+)["']([^>]*)>/g,((t,n,o)=>{if(o.includes("style="))return t;try{const t=new URL(n);return"mp.weixin.qq.com"===t.hostname?`<a href="${n}" style="${e}"${o}>`:this.handleNonWeixinLink(n,o,e)}catch(i){return`<a href="${n}" style="${e}"${o}>`}}))}handleNonWeixinLink(t,e,n){return`<a href="${t}" style="${n}"${e}>`}sanitizeHtml(t){let e=t;return["script","iframe","object","embed","form"].forEach((t=>{const n=new RegExp(`<${t}[^>]*>.*?</${t}>`,"gi");e=e.replace(n,"")})),e}escapeHtml(t){return t?String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;"):""}createFallbackHtml(t){var e,n,o;const i=(null==(e=t.data)?void 0:e.text)||(null==(n=t.data)?void 0:n.content)||(null==(o=t.data)?void 0:o.code)||"",r="code"===t.type?this.escapeHtml(i):this.sanitizeHtml(this.processInlineStyles(i)),s=this.templates.fallback;return`<section data-block="${t.type}" style="text-indent: 0px; margin-bottom: 8px;">\n      <div style="${s.container}">\n        <small style="${s.warning}">æœªçŸ¥å—ç±»å‹: ${t.type}</small>\n        <div style="${s.content}">${r}</div>\n      </div>\n    </section>`}}class r extends i{renderContent(t,e){return this.escapeHtml(t.text||"")}}class s extends i{renderContent(t,e){const n=t.code||"";return this.escapeHtml(n)}validateCodeSyntax(t,e){}}class l extends i{process(t,e){const n=t.html||"";return this.isValidHtml(n)||console.warn("Invalid HTML detected in raw block"),this.sanitizeHtml(n)}isValidHtml(t){try{const e=new DOMParser;return!e.parseFromString(t,"text/html").querySelector("parsererror")}catch(e){return!1}}}class a extends i{constructor(t,e={}){super(t),this.processCaptions=!1!==e.processCaptions}postprocess(t,e,n,o){if(!t)return console.warn(`æœªæ‰¾åˆ°å—ç±»å‹ ${o.type} çš„æ¨¡æ¿`),this.createFallbackHtml(o);let i=t.replace(/{{content}}/g,e);if(this.processCaptions&&n.caption){const t=`<cite style="${this.templates.inlineStyles.cite}">${this.sanitizeHtml(this.processInlineStyles(n.caption))}</cite>`;i=i.replace(/{{caption}}/g,t)}else i=i.replace(/{{caption}}/g,"");return i}}class c extends i{postprocess(t,e,n,o){if(!t)return console.warn(`æœªæ‰¾åˆ°å—ç±»å‹ ${o.type} çš„æ¨¡æ¿`),this.createFallbackHtml(o);const i=(n.items||[]).map((t=>{const e=this.sanitizeHtml(this.processInlineStyles(t));return this.renderListItem(e)})).join("");return t.replace(/{{items}}/g,i)}renderListItem(t){return this.templates.listItem.replace(/{{content}}/g,t)}}class d extends i{preprocessData(t,e){return{}}renderContent(t,e){return""}}class p{constructor(t){this.templates=t,this.processors=new Map,this.initializeDefaultProcessors()}initializeDefaultProcessors(){this.registerProcessor("header",new r(this.templates)),this.registerProcessor("code",new s(this.templates)),this.registerProcessor("raw",new l(this.templates)),this.registerProcessor("quote",new a(this.templates)),this.registerProcessor("list",new c(this.templates)),this.registerProcessor("delimiter",new d(this.templates)),this.registerProcessor("paragraph",new i(this.templates))}registerProcessor(t,e){this.processors.set(t,e)}getProcessor(t){return this.processors.get(t)||this.getDefaultProcessor()}getDefaultProcessor(){return new i(this.templates)}}class u{constructor(t={}){this.templates=Object.keys(t).length>0?t:o,this.processorFactory=new p(this.templates)}setTemplates(t){this.templates=t,this.processorFactory=new p(this.templates)}getTemplates(){return this.templates}registerCustomProcessor(t,e){this.processorFactory.registerProcessor(t,e)}parseBlock(t){if(!t||!t.type)return console.warn("æ— æ•ˆçš„å—æ•°æ®:",t),"";return this.processorFactory.getProcessor(t.type).process(t.data||{},t)}parse(t,e={}){const{skipEmpty:n=!0}=e;if(!t||!Array.isArray(t.blocks))return console.warn("æ— æ•ˆçš„EditorJSæ•°æ®"),"";const o=t.blocks.map((t=>this.parseBlock(t))).filter((t=>!n||t.trim())).join("\n");return[this.templates.head||"",o,this.templates.ending||"",'<section><span leaf=""><br class="ProseMirror-trailingBreak"></span></section>'].filter((t=>t.trim())).join("\n")}registerTemplate(t,e,n="default"){this.templates[t]||(this.templates[t]={}),"string"==typeof e?this.templates[t][n]=e:"object"==typeof e&&(this.templates[t]={...this.templates[t],...e})}setTemplate(t,e,n){this.templates[t]||(this.templates[t]={}),this.templates[t][e]=n}renderDocument(t,e={}){const{skipEmpty:n=!0,wrapInContainer:o=!1}=e;if(!t||!Array.isArray(t.blocks))return console.warn("æ— æ•ˆçš„EditorJSæ•°æ®"),"";const i=t.blocks.map((t=>this.parseBlock(t))).filter((t=>!n||t.trim())).join("\n");return o?`<div class="editorjs-content" style="max-width: 800px; margin: 0 auto; padding: 20px;">\n${i}\n</div>`:i}getAvailableTemplates(){return{...this.templates}}setTemplates(t){this.templates={...t}}}function f(t,e={}){const n=document.createElement(t);return e.className&&(n.className=e.className),e.id&&(n.id=e.id),e.innerHTML&&(n.innerHTML=e.innerHTML),e.textContent&&(n.textContent=e.textContent),e.cssText&&(n.style.cssText=e.cssText),n}function h(t,e=document){try{return e.querySelector(t)}catch(n){return console.error(`æŸ¥è¯¢é€‰æ‹©å™¨å¤±è´¥: ${t}`,n),null}}async function m(t,e={}){try{const{targetSelector:o=n.editorContent,append:i=!0,insertPosition:r="cursor",styleOptions:s={}}=e,l=(new u).parse({blocks:t});console.log("ç”Ÿæˆçš„HTMLå†…å®¹:",l);const a=await async function(t,e={}){const{targetSelector:o=n.editorContent,append:i=!0,insertPosition:r="cursor"}=e;try{const e=h(o);if(!e)return console.error("æ‰¾ä¸åˆ°ç›®æ ‡ç¼–è¾‘å™¨:",o),!1;const n=f("div",{innerHTML:t});if(i)for(;n.firstChild;)e.appendChild(n.firstChild);else switch(r){case"start":for(;n.lastChild;)e.insertBefore(n.lastChild,e.firstChild);break;case"end":for(;n.firstChild;)e.appendChild(n.firstChild);break;default:e.innerHTML=t}return console.log("å†…å®¹æ’å…¥æˆåŠŸ"),!0}catch(s){return console.error("æ’å…¥å†…å®¹å¤±è´¥:",s),!1}}(l,{targetSelector:o,append:i,insertPosition:r});return a}catch(o){return console.error("ä¿å­˜åˆ°åŸç¼–è¾‘å™¨å¤±è´¥:",o),!1}}function g(){return!(!window.EditorJSBundle||!window.EditorJSBundle.EditorJS)}function x(t){if(!document.getElementById(t))throw new Error(`${t}å…ƒç´ ä¸å­˜åœ¨ï¼Œè¯·æ£€æŸ¥DOMç»“æ„`);try{const n={holder:t,tools:function(t){const e={};for(const[n,o]of Object.entries(t)){const{class:t,...i}=o;if(!window.EditorJSBundle||!window.EditorJSBundle[t]){console.warn(`å·¥å…·ç±» ${t} æœªæ‰¾åˆ°æˆ–æœªåŠ è½½ï¼Œè·³è¿‡å·¥å…· ${n}`);continue}const r=window.EditorJSBundle[t];r?e[n]={class:r,...i}:console.warn(`å·¥å…·ç±» ${t} æœªåŠ è½½ï¼Œè·³è¿‡å·¥å…· ${n}`)}return e}(e.tools),data:{blocks:[]},placeholder:e.placeholder,autofocus:e.autofocus,hideToolbar:e.hideToolbar,minHeight:e.minHeight,logLevel:e.logLevel,onReady:()=>{new window.EditorJSBundle.DragDrop(o)}},o=new window.EditorJSBundle.EditorJS(n);return o}catch(n){throw console.error("ç¼–è¾‘å™¨åˆå§‹åŒ–å¤±è´¥:",n),n}}async function y(t){if(!g())try{await new Promise(((t,e)=>{chrome.runtime.sendMessage("inject_editorjs_bundle",(n=>{n&&"injected"===n.status?setTimeout((()=>{g()?t():e(new Error("ç¼–è¾‘å™¨è„šæœ¬åŠ è½½å¤±è´¥"))}),100):e(new Error("ç¼–è¾‘å™¨æ³¨å…¥å¤±è´¥"))}))}))}catch(e){throw new Error("ç¼–è¾‘å™¨åŠ è½½å¤±è´¥: "+e.message)}return x(t)}new u;const w=Math.min,b=Math.max,v=Math.round,k=Math.floor,C=t=>({x:t,y:t}),z={left:"right",right:"left",bottom:"top",top:"bottom"},E={start:"end",end:"start"};function F(t,e,n){return b(t,w(e,n))}function L(t,e){return"function"==typeof t?t(e):t}function $(t){return t.split("-")[0]}function T(t){return t.split("-")[1]}function S(t){return"x"===t?"y":"x"}function A(t){return"y"===t?"height":"width"}function P(t){return["top","bottom"].includes($(t))?"y":"x"}function M(t){return S(P(t))}function R(t){return t.replace(/start|end/g,(t=>E[t]))}function H(t){return t.replace(/left|right|bottom|top/g,(t=>z[t]))}function B(t){const{x:e,y:n,width:o,height:i}=t;return{width:o,height:i,top:n,left:e,right:e+o,bottom:n+i,x:e,y:n}}function I(t,e,n){let{reference:o,floating:i}=t;const r=P(e),s=M(e),l=A(s),a=$(e),c="y"===r,d=o.x+o.width/2-i.width/2,p=o.y+o.height/2-i.height/2,u=o[l]/2-i[l]/2;let f;switch(a){case"top":f={x:d,y:o.y-i.height};break;case"bottom":f={x:d,y:o.y+o.height};break;case"right":f={x:o.x+o.width,y:p};break;case"left":f={x:o.x-i.width,y:p};break;default:f={x:o.x,y:o.y}}switch(T(e)){case"start":f[s]-=u*(n&&c?-1:1);break;case"end":f[s]+=u*(n&&c?-1:1)}return f}async function j(t,e){var n;void 0===e&&(e={});const{x:o,y:i,platform:r,rects:s,elements:l,strategy:a}=t,{boundary:c="clippingAncestors",rootBoundary:d="viewport",elementContext:p="floating",altBoundary:u=!1,padding:f=0}=L(e,t),h=function(t){return"number"!=typeof t?function(t){return{top:0,right:0,bottom:0,left:0,...t}}(t):{top:t,right:t,bottom:t,left:t}}(f),m=l[u?"floating"===p?"reference":"floating":p],g=B(await r.getClippingRect({element:null==(n=await(null==r.isElement?void 0:r.isElement(m)))||n?m:m.contextElement||await(null==r.getDocumentElement?void 0:r.getDocumentElement(l.floating)),boundary:c,rootBoundary:d,strategy:a})),x="floating"===p?{x:o,y:i,width:s.floating.width,height:s.floating.height}:s.reference,y=await(null==r.getOffsetParent?void 0:r.getOffsetParent(l.floating)),w=await(null==r.isElement?void 0:r.isElement(y))&&await(null==r.getScale?void 0:r.getScale(y))||{x:1,y:1},b=B(r.convertOffsetParentRelativeRectToViewportRelativeRect?await r.convertOffsetParentRelativeRectToViewportRelativeRect({elements:l,rect:x,offsetParent:y,strategy:a}):x);return{top:(g.top-b.top+h.top)/w.y,bottom:(b.bottom-g.bottom+h.bottom)/w.y,left:(g.left-b.left+h.left)/w.x,right:(b.right-g.right+h.right)/w.x}}function D(){return"undefined"!=typeof window}function O(t){return q(t)?(t.nodeName||"").toLowerCase():"#document"}function N(t){var e;return(null==t||null==(e=t.ownerDocument)?void 0:e.defaultView)||window}function _(t){var e;return null==(e=(q(t)?t.ownerDocument:t.document)||window.document)?void 0:e.documentElement}function q(t){return!!D()&&(t instanceof Node||t instanceof N(t).Node)}function V(t){return!!D()&&(t instanceof Element||t instanceof N(t).Element)}function W(t){return!!D()&&(t instanceof HTMLElement||t instanceof N(t).HTMLElement)}function J(t){return!(!D()||"undefined"==typeof ShadowRoot)&&(t instanceof ShadowRoot||t instanceof N(t).ShadowRoot)}function U(t){const{overflow:e,overflowX:n,overflowY:o,display:i}=K(t);return/auto|scroll|overlay|hidden|clip/.test(e+o+n)&&!["inline","contents"].includes(i)}function X(t){return["table","td","th"].includes(O(t))}function Q(t){return[":popover-open",":modal"].some((e=>{try{return t.matches(e)}catch(n){return!1}}))}function Y(t){const e=Z(),n=V(t)?K(t):t;return["transform","translate","scale","rotate","perspective"].some((t=>!!n[t]&&"none"!==n[t]))||!!n.containerType&&"normal"!==n.containerType||!e&&!!n.backdropFilter&&"none"!==n.backdropFilter||!e&&!!n.filter&&"none"!==n.filter||["transform","translate","scale","rotate","perspective","filter"].some((t=>(n.willChange||"").includes(t)))||["paint","layout","strict","content"].some((t=>(n.contain||"").includes(t)))}function Z(){return!("undefined"==typeof CSS||!CSS.supports)&&CSS.supports("-webkit-backdrop-filter","none")}function G(t){return["html","body","#document"].includes(O(t))}function K(t){return N(t).getComputedStyle(t)}function tt(t){return V(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function et(t){if("html"===O(t))return t;const e=t.assignedSlot||t.parentNode||J(t)&&t.host||_(t);return J(e)?e.host:e}function nt(t){const e=et(t);return G(e)?t.ownerDocument?t.ownerDocument.body:t.body:W(e)&&U(e)?e:nt(e)}function ot(t,e,n){var o;void 0===e&&(e=[]),void 0===n&&(n=!0);const i=nt(t),r=i===(null==(o=t.ownerDocument)?void 0:o.body),s=N(i);if(r){const t=it(s);return e.concat(s,s.visualViewport||[],U(i)?i:[],t&&n?ot(t):[])}return e.concat(i,ot(i,[],n))}function it(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function rt(t){const e=K(t);let n=parseFloat(e.width)||0,o=parseFloat(e.height)||0;const i=W(t),r=i?t.offsetWidth:n,s=i?t.offsetHeight:o,l=v(n)!==r||v(o)!==s;return l&&(n=r,o=s),{width:n,height:o,$:l}}function st(t){return V(t)?t:t.contextElement}function lt(t){const e=st(t);if(!W(e))return C(1);const n=e.getBoundingClientRect(),{width:o,height:i,$:r}=rt(e);let s=(r?v(n.width):n.width)/o,l=(r?v(n.height):n.height)/i;return s&&Number.isFinite(s)||(s=1),l&&Number.isFinite(l)||(l=1),{x:s,y:l}}const at=C(0);function ct(t){const e=N(t);return Z()&&e.visualViewport?{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}:at}function dt(t,e,n,o){void 0===e&&(e=!1),void 0===n&&(n=!1);const i=t.getBoundingClientRect(),r=st(t);let s=C(1);e&&(o?V(o)&&(s=lt(o)):s=lt(t));const l=function(t,e,n){return void 0===e&&(e=!1),!(!n||e&&n!==N(t))&&e}(r,n,o)?ct(r):C(0);let a=(i.left+l.x)/s.x,c=(i.top+l.y)/s.y,d=i.width/s.x,p=i.height/s.y;if(r){const t=N(r),e=o&&V(o)?N(o):o;let n=t,i=it(n);for(;i&&o&&e!==n;){const t=lt(i),e=i.getBoundingClientRect(),o=K(i),r=e.left+(i.clientLeft+parseFloat(o.paddingLeft))*t.x,s=e.top+(i.clientTop+parseFloat(o.paddingTop))*t.y;a*=t.x,c*=t.y,d*=t.x,p*=t.y,a+=r,c+=s,n=N(i),i=it(n)}}return B({width:d,height:p,x:a,y:c})}function pt(t,e){const n=tt(t).scrollLeft;return e?e.left+n:dt(_(t)).left+n}function ut(t,e,n){void 0===n&&(n=!1);const o=t.getBoundingClientRect();return{x:o.left+e.scrollLeft-(n?0:pt(t,o)),y:o.top+e.scrollTop}}function ft(t,e,n){let o;if("viewport"===e)o=function(t,e){const n=N(t),o=_(t),i=n.visualViewport;let r=o.clientWidth,s=o.clientHeight,l=0,a=0;if(i){r=i.width,s=i.height;const t=Z();(!t||t&&"fixed"===e)&&(l=i.offsetLeft,a=i.offsetTop)}return{width:r,height:s,x:l,y:a}}(t,n);else if("document"===e)o=function(t){const e=_(t),n=tt(t),o=t.ownerDocument.body,i=b(e.scrollWidth,e.clientWidth,o.scrollWidth,o.clientWidth),r=b(e.scrollHeight,e.clientHeight,o.scrollHeight,o.clientHeight);let s=-n.scrollLeft+pt(t);const l=-n.scrollTop;return"rtl"===K(o).direction&&(s+=b(e.clientWidth,o.clientWidth)-i),{width:i,height:r,x:s,y:l}}(_(t));else if(V(e))o=function(t,e){const n=dt(t,!0,"fixed"===e),o=n.top+t.clientTop,i=n.left+t.clientLeft,r=W(t)?lt(t):C(1);return{width:t.clientWidth*r.x,height:t.clientHeight*r.y,x:i*r.x,y:o*r.y}}(e,n);else{const n=ct(t);o={x:e.x-n.x,y:e.y-n.y,width:e.width,height:e.height}}return B(o)}function ht(t,e){const n=et(t);return!(n===e||!V(n)||G(n))&&("fixed"===K(n).position||ht(n,e))}function mt(t,e,n){const o=W(e),i=_(e),r="fixed"===n,s=dt(t,!0,r,e);let l={scrollLeft:0,scrollTop:0};const a=C(0);function c(){a.x=pt(i)}if(o||!o&&!r)if(("body"!==O(e)||U(i))&&(l=tt(e)),o){const t=dt(e,!0,r,e);a.x=t.x+e.clientLeft,a.y=t.y+e.clientTop}else i&&c();r&&!o&&i&&c();const d=!i||o||r?C(0):ut(i,l);return{x:s.left+l.scrollLeft-a.x-d.x,y:s.top+l.scrollTop-a.y-d.y,width:s.width,height:s.height}}function gt(t){return"static"===K(t).position}function xt(t,e){if(!W(t)||"fixed"===K(t).position)return null;if(e)return e(t);let n=t.offsetParent;return _(t)===n&&(n=n.ownerDocument.body),n}function yt(t,e){const n=N(t);if(Q(t))return n;if(!W(t)){let e=et(t);for(;e&&!G(e);){if(V(e)&&!gt(e))return e;e=et(e)}return n}let o=xt(t,e);for(;o&&X(o)&&gt(o);)o=xt(o,e);return o&&G(o)&&gt(o)&&!Y(o)?n:o||function(t){let e=et(t);for(;W(e)&&!G(e);){if(Y(e))return e;if(Q(e))return null;e=et(e)}return null}(t)||n}const wt={convertOffsetParentRelativeRectToViewportRelativeRect:function(t){let{elements:e,rect:n,offsetParent:o,strategy:i}=t;const r="fixed"===i,s=_(o),l=!!e&&Q(e.floating);if(o===s||l&&r)return n;let a={scrollLeft:0,scrollTop:0},c=C(1);const d=C(0),p=W(o);if((p||!p&&!r)&&(("body"!==O(o)||U(s))&&(a=tt(o)),W(o))){const t=dt(o);c=lt(o),d.x=t.x+o.clientLeft,d.y=t.y+o.clientTop}const u=!s||p||r?C(0):ut(s,a,!0);return{width:n.width*c.x,height:n.height*c.y,x:n.x*c.x-a.scrollLeft*c.x+d.x+u.x,y:n.y*c.y-a.scrollTop*c.y+d.y+u.y}},getDocumentElement:_,getClippingRect:function(t){let{element:e,boundary:n,rootBoundary:o,strategy:i}=t;const r=[..."clippingAncestors"===n?Q(e)?[]:function(t,e){const n=e.get(t);if(n)return n;let o=ot(t,[],!1).filter((t=>V(t)&&"body"!==O(t))),i=null;const r="fixed"===K(t).position;let s=r?et(t):t;for(;V(s)&&!G(s);){const e=K(s),n=Y(s);n||"fixed"!==e.position||(i=null),(r?!n&&!i:!n&&"static"===e.position&&i&&["absolute","fixed"].includes(i.position)||U(s)&&!n&&ht(t,s))?o=o.filter((t=>t!==s)):i=e,s=et(s)}return e.set(t,o),o}(e,this._c):[].concat(n),o],s=r[0],l=r.reduce(((t,n)=>{const o=ft(e,n,i);return t.top=b(o.top,t.top),t.right=w(o.right,t.right),t.bottom=w(o.bottom,t.bottom),t.left=b(o.left,t.left),t}),ft(e,s,i));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}},getOffsetParent:yt,getElementRects:async function(t){const e=this.getOffsetParent||yt,n=this.getDimensions,o=await n(t.floating);return{reference:mt(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:o.width,height:o.height}}},getClientRects:function(t){return Array.from(t.getClientRects())},getDimensions:function(t){const{width:e,height:n}=rt(t);return{width:e,height:n}},getScale:lt,isElement:V,isRTL:function(t){return"rtl"===K(t).direction}};function bt(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}function vt(t,e,n,o){void 0===o&&(o={});const{ancestorScroll:i=!0,ancestorResize:r=!0,elementResize:s="function"==typeof ResizeObserver,layoutShift:l="function"==typeof IntersectionObserver,animationFrame:a=!1}=o,c=st(t),d=i||r?[...c?ot(c):[],...ot(e)]:[];d.forEach((t=>{i&&t.addEventListener("scroll",n,{passive:!0}),r&&t.addEventListener("resize",n)}));const p=c&&l?function(t,e){let n,o=null;const i=_(t);function r(){var t;clearTimeout(n),null==(t=o)||t.disconnect(),o=null}return function s(l,a){void 0===l&&(l=!1),void 0===a&&(a=1),r();const c=t.getBoundingClientRect(),{left:d,top:p,width:u,height:f}=c;if(l||e(),!u||!f)return;const h={rootMargin:-k(p)+"px "+-k(i.clientWidth-(d+u))+"px "+-k(i.clientHeight-(p+f))+"px "+-k(d)+"px",threshold:b(0,w(1,a))||1};let m=!0;function g(e){const o=e[0].intersectionRatio;if(o!==a){if(!m)return s();o?s(!1,o):n=setTimeout((()=>{s(!1,1e-7)}),1e3)}1!==o||bt(c,t.getBoundingClientRect())||s(),m=!1}try{o=new IntersectionObserver(g,{...h,root:i.ownerDocument})}catch(x){o=new IntersectionObserver(g,h)}o.observe(t)}(!0),r}(c,n):null;let u,f=-1,h=null;s&&(h=new ResizeObserver((t=>{let[o]=t;o&&o.target===c&&h&&(h.unobserve(e),cancelAnimationFrame(f),f=requestAnimationFrame((()=>{var t;null==(t=h)||t.observe(e)}))),n()})),c&&!a&&h.observe(c),h.observe(e));let m=a?dt(t):null;return a&&function e(){const o=dt(t);m&&!bt(m,o)&&n();m=o,u=requestAnimationFrame(e)}(),n(),()=>{var t;d.forEach((t=>{i&&t.removeEventListener("scroll",n),r&&t.removeEventListener("resize",n)})),null==p||p(),null==(t=h)||t.disconnect(),h=null,a&&cancelAnimationFrame(u)}}const kt=function(t){return void 0===t&&(t=0),{name:"offset",options:t,async fn(e){var n,o;const{x:i,y:r,placement:s,middlewareData:l}=e,a=await async function(t,e){const{placement:n,platform:o,elements:i}=t,r=await(null==o.isRTL?void 0:o.isRTL(i.floating)),s=$(n),l=T(n),a="y"===P(n),c=["left","top"].includes(s)?-1:1,d=r&&a?-1:1,p=L(e,t);let{mainAxis:u,crossAxis:f,alignmentAxis:h}="number"==typeof p?{mainAxis:p,crossAxis:0,alignmentAxis:null}:{mainAxis:p.mainAxis||0,crossAxis:p.crossAxis||0,alignmentAxis:p.alignmentAxis};return l&&"number"==typeof h&&(f="end"===l?-1*h:h),a?{x:f*d,y:u*c}:{x:u*c,y:f*d}}(e,t);return s===(null==(n=l.offset)?void 0:n.placement)&&null!=(o=l.arrow)&&o.alignmentOffset?{}:{x:i+a.x,y:r+a.y,data:{...a,placement:s}}}}},Ct=function(t){return void 0===t&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:o,placement:i}=e,{mainAxis:r=!0,crossAxis:s=!1,limiter:l={fn:t=>{let{x:e,y:n}=t;return{x:e,y:n}}},...a}=L(t,e),c={x:n,y:o},d=await j(e,a),p=P($(i)),u=S(p);let f=c[u],h=c[p];if(r){const t="y"===u?"bottom":"right";f=F(f+d["y"===u?"top":"left"],f,f-d[t])}if(s){const t="y"===p?"bottom":"right";h=F(h+d["y"===p?"top":"left"],h,h-d[t])}const m=l.fn({...e,[u]:f,[p]:h});return{...m,data:{x:m.x-n,y:m.y-o,enabled:{[u]:r,[p]:s}}}}}},zt=function(t){return void 0===t&&(t={}),{name:"flip",options:t,async fn(e){var n,o;const{placement:i,middlewareData:r,rects:s,initialPlacement:l,platform:a,elements:c}=e,{mainAxis:d=!0,crossAxis:p=!0,fallbackPlacements:u,fallbackStrategy:f="bestFit",fallbackAxisSideDirection:h="none",flipAlignment:m=!0,...g}=L(t,e);if(null!=(n=r.arrow)&&n.alignmentOffset)return{};const x=$(i),y=P(l),w=$(l)===l,b=await(null==a.isRTL?void 0:a.isRTL(c.floating)),v=u||(w||!m?[H(l)]:function(t){const e=H(t);return[R(t),e,R(e)]}(l)),k="none"!==h;!u&&k&&v.push(...function(t,e,n,o){const i=T(t);let r=function(t,e,n){const o=["left","right"],i=["right","left"],r=["top","bottom"],s=["bottom","top"];switch(t){case"top":case"bottom":return n?e?i:o:e?o:i;case"left":case"right":return e?r:s;default:return[]}}($(t),"start"===n,o);return i&&(r=r.map((t=>t+"-"+i)),e&&(r=r.concat(r.map(R)))),r}(l,m,h,b));const C=[l,...v],z=await j(e,g),E=[];let F=(null==(o=r.flip)?void 0:o.overflows)||[];if(d&&E.push(z[x]),p){const t=function(t,e,n){void 0===n&&(n=!1);const o=T(t),i=M(t),r=A(i);let s="x"===i?o===(n?"end":"start")?"right":"left":"start"===o?"bottom":"top";return e.reference[r]>e.floating[r]&&(s=H(s)),[s,H(s)]}(i,s,b);E.push(z[t[0]],z[t[1]])}if(F=[...F,{placement:i,overflows:E}],!E.every((t=>t<=0))){var S,B;const t=((null==(S=r.flip)?void 0:S.index)||0)+1,e=C[t];if(e){if(!("alignment"===p&&y!==P(e))||F.every((t=>t.overflows[0]>0&&P(t.placement)===y)))return{data:{index:t,overflows:F},reset:{placement:e}}}let n=null==(B=F.filter((t=>t.overflows[0]<=0)).sort(((t,e)=>t.overflows[1]-e.overflows[1]))[0])?void 0:B.placement;if(!n)switch(f){case"bestFit":{var I;const t=null==(I=F.filter((t=>{if(k){const e=P(t.placement);return e===y||"y"===e}return!0})).map((t=>[t.placement,t.overflows.filter((t=>t>0)).reduce(((t,e)=>t+e),0)])).sort(((t,e)=>t[1]-e[1]))[0])?void 0:I[0];t&&(n=t);break}case"initialPlacement":n=l}if(i!==n)return{reset:{placement:n}}}return{}}}},Et=(t,e,n)=>{const o=new Map,i={platform:wt,...n},r={...i.platform,_c:o};return(async(t,e,n)=>{const{placement:o="bottom",strategy:i="absolute",middleware:r=[],platform:s}=n,l=r.filter(Boolean),a=await(null==s.isRTL?void 0:s.isRTL(e));let c=await s.getElementRects({reference:t,floating:e,strategy:i}),{x:d,y:p}=I(c,o,a),u=o,f={},h=0;for(let m=0;m<l.length;m++){const{name:n,fn:r}=l[m],{x:g,y:x,data:y,reset:w}=await r({x:d,y:p,initialPlacement:o,placement:u,strategy:i,middlewareData:f,rects:c,platform:s,elements:{reference:t,floating:e}});d=null!=g?g:d,p=null!=x?x:p,f={...f,[n]:{...f[n],...y}},w&&h<=50&&(h++,"object"==typeof w&&(w.placement&&(u=w.placement),w.rects&&(c=!0===w.rects?await s.getElementRects({reference:t,floating:e,strategy:i}):w.rects),({x:d,y:p}=I(c,u,a))),m=-1)}return{x:d,y:p,placement:u,strategy:i,middlewareData:f}})(t,e,{...i,platform:r})};let Ft=null;let Lt=null;async function $t(){try{await async function(){if(Tt)return void console.debug("æ™ºèƒ½ç¼–è¾‘å™¨å·²ç»æ¿€æ´»");if(!h(n.editorContent))return void alert("æ‰¾ä¸åˆ°ç¼–è¾‘å™¨å®¹å™¨");try{!function(){const t=f("div",{id:"smart-editor-container",className:"flowedit-editor-container"}),e=h(n.editorContent);if(!e)throw console.error("æ— æ³•æ‰¾åˆ°åˆé€‚çš„å‚è€ƒå…ƒç´ æ¥å®šä½æ™ºèƒ½ç¼–è¾‘å™¨ï¼Œè¯·æ£€æŸ¥é¡µé¢ç»“æ„"),new Error("æ— æ³•æ‰¾åˆ°åˆé€‚çš„å‚è€ƒå…ƒç´ æ¥å®šä½æ™ºèƒ½ç¼–è¾‘å™¨");const o=h(n.editorWrapper);o?o.appendChild(t):document.body.appendChild(t);const i=async()=>{const{x:n,y:o}=await Et(e,t,{strategy:"fixed",middleware:[{name:"cover",fn:({rects:t})=>({x:t.reference.x,y:t.reference.y})},{name:"size",fn:({rects:t})=>({data:{width:t.reference.width,height:t.reference.height}})}]});Object.assign(t.style,{position:"fixed",left:n-70+"px",top:`${o}px`,width:`${e.offsetWidth+160}px`,height:`${e.offsetHeight}px`}),console.log("æ™ºèƒ½ç¼–è¾‘å™¨å®šä½æ¨¡å¼: å®Œå…¨è¦†ç›– (Floating UI)")};i(),Ft=vt(e,t,i);const r=f("div",{id:"editor-holder",className:"flowedit-editor-holder"});t.appendChild(r),console.log("æ™ºèƒ½ç¼–è¾‘å™¨ç•Œé¢åˆ›å»ºå®Œæˆï¼Œä½¿ç”¨ Floating UI å®šä½")}(),St=function(t={}){const{onSave:e,onCancel:o}=t,i=f("div",{className:"flowedit-editor-action-bar"}),r=f("button",{textContent:"ğŸ’¾ ä¿å­˜",className:"flowedit-editor-save-btn"}),s=f("button",{textContent:"â†©ï¸ å–æ¶ˆ",className:"flowedit-editor-cancel-btn"}),l=f("div",{className:"spacer"});i.appendChild(r),i.appendChild(s),i.appendChild(l);const a=h(n.botBar);if(a){document.body.appendChild(i);const t=()=>{Et(a,i,{strategy:"fixed",middleware:[{name:"cover",fn:({rects:t})=>({x:t.reference.x,y:t.reference.y})},{name:"size",fn:({rects:t})=>({data:{width:t.reference.width,height:t.reference.height}})}]}).then((({x:t,y:e})=>{const n=a.getBoundingClientRect();Object.assign(i.style,{left:`${t}px`,top:`${e}px`,width:`${n.width}px`,height:`${n.height}px`})}))};t(),Lt=vt(a,i,t)}else console.warn("æ‰¾ä¸åˆ°botBarå…ƒç´ ï¼Œå°†æ§åˆ¶æ æ·»åŠ åˆ°bodyå¹¶ä½¿ç”¨é»˜è®¤å®šä½"),document.body.appendChild(i);return e&&"function"==typeof e&&r.addEventListener("click",e),o&&"function"==typeof o&&s.addEventListener("click",o),console.log("æ™ºèƒ½ç¼–è¾‘å™¨æ§åˆ¶æ åˆ›å»ºå®Œæˆï¼Œä½¿ç”¨ Floating UI å®šä½"),i}({onSave:Rt,onCancel:Mt}),await new Promise((t=>setTimeout(t,50))),Tt=await y("editor-holder");const t=h("#header");t&&(await new Promise((t=>setTimeout(t,100))),t.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"}),console.log("å·²æ»šåŠ¨åˆ°æ™ºèƒ½ç¼–è¾‘å™¨ä½ç½®")),console.log("æ™ºèƒ½ç¼–è¾‘å™¨æ¿€æ´»æˆåŠŸ")}catch(t){console.error("æ™ºèƒ½æ’å…¥åŠŸèƒ½å¯åŠ¨å¤±è´¥:",t),alert("æ™ºèƒ½æ’å…¥åŠŸèƒ½å¯åŠ¨å¤±è´¥"),Mt()}}()}catch(t){console.error("æ™ºèƒ½æ’å…¥æŒ‰é’®ç‚¹å‡»å¤„ç†å¤±è´¥:",t)}}let Tt=null,St=null,At=null;function Pt(){if(At)console.warn("æ™ºèƒ½æ’å…¥æŒ‰é’®åŠŸèƒ½å·²ç»åˆå§‹åŒ–");else try{At=function(){const t=f("button",{className:"flowedit-smart-btn flowedit-btn-fixed",textContent:"æ™ºèƒ½æ’å…¥"});t.addEventListener("click",$t),document.body.appendChild(t);const e=h(n.toolbar);if(!e)throw new Error(`å·¥å…·æ å®¹å™¨æœªæ‰¾åˆ°: ${n.toolbar}`);const o=e.lastElementChild||e;return Et(o,t,{placement:"right-start",middleware:[kt(o.offsetWidth),zt(),Ct({padding:8})]}).then((({x:e,y:n})=>{Object.assign(t.style,{left:`${e}px`,top:`${n}px`})})),{element:t,cleanup:()=>{t.parentNode&&t.parentNode.removeChild(t)}}}(),console.log("æ™ºèƒ½æ’å…¥æŒ‰é’®æˆåŠŸ")}catch(t){console.error("æ™ºèƒ½ç¼–è¾‘å™¨åŠŸèƒ½åˆå§‹åŒ–å¤±è´¥:",t)}}function Mt(){var t;!function(){Ft&&(Ft(),Ft=null);const t=document.getElementById("smart-editor-container");t&&(t.remove(),console.log("æ™ºèƒ½ç¼–è¾‘å™¨ç•Œé¢å·²ç§»é™¤"))}(),St&&(t=St,Lt&&(Lt(),Lt=null),t&&(t.remove(),console.log("æ™ºèƒ½ç¼–è¾‘å™¨æ§åˆ¶æ å·²ç§»é™¤")),St=null),Tt&&(!function(t){if(t)try{t.destroy()}catch(e){console.warn("ç¼–è¾‘å™¨é”€æ¯é”™è¯¯:",e)}}(Tt),Tt=null),console.log("æ™ºèƒ½ç¼–è¾‘å™¨å·²åœç”¨")}async function Rt(t={}){if(Tt)try{const e=await Tt.save();console.log("ä¿å­˜çš„æ•°æ®:",e);await m(e.blocks,{...t})?console.log("å†…å®¹å·²æˆåŠŸä¿å­˜åˆ°åŸç¼–è¾‘å™¨"):console.error("ä¿å­˜åˆ°åŸç¼–è¾‘å™¨å¤±è´¥")}catch(e){console.error("ä¿å­˜å¤±è´¥:",e)}finally{Mt()}else console.error("ç¼–è¾‘å™¨æœªåˆå§‹åŒ–")}const Ht={name:"smart-editor",initialize:async()=>{Pt()},cleanup:()=>{Mt(),At&&At.cleanup&&(At.cleanup(),At=null,console.log("æ™ºèƒ½ç¼–è¾‘å™¨åŠŸèƒ½å·²æ¸…ç†"))},isEnabled:()=>!0,isActive:()=>null!==Tt};function Bt(t){const e=document.querySelector(n.sidebar);if(e){const n="none"===e.style.display;if(e.style.display=n?"":"none",t&&t.currentTarget){const e=t.currentTarget;n?e.classList.add("on"):e.classList.remove("on")}}}let It=null;function jt(){if(It)console.warn("ä¾§è¾¹æ åŠŸèƒ½å·²ç»åˆå§‹åŒ–");else try{It=function(){const t=f("button",{className:"flowedit-switch flowedit-switch-fixed",innerHTML:'\n      <div class="flowedit-switch-track"></div>\n      <div class="flowedit-switch-thumb"></div>\n    '});t.addEventListener("click",Bt),document.body.appendChild(t);const e=h(n.toolbar);if(!e)throw new Error(`å·¥å…·æ å®¹å™¨æœªæ‰¾åˆ°: ${n.toolbar}`);const o=e.firstElementChild||e;return Et(o,t,{placement:"left-start",middleware:[kt(-o.offsetWidth),zt(),Ct({padding:8})]}).then((({x:e,y:n})=>{Object.assign(t.style,{left:`${e}px`,top:`${n}px`})})),{element:t,cleanup:()=>{t.parentNode&&t.parentNode.removeChild(t)}}}(),console.log("ä¾§è¾¹æ åŠŸèƒ½åˆå§‹åŒ–æˆåŠŸ")}catch(t){console.error("ä¾§è¾¹æ åŠŸèƒ½åˆå§‹åŒ–å¤±è´¥:",t)}}const Dt={name:"sidebar",initialize:async()=>{jt()},cleanup:()=>{It&&It.cleanup&&(It.cleanup(),It=null,console.log("ä¾§è¾¹æ åŠŸèƒ½å·²æ¸…ç†"))},isEnabled:()=>!0,isActive:()=>null!==It};const Ot=new class{constructor(){this.config={},this.initialized=!1}async initialize(){try{console.log("åˆå§‹åŒ–ç”¨æˆ·é…ç½®ç®¡ç†å™¨..."),this.initialized=!0,console.log("ç”¨æˆ·é…ç½®ç®¡ç†å™¨åˆå§‹åŒ–å®Œæˆ")}catch(t){throw console.error("ç”¨æˆ·é…ç½®ç®¡ç†å™¨åˆå§‹åŒ–å¤±è´¥:",t),t}}getUserConfig(t){return this.initialized?t?this.config[t]:this.config:(console.warn("ç”¨æˆ·é…ç½®ç®¡ç†å™¨æœªåˆå§‹åŒ–"),null)}async setUserConfig(t,e){try{return this.initialized?("object"==typeof t?this.config={...this.config,...t}:this.config[t]=e,console.log("ç”¨æˆ·é…ç½®å·²æ›´æ–°:",t),!0):(console.warn("ç”¨æˆ·é…ç½®ç®¡ç†å™¨æœªåˆå§‹åŒ–"),!1)}catch(n){return console.error("è®¾ç½®ç”¨æˆ·é…ç½®å¤±è´¥:",n),!1}}},Nt=new class{constructor(){this.initialized=!1,this.styleCache={},this.syncInterval=null}async initialize(){try{console.log("åˆå§‹åŒ–è¿œç¨‹æ ·å¼åŒæ­¥æœåŠ¡..."),this.initialized=!0,console.log("è¿œç¨‹æ ·å¼åŒæ­¥æœåŠ¡åˆå§‹åŒ–å®Œæˆ")}catch(t){throw console.error("è¿œç¨‹æ ·å¼åŒæ­¥æœåŠ¡åˆå§‹åŒ–å¤±è´¥:",t),t}}async manualSync(){try{return this.initialized?(console.log("å¼€å§‹æ‰‹åŠ¨åŒæ­¥è¿œç¨‹æ ·å¼..."),console.log("è¿œç¨‹æ ·å¼åŒæ­¥å®Œæˆ"),!0):(console.warn("è¿œç¨‹æ ·å¼åŒæ­¥æœåŠ¡æœªåˆå§‹åŒ–"),!1)}catch(t){return console.error("è¿œç¨‹æ ·å¼åŒæ­¥å¤±è´¥:",t),!1}}startAutoSync(t=3e4){this.syncInterval&&clearInterval(this.syncInterval),this.syncInterval=setInterval((async()=>{await this.manualSync()}),t),console.log(`è¿œç¨‹æ ·å¼è‡ªåŠ¨åŒæ­¥å·²å¯åŠ¨ï¼Œé—´éš”: ${t}ms`)}stopAutoSync(){this.syncInterval&&(clearInterval(this.syncInterval),this.syncInterval=null,console.log("è¿œç¨‹æ ·å¼è‡ªåŠ¨åŒæ­¥å·²åœæ­¢"))}};async function _t(t={}){try{return console.log("å¼€å§‹åˆå§‹åŒ–FlowEditåº”ç”¨æœåŠ¡..."),await Ot.initialize(),await async function(t={}){try{if(await Nt.initialize(),!1!==t.enableAutoSync){const e=t.syncInterval||3e4;Nt.startAutoSync(e)}!1!==t.initialSync&&await Nt.manualSync(),console.log("è¿œç¨‹æ ·å¼ç³»ç»Ÿåˆå§‹åŒ–å®Œæˆ")}catch(e){console.error("è¿œç¨‹æ ·å¼ç³»ç»Ÿåˆå§‹åŒ–å¤±è´¥:",e)}}(t),console.log("FlowEditåº”ç”¨æœåŠ¡åˆå§‹åŒ–å®Œæˆ"),!0}catch(e){return console.error("FlowEditåº”ç”¨æœåŠ¡åˆå§‹åŒ–å¤±è´¥:",e),!1}}async function qt(){if(!document.querySelector("#js_toolbar_0"))return void console.log("FlowEdit æ’ä»¶åŠŸèƒ½æ¨¡å—åˆå§‹åŒ–å¤±è´¥ï¼šé¡µé¢å¯èƒ½æœªç™»å½•");!function(){const t="flow-editor-plugin-styles";if(!document.getElementById(t)){const e=document.createElement("style");e.id=t,e.setAttribute("data-flowedit-plugin-ui","true"),e.textContent="\n      /* FlowEdit æ’ä»¶UIæ ·å¼ */\n      \n  /* æ‰©å±•æŒ‰é’®åŸºç¡€æ ·å¼ */\n    .flowedit-smart-btn {\n    /* åŸºç¡€æ ·å¼ */\n    display: inline-block;\n    height: 22px;\n    cursor: pointer;\n    border: none;\n    outline: none;\n    box-sizing: border-box;\n    \n    /* ç‰¹å®šæ ·å¼ */\n    background-color: #07c160;\n    color: white;\n    border-radius: 4px;\n    padding: 0 12px;\n    font-size: 12px;\n    line-height: 22px;\n    transition: all 0.3s ease;\n  }\n\n    /* å›ºå®šå®šä½æŒ‰é’®æ ·å¼ */\n  .flowedit-btn-fixed {\n    position: fixed;\n    z-index: 100;\n  }\n  \n  /* æ™ºèƒ½æ’å…¥æŒ‰é’®æ‚¬æµ®æ•ˆæœ */\n  .flowedit-smart-btn:hover {\n    background-color: #07c160;\n    background-image: linear-gradient(to bottom, #07C160 0, #07C160 100%);\n    border-color: #07C160;\n    color: #FFFFFF;\n    transform: translateY(-1px);\n    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n  }\n\n      \n  /* Switchå¼€å…³æ ·å¼ */\n  .flowedit-switch {\n    display: inline-block;\n    height: 22px;\n    cursor: pointer;\n    position: relative;\n    width: 40px;\n    border: none;\n    outline: none;\n    box-sizing: border-box;\n  }\n\n    /* å›ºå®šå®šä½çš„å¼€å…³æ ·å¼ */\n  .flowedit-switch-fixed {\n    position: fixed;\n    z-index: 100;\n  }\n  \n  .flowedit-switch-track {\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    background-color: #ccc;\n    border-radius: 11px;\n    transition: all 0.3s ease;\n  }\n  \n  .flowedit-switch-thumb {\n    position: absolute;\n    width: 18px;\n    height: 18px;\n    left: 2px;\n    bottom: 2px;\n    background-color: white;\n    border-radius: 50%;\n    transition: transform 0.3s ease;\n  }\n  \n  .flowedit-switch.on .flowedit-switch-track {\n    background-color: #07c160;\n  }\n  \n  .flowedit-switch.on .flowedit-switch-thumb {\n    transform: translateX(18px);\n  }\n\n      \n  /* æ™ºèƒ½æ’å…¥ç¼–è¾‘å™¨å®¹å™¨æ ·å¼ */\n  .flowedit-editor-container {\n    position: fixed; /* ç»Ÿä¸€ä½¿ç”¨ fixed */\n    background: #fff;\n    border-radius: 4px;\n    box-sizing: border-box;\n    overflow: hidden;\n    padding: 0 30px 0 55px;\n    z-index: 10;\n  }\n  \n  /* æ™ºèƒ½æ’å…¥ç¼–è¾‘å™¨å ä½å…ƒç´ æ ·å¼ */\n  .flowedit-editor-holder {\n    padding: 0;\n  }\n  \n  /* æ™ºèƒ½æ’å…¥æ§åˆ¶æ æ ·å¼ */\n  .flowedit-editor-action-bar {\n    position: fixed; /* ç»Ÿä¸€ä½¿ç”¨ fixed */\n    background-color: #ffffff;\n    display: flex;\n    justify-content: flex-end;\n    align-items: center; /* ä¸Šä¸‹å±…ä¸­å¯¹é½ */\n    gap: 15px;\n    z-index: 120; /* ç»Ÿä¸€å±‚çº§å€¼ */\n    bottom: 0; /* å›ºå®šåœ¨åº•éƒ¨ */\n  }\n\n  /* é€æ˜å ä½å…ƒç´ æ ·å¼ */\n  .spacer {\n    width: 20px; /* æ§åˆ¶å³è¾¹è· */\n    height: 1px; /* æ— å®é™…é«˜åº¦ï¼Œä»…å ä½ */\n  }\n  \n  /* æ™ºèƒ½æ’å…¥ä¿å­˜æŒ‰é’®æ ·å¼ */\n  .flowedit-editor-save-btn {\n    padding: 4px 12px;\n    height: 34px;\n    width: 98px;\n    display: inline-block;\n    background: #07c160;\n    color: white;\n    border: none;\n    border-radius: 4px;\n    cursor: pointer;\n    font-size: 14px;\n    transition: all 0.3s ease;\n  }\n  \n\n  \n  /* æ™ºèƒ½æ’å…¥å–æ¶ˆæŒ‰é’®æ ·å¼ */\n  .flowedit-editor-cancel-btn {\n    padding: 4px 12px;\n    height: 34px;\n    width: 98px;\n    display: inline-block;\n    background: #999999;\n    color: white;\n    border: none;\n    border-radius: 4px;\n    cursor: pointer;\n    font-size: 14px;\n    transition: all 0.3s ease;\n  }\n\n    ",document.head.appendChild(e),console.log("FlowEdit æ’ä»¶UIæ ·å¼å·²æ³¨å…¥")}}();const e=await t.initializeAll();e.success.length>0&&console.log(`æˆåŠŸåˆå§‹åŒ–åŠŸèƒ½æ¨¡å—: ${e.success.join(", ")}`),e.failed.length>0&&console.warn(`åˆå§‹åŒ–å¤±è´¥çš„åŠŸèƒ½æ¨¡å—: ${e.failed.join(", ")}`),console.log("FlowEdit æ’ä»¶åŠŸèƒ½æ¨¡å—åˆå§‹åŒ–å®Œæˆ")}t.register("smart-editor",Ht),t.register("sidebar",Dt),async function(){console.log("FlowEdit å†…å®¹è„šæœ¬å¯åŠ¨"),"loading"===document.readyState&&await new Promise((t=>{document.addEventListener("DOMContentLoaded",t)}));try{await _t(),console.log("FlowEdit åº”ç”¨æœåŠ¡åˆå§‹åŒ–æˆåŠŸ")}catch(t){console.error("FlowEdit åº”ç”¨æœåŠ¡åˆå§‹åŒ–å¤±è´¥:",t)}await qt()}().catch((t=>{console.error("FlowEdit å¯åŠ¨å¤±è´¥:",t)}))}();
