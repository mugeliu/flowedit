!function(){"use strict";const n={editor:{placeholder:"åœ¨æ­¤è¾“å…¥å†…å®¹...",tools:{header:{levels:[2,3,4],defaultLevel:2,placeholder:"è¯·è¾“å…¥æ ‡é¢˜"}}}},e={toolbar:"#js_toolbar_0",editor:"#ueditor_0",proseMirror:"#ueditor_0 .ProseMirror",buttonArea:"#js_button_area",sidebar:"#js_side_article_list"};function t(){const n=document.querySelector(e.proseMirror);if(!n)return{blocks:[]};const t=n.textContent.trim();return t?{blocks:[{type:"paragraph",data:{text:t}}]}:{blocks:[]}}function o(){return!!(window.EditorJS&&window.Paragraph&&window.Header)}function r(n,e={}){const t=document.createElement(n);return e.className&&(t.className=e.className),e.id&&(t.id=e.id),e.innerHTML&&(t.innerHTML=e.innerHTML),e.textContent&&(t.textContent=e.textContent),e.cssText&&(t.style.cssText=e.cssText),t}function i(n,e=document){try{return e.querySelector(n)}catch(t){return console.error(`æŸ¥è¯¢é€‰æ‹©å™¨å¤±è´¥: ${n}`,t),null}}let l=null,a={},d=[],s=null;async function c(){if(l)return;const c=document.querySelector(e.editor);if(c)try{a=function(n){const e={};return n.forEach((n=>{const t=document.getElementById(n);t&&(e[n]=t.style.display,t.style.display="none")})),e}(["ueditor_0","article_setting_area"]),d=function(){const n=document.getElementById(e.buttonArea.replace("#",""));if(!n)return[];const t=Array.from(n.children),o=t.map((n=>({element:n,display:n.style.display})));return t.forEach((n=>{n.style.display="none"})),o}(),function(n){const t=r("div",{id:"smart-editor-container",className:"flowedit-editor-container"}),o=i("#edui1_iframeholder");o?o.appendChild(t):n.parentNode.insertBefore(t,n.nextSibling);const l=r("div",{id:"editor-holder",className:"flowedit-editor-holder"});t.appendChild(l),function(){s=r("div",{className:"flowedit-editor-action-bar"});const n=r("button",{textContent:"ğŸ’¾ ä¿å­˜",className:"flowedit-editor-save-btn"}),t=r("button",{textContent:"â†©ï¸ å–æ¶ˆ",className:"flowedit-editor-cancel-btn"});s.appendChild(n),s.appendChild(t);const o=i(e.buttonArea);o?o.appendChild(s):(console.warn("æ‰¾ä¸åˆ°æŒ‰é’®åŒºåŸŸï¼Œå°†æ§åˆ¶æ æ·»åŠ åˆ°body"),document.body.appendChild(s));n.addEventListener("click",p),t.addEventListener("click",u)}()}(c),await new Promise((n=>setTimeout(n,50))),await async function(){if(!o())try{await new Promise(((n,e)=>{chrome.runtime.sendMessage("inject_editorjs_bundle",(t=>{t&&"injected"===t.status?setTimeout((()=>{o()?n():e(new Error("ç¼–è¾‘å™¨è„šæœ¬åŠ è½½å¤±è´¥"))}),100):e(new Error("ç¼–è¾‘å™¨æ³¨å…¥å¤±è´¥"))}))}))}catch(e){throw new Error("ç¼–è¾‘å™¨åŠ è½½å¤±è´¥: "+e.message)}!function(){const o=n.editor;if(!document.getElementById("editor-holder"))throw new Error("editor-holderå…ƒç´ ä¸å­˜åœ¨ï¼Œè¯·æ£€æŸ¥DOMç»“æ„");try{l=new EditorJS({holder:"editor-holder",tools:{paragraph:{class:Paragraph,inlineToolbar:!0},header:{class:Header,inlineToolbar:!0,config:{placeholder:o.tools.header.placeholder,levels:o.tools.header.levels,defaultLevel:o.tools.header.defaultLevel}}},data:t(),placeholder:o.placeholder})}catch(e){throw console.error("ç¼–è¾‘å™¨åˆå§‹åŒ–å¤±è´¥:",e),e}}()}()}catch(f){console.error("æ™ºèƒ½æ’å…¥åŠŸèƒ½å¯åŠ¨å¤±è´¥:",f),alert("æ™ºèƒ½æ’å…¥åŠŸèƒ½å¯åŠ¨å¤±è´¥"),u()}else alert("æ‰¾ä¸åˆ°ç¼–è¾‘å™¨å®¹å™¨")}async function p(){if(l)try{const{blocks:n}=await l.save(),t=function(n){const t=document.querySelector(e.proseMirror);if(!t)return console.error("æ‰¾ä¸åˆ°ç›®æ ‡ç¼–è¾‘å™¨"),!1;try{return t.innerHTML=n.map((n=>`<p>${n.data.text.replace(/\n/g,"<br>")}</p>`)).join(""),!0}catch(o){return console.error("ä¿å­˜å†…å®¹å¤±è´¥:",o),!1}}(n);t?alert("å†…å®¹å·²ä¿å­˜ï¼"):alert("è­¦å‘Šï¼šä¿å­˜å¤±è´¥ï¼Œå·²æ¢å¤åŸçŠ¶")}catch(n){console.error("ä¿å­˜å¤±è´¥:",n),alert("ä¿å­˜å¤±è´¥ï¼Œè¯·æŸ¥çœ‹æ§åˆ¶å°")}finally{u()}}function u(){var n;d.length>0&&(d.forEach((({element:n,display:e})=>{n.style.display=e})),d=[]),Object.keys(a).length>0&&(n=a,Object.entries(n).forEach((([n,e])=>{const t=document.getElementById(n);t&&(t.style.display=e)})),a={});const e=document.getElementById("smart-editor-container");if(e&&e.remove(),s&&(s.remove(),s=null),l){try{l.destroy()}catch(t){console.warn("ç¼–è¾‘å™¨é”€æ¯é”™è¯¯:",t)}l=null}}function f(n){const t=document.querySelector(e.sidebar);if(t){const e="none"===t.style.display;t.style.display=e?"":"none";const o=n.currentTarget;e?o.classList.add("on"):o.classList.remove("on")}}!function(){const n="flowedit-styles";if(!document.getElementById(n)){const e=document.createElement("style");e.id=n,e.textContent="\n      \n  /* æ‰©å±•æŒ‰é’®åŸºç¡€æ ·å¼ */\n  .flowedit-btn {\n    display: inline-block;\n    height: 22px;\n    margin: 1px 4px;\n    vertical-align: middle;\n    cursor: pointer;\n    border: none;\n    outline: none;\n    box-sizing: border-box;\n  }\n  \n  /* æ™ºèƒ½æ’å…¥æŒ‰é’®æ ·å¼ */\n  .flowedit-smart-btn {\n    background-color: #07c160;\n    color: white;\n    border-radius: 4px;\n    padding: 0 12px;\n    font-size: 12px;\n    line-height: 22px;\n  }\n\n      \n  /* Switchå¼€å…³æ ·å¼ */\n  .flowedit-switch {\n    display: inline-block;\n    height: 22px;\n    margin: 1px 4px;\n    vertical-align: middle;\n    cursor: pointer;\n    position: relative;\n    width: 40px;\n    border: none;\n    outline: none;\n    box-sizing: border-box;\n  }\n  \n  .flowedit-switch-track {\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    background-color: #ccc;\n    border-radius: 11px;\n    transition: background-color 0.3s ease;\n  }\n  \n  .flowedit-switch-thumb {\n    position: absolute;\n    width: 18px;\n    height: 18px;\n    left: 2px;\n    bottom: 2px;\n    background-color: white;\n    border-radius: 50%;\n    transition: transform 0.3s ease;\n  }\n  \n  .flowedit-switch.on .flowedit-switch-track {\n    background-color: #07c160;\n  }\n  \n  .flowedit-switch.on .flowedit-switch-thumb {\n    transform: translateX(18px);\n  }\n\n      \n  /* æ™ºèƒ½æ’å…¥ç¼–è¾‘å™¨å®¹å™¨æ ·å¼ */\n  .flowedit-editor-container {\n    position: absolute;\n    top: 0;\n    left: 0;\n    z-index: 1;\n    width: calc(100% + 8px);\n    box-sizing: content-box;\n    margin-left: -95px;\n    padding: 0 91px;\n    background: #fff;\n  }\n  \n  /* æ™ºèƒ½æ’å…¥ç¼–è¾‘å™¨å ä½å…ƒç´ æ ·å¼ */\n  .flowedit-editor-holder {\n    margin-left: -95px;\n    padding: 0 91px;\n  }\n  \n  /* æ™ºèƒ½æ’å…¥æ§åˆ¶æ æ ·å¼ */\n  .flowedit-editor-action-bar {\n    padding: 20px 20px 15px 20px;\n    margin: 0;\n    background-color: #ffffff;\n    color: rgb(53, 53, 53);\n    font-family: mp-quote, 'PingFang SC', system-ui, -apple-system, BlinkMacSystemFont, 'Helvetica Neue', 'Hiragino Sans GB', 'Microsoft YaHei UI', 'Microsoft YaHei', Arial, sans-serif;\n    font-size: 14px;\n    line-height: 22.4px;\n    word-break: break-all;\n    box-sizing: content-box;\n    display: flex;\n    justify-content: flex-end;\n    gap: 10px;\n    z-index: 1000;\n  }\n  \n  /* æ™ºèƒ½æ’å…¥ä¿å­˜æŒ‰é’®æ ·å¼ */\n  .flowedit-editor-save-btn {\n    padding: 4px 12px;\n    height: 34px;\n    width: 98px;\n    display: inline-block;\n    background: #07c160;\n    color: white;\n    border: none;\n    border-radius: 4px;\n    cursor: pointer;\n    font-size: 14px;\n  }\n  \n  /* æ™ºèƒ½æ’å…¥å–æ¶ˆæŒ‰é’®æ ·å¼ */\n  .flowedit-editor-cancel-btn {\n    padding: 4px 12px;\n    height: 34px;\n    width: 98px;\n    display: inline-block;\n    background: #999999;\n    color: white;\n    border: none;\n    border-radius: 4px;\n    cursor: pointer;\n    font-size: 14px;\n  }\n\n    ",document.head.appendChild(e)}}(),function(){const n=i(e.toolbar);if(!n)return void console.warn("æ‰¾ä¸åˆ°å·¥å…·æ åŒºåŸŸ");const t=function(){const n=r("button",{className:"flowedit-switch",innerHTML:'\n      <div class="flowedit-switch-track"></div>\n      <div class="flowedit-switch-thumb"></div>\n    '});return n.addEventListener("click",f),n}(),o=i(e.sidebar);t&&o?n.firstElementChild?n.insertBefore(t,n.firstElementChild):n.appendChild(t):console.warn("ä¾§è¾¹æ åˆ‡æ¢æŒ‰é’®åˆå§‹åŒ–å¤±è´¥ï¼šç¼ºå°‘å¿…è¦çš„DOMå…ƒç´ ");const l=function(){const n=r("button",{className:"flowedit-btn flowedit-smart-btn",textContent:"æ™ºèƒ½æ’å…¥"});return n.addEventListener("click",c),n}(),a=i(e.editor);l&&a?n.appendChild(l):console.warn("æ™ºèƒ½æ’å…¥æŒ‰é’®åˆå§‹åŒ–å¤±è´¥ï¼šç¼ºå°‘å¿…è¦çš„DOMå…ƒç´ ")}()}();
