!function(){"use strict";const t=new class{constructor(){this.plugins=new Map,this.initialized=new Set}register(t,e){if(!e.initialize||"function"!=typeof e.initialize)throw new Error(`æ’ä»¶ ${t} å¿…é¡»æä¾› initialize æ–¹æ³•`);if(!e.cleanup||"function"!=typeof e.cleanup)throw new Error(`æ’ä»¶ ${t} å¿…é¡»æä¾› cleanup æ–¹æ³•`);this.plugins.set(t,e),console.log(`æ’ä»¶ ${t} å·²æ³¨å†Œ`)}async initializePlugin(t,e){const n=this.plugins.get(t);if(!n)return console.warn(`æ’ä»¶ ${t} æœªæ³¨å†Œ`),!1;if(this.initialized.has(t))return console.warn(`æ’ä»¶ ${t} å·²ç»åˆå§‹åŒ–`),!0;try{return n.isEnabled&&!n.isEnabled()?(console.log(`æ’ä»¶ ${t} å·²ç¦ç”¨ï¼Œè·³è¿‡åˆå§‹åŒ–`),!1):(await n.initialize(e),this.initialized.add(t),console.log(`æ’ä»¶ ${t} åˆå§‹åŒ–æˆåŠŸ`),!0)}catch(o){return console.error(`æ’ä»¶ ${t} åˆå§‹åŒ–å¤±è´¥:`,o),!1}}async initializeAll(t){const e={success:[],failed:[],skipped:[]};for(const[n]of this.plugins){await this.initializePlugin(n,t)?e.success.push(n):e.failed.push(n)}return console.log("æ’ä»¶åˆå§‹åŒ–å®Œæˆ:",e),e}cleanupPlugin(t){const e=this.plugins.get(t);if(!e)return console.warn(`æ’ä»¶ ${t} æœªæ³¨å†Œ`),!1;if(!this.initialized.has(t))return console.warn(`æ’ä»¶ ${t} æœªåˆå§‹åŒ–ï¼Œæ— éœ€æ¸…ç†`),!0;try{return e.cleanup(),this.initialized.delete(t),console.log(`æ’ä»¶ ${t} æ¸…ç†æˆåŠŸ`),!0}catch(n){return console.error(`æ’ä»¶ ${t} æ¸…ç†å¤±è´¥:`,n),!1}}cleanupAll(){const t={success:[],failed:[]};for(const e of this.initialized){this.cleanupPlugin(e)?t.success.push(e):t.failed.push(e)}return console.log("æ’ä»¶æ¸…ç†å®Œæˆ:",t),t}getRegisteredPlugins(){return Array.from(this.plugins.keys())}getInitializedPlugins(){return Array.from(this.initialized)}isRegistered(t){return this.plugins.has(t)}isInitialized(t){return this.initialized.has(t)}},e={placeholder:"å¼€å§‹è¾“å…¥å†…å®¹...",autofocus:!0,hideToolbar:!1,tools:{paragraph:{class:"Paragraph",inlineToolbar:!0},header:{class:"Header",inlineToolbar:!0,config:{levels:[1,2,3],defaultLevel:1,placeholder:"è¯·è¾“å…¥æ ‡é¢˜"},toolbox:[{title:"Heading 1",icon:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M6 7L6 12M6 17L6 12M6 12L12 12M12 7V12M12 17L12 12"/><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M19 17V10.2135C19 10.1287 18.9011 10.0824 18.836 10.1367L16 12.5"/></svg>',data:{level:1}},{title:"Heading 2",icon:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M6 7L6 12M6 17L6 12M6 12L12 12M12 7V12M12 17L12 12"/><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M16 11C16 10 19 9.5 19 12C19 13.9771 16.0684 13.9997 16.0012 16.8981C15.9999 16.9533 16.0448 17 16.1 17L19.3 17"/></svg>',data:{level:2}},{title:"Heading 3",icon:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M6 7L6 12M6 17L6 12M6 12L12 12M12 7V12M12 17L12 12"/><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M16 11C16 10.5 16.8323 10 17.6 10C18.3677 10 19.5 10.311 19.5 11.5C19.5 12.5315 18.7474 12.9022 18.548 12.9823C18.5378 12.9864 18.5395 13.0047 18.5503 13.0063C18.8115 13.0456 20 13.3065 20 14.8C20 16 19.5 17 17.8 17C17.8 17 16 17 16 16.3"/></svg>',data:{level:3}}]},quote:{class:"Quote",inlineToolbar:!0,config:{quotePlaceholder:"è¾“å…¥å¼•ç”¨å†…å®¹",captionPlaceholder:"å¼•ç”¨æ¥æº"}},image:{class:"ImageTool",inlineToolbar:!0,config:{endpoints:{}}},raw:{class:"RawTool"}},minHeight:300,logLevel:"WARN"},n={toolbar:"#js_toolbar_0",editorContent:'div[contenteditable="true"].ProseMirror',editorWrapper:"#edui1_iframeholder",buttonArea:"#bottom_main",sidebar:"#js_side_article_list",authorArea:"#js_author_area",ueditor:"#ueditor_0",botBar:".js_bot_bar.tool_area"},o={head:'<section data-mpa-template="t" data-mpa-template-id="23968" data-mpa-category="style_single_material"><section style="display: flex;flex-direction: column;padding: 0 10px;" data-mid=""><section style="display: flex;flex-direction: column;align-self: flex-start;" data-mid=""><section nodeleaf="" style="display: flex;justify-content: center;align-items: center;z-index: 1;width: 16px;margin: 0 0 -1px 25px;" data-mid=""><img src="https://mmbiz.qpic.cn/mmbiz_png/dEf5U8O2YzjX7RPfmgLtXZGQ4emxXdzQs0UcN2m15pprg9EBQ6X6wYZvncMFvgT45MTASpAn6tyLMN2ibLGiawRA/0?from=appmsg" alt="" style="display: block;" data-mid=""></section><section style="background: #FFFFFF;border: 1px solid #0092FF;padding: 6px 18px 5px 19px;text-align: left;border-radius: 32px;" data-mid=""><p yb-mpa-mark="mark-style-text" style="font-size: 14px;color: #333333;line-height: 20px;word-break: break-word;" data-mid="">ç‚¹å‡»ä¸Šæ–¹<span style="color: #0092ff;" data-mid="">è“å­—</span>å…³æ³¨æˆ‘ä»¬</p></section><section nodeleaf="" style="display: flex;justify-content: center;align-items: center;width: 24px;align-self: center;margin: -6px 0 0 0;" data-mid=""><img src="https://mmbiz.qpic.cn/mmbiz_gif/YtIDLfKRkon8SLKBvmCfjvZ4I8azbdaFnZbM5cE2jjuApZCV2VwwWaUAgspNrka1Qn9VQnbH2064IVdEaFl37w/0?from=appmsg" alt="" style="display: block;" data-mid=""></section></section></section></section>',ending:'<section data-mpa-template="t" data-mpa-template-id="23502" data-mpa-category="style_single_material"><section style="display: flex;flex-direction: column;" data-mid=""><section style="align-self: center;display: flex;flex-direction: column;" data-mid=""><section style="width: 100px;margin: 0 0 -21px 16px;" data-mid=""><section style="text-align: center;margin: 0 0 -16px 0;" data-mid=""><p style="font-weight: bold;font-size: 20px;color: #F1F5FF;line-height: 28px;word-break: break-word;" data-mid="">HISTORY</p></section><section style="text-align: center;" data-mid=""><p style="font-weight: bold;font-size: 16px;color: #FFD750;line-height: 22px;word-break: break-word;" data-mid="">å¾€æœŸæ¨è </p></section></section><section style="display: flex;justify-content: center;align-items: center;width: 267px;" data-mid=""><img src="https://mmbiz.qpic.cn/mmbiz_png/JnFVjHuvmJ8D1wqQf1Fef720vyhcqcoLFlPOcljZibuqdMVpKMhfnRvkraoM2pZmlvPe4Ewm8Np90Gqq9BLBufw/0?from=appmsg" data-mid=""></section><section style="width: 267px;border: 1px solid #86A4FF;border-top: none !important;padding: 8px;" data-mid=""><section style="display: flex;flex-direction: column;padding: 10px 0 11px 0;background: #F1F5FF;" data-mid=""><section data-mpa-template-rows="1" style="width: 100%;padding: 21px 27px 20px 27px;" data-mid=""><section style="display: flex;align-items: flex-start;padding: 5px 5px 5px 5px;border-bottom: 1.3px dashed #86A4FF;" data-mid=""><section style="width: 9px;height: 9px;background: #86A4FF;margin: 5px 8px 0 0;transform: skewX(-10deg);" data-mid=""></section><section style="text-align: left;" data-mid=""><p style="font-size: 14px;color: #000000;line-height: 20px;word-break: break-word;" data-mid="">å½“å­£å‡ºæ¸¸ç©¿æ­åˆ†äº«</p></section></section>\n  <section style="display: flex;align-items: flex-start;padding: 5px 5px 5px 5px;border-bottom: 1.3px dashed #86A4FF;" data-mid=""><section style="width: 9px;height: 9px;background: #86A4FF;margin: 5px 8px 0 0;transform: skewX(-10deg);" data-mid=""></section><section style="text-align: left;" data-mid=""><p style="font-size: 14px;color: #000000;line-height: 20px;word-break: break-word;" data-mid="">å‡è„‚äººåˆæ˜¥ä½ç³–é¥®å“æ¨è</p></section></section><section style="display: flex;align-items: flex-start;padding: 5px 5px 5px 5px;border-bottom: 1.3px dashed #86A4FF;" data-mid=""><section style="width: 9px;height: 9px;background: #86A4FF;margin: 5px 8px 0 0;transform: skewX(-10deg);" data-mid=""></section><section style="text-align: left;" data-mid=""><p style="font-size: 14px;color: #000000;line-height: 20px;word-break: break-word;" data-mid="">äº”ä¸€è¸é’æ—…æ¸¸èƒœåœ°æ¨è</p></section></section></section></section></section></section></section></section>',inlineStyles:{bold:"font-weight: bold;",italic:"font-style: italic;",underline:"text-decoration: underline;",strikethrough:"text-decoration: line-through;",code:"background: rgba(26, 104, 64, 0.1); padding: 2px 4px; border-radius: 3px; font-family: 'Courier New', monospace; font-size: 0.9em;",mark:"background: rgba(26, 104, 64, 0.2); padding: 1px 2px; border-radius: 2px;",small:"font-size: 0.85em;",sup:"font-size: 0.75em; vertical-align: super;",sub:"font-size: 0.75em; vertical-align: sub;",link:"color: rgba(26, 104, 64, 1); text-decoration: underline; transition: color 0.2s ease;",cite:"display: block; margin-top: 0.5em; font-size: 0.9em; color: rgba(26, 104, 64, 0.7);"},header:{h1:'<section data-mpa-template="t" data-mpa-template-id="7371" data-mpa-category="style_single_material"><section style="width: 100%;padding: 0px 12px;" data-mid=""><section style="width: 100%;display: flex;align-items: center;justify-content: space-between;" data-mid=""><section style="display: flex;align-items: center;width: 100%;height: 5px;" data-mid=""><section style="flex-shrink: 0;width: 6px;height: 6px;background: #4499e7;border-radius: 50%;" data-mid=""><span leaf=""><br class="ProseMirror-trailingBreak"></span></section><section style="width: 100%;border-top: 1px solid #4499e7;height: 1px;" data-mid=""><span leaf=""><br class="ProseMirror-trailingBreak"></span></section></section><section style="flex-shrink: 0;min-width: 79px;text-align: center;background: #4499e7;padding: 5px 15px 4px 15px;" data-mid=""><p style="color: #ffffff;font-size: 16px;line-height: 17px;word-break: break-word;" data-mid=""><span leaf="">{{content}}</span><mpchecktext></mpchecktext></p></section><section style="display: flex;align-items: center;width: 100%;" data-mid=""><section style="width: 100%;border-top: 1px solid #4499e7;height: 1px;" data-mid=""><span leaf=""><br class="ProseMirror-trailingBreak"></span></section><section style="flex-shrink: 0;width: 6px;height: 6px;background: #4499e7;border-radius: 50%;" data-mid=""><span leaf=""><br class="ProseMirror-trailingBreak"></span></section></section></section></section></section>',h2:'<section data-block="header" data-level="2" style="text-indent: 0px; margin-bottom: 8px;">\n      <h2 style="font-size: 17px; color: rgba(26, 104, 64, 1); font-weight: bold; margin: 1.5em 8px 1em; border-bottom: 1px solid rgba(26, 104, 64, 0.3); padding-bottom: 0.3em;">\n        {{content}}\n      </h2>\n    </section>',h3:'<section data-block="header" data-level="3" style="text-indent: 0px; margin-bottom: 8px;">\n      <h3 style="font-size: 15px; color: rgba(26, 104, 64, 1); font-weight: bold; margin: 1.2em 8px 0.8em;">\n        {{content}}\n      </h3>\n    </section>',h4:'<section data-block="header" data-level="4" style="text-indent: 0px; margin-bottom: 8px;">\n      <h4 style="font-size: 14px; color: rgba(26, 104, 64, 1); font-weight: bold; margin: 1em 8px 0.6em;">\n        {{content}}\n      </h4>\n    </section>',h5:'<section data-block="header" data-level="5" style="text-indent: 0px; margin-bottom: 8px;">\n      <h5 style="font-size: 13px; color: rgba(26, 104, 64, 1); font-weight: bold; margin: 0.8em 8px 0.5em;">\n        {{content}}\n      </h5>\n    </section>',h6:'<section data-block="header" data-level="6" style="text-indent: 0px; margin-bottom: 8px;">\n      <h6 style="font-size: 12px; color: rgba(26, 104, 64, 1); font-weight: bold; margin: 0.6em 8px 0.4em;">\n        {{content}}\n      </h6>\n    </section>'},paragraph:{default:'<section data-block="paragraph" style="text-indent: 0px; margin-bottom: 8px;">\n      <p style="margin: 1.5em 8px; letter-spacing: 0.1em;">\n        {{content}}\n      </p>\n    </section>'},quote:{default:'<section data-block="quote" style="text-indent: 0px; margin-bottom: 8px;">\n      <blockquote style="margin: 1.5em 8px; padding: 1em; border-left: 4px solid rgba(26, 104, 64, 0.5); background-color: rgba(26, 104, 64, 0.05); font-style: italic;">\n        {{content}}\n        {{caption}}\n      </blockquote>\n    </section>'},delimiter:{default:'<section data-block="delimiter" style="text-indent: 0px; margin-bottom: 8px;">\n      <div style="text-align: center; margin: 2em 8px; color: rgba(26, 104, 64, 0.6); font-size: 1.2em;">\n        ***\n      </div>\n    </section>'},list:{ordered:'<section data-block="list" data-style="ordered" style="text-indent: 0px; margin-bottom: 8px;">\n      <ol style="margin: 1.5em 8px; padding-left: 2em;">\n        {{items}}\n      </ol>\n    </section>',unordered:'<section data-block="list" data-style="unordered" style="text-indent: 0px; margin-bottom: 8px;">\n      <ul style="margin: 1.5em 8px; padding-left: 2em;">\n        {{items}}\n      </ul>\n    </section>'},code:{default:'<section data-block="code" style="text-indent: 0px; margin-bottom: 8px;">\n      <pre style="margin: 1.5em 8px; padding: 1em; background-color: rgba(26, 104, 64, 0.08); border-radius: 4px; overflow-x: auto;"><code style="font-family: \'Courier New\', monospace; font-size: 14px;">{{content}}</code></pre>\n    </section>'},listItem:'<li style="margin: 0.3em 0;">{{content}}</li>',fallback:{container:"margin: 1.5em 8px; padding: 0.5em; border: 1px dashed rgba(26, 104, 64, 0.3); background-color: rgba(26, 104, 64, 0.05);",warning:"color: rgba(26, 104, 64, 0.7); font-size: 0.8em;",content:"margin-top: 0.5em;"}};class i{constructor(t={}){this.templates=this.mergeTemplates(o,t)}mergeTemplates(t,e){const n={...t};for(const[o,i]of Object.entries(e))n[o]?n[o]={...n[o],...i}:n[o]=i;return n}parseBlock(t){if(!t||!t.type)return console.warn("æ— æ•ˆçš„å—æ•°æ®:",t),"";const e=t.type,n=t.data||{},o=this.getTemplate(e,n);return o?this.renderTemplate(o,n,e):(console.warn(`æœªæ‰¾åˆ°å—ç±»å‹ ${e} çš„æ¨¡æ¿`),this.createFallbackHtml(t))}getTemplate(t,e){const n=this.templates[t];if(!n)return null;switch(t){case"header":return n[`h${Math.min(Math.max(e.level||1,1),6)}`]||n.default;case"list":return n["ordered"===e.style?"ordered":"unordered"]||n.default;default:return n.default||Object.values(n)[0]}}renderTemplate(t,e,n){let o=t;switch(n){case"header":case"paragraph":const t=this.sanitizeHtml(this.processInlineStyles(e.text||""));o=o.replace(/{{content}}/g,t);break;case"quote":const n=this.sanitizeHtml(this.processInlineStyles(e.text||""));o=o.replace(/{{content}}/g,n);const i=e.caption?`<cite style="${this.templates.inlineStyles.cite}">${this.sanitizeHtml(this.processInlineStyles(e.caption))}</cite>`:"";o=o.replace(/{{caption}}/g,i);break;case"list":const r=(e.items||[]).map((t=>{const e=this.sanitizeHtml(this.processInlineStyles(t));return this.renderListItem(e)})).join("");o=o.replace(/{{items}}/g,r);break;case"code":o=o.replace(/{{content}}/g,this.escapeHtml(e.code||""));break;case"delimiter":break;default:const l=this.sanitizeHtml(this.processInlineStyles(e.text||e.content||""));o=o.replace(/{{content}}/g,l)}return o}renderListItem(t){return this.templates.listItem.replace(/{{content}}/g,t)}createFallbackHtml(t){var e,n,o;const i=(null==(e=t.data)?void 0:e.text)||(null==(n=t.data)?void 0:n.content)||(null==(o=t.data)?void 0:o.code)||"",r="code"===t.type?this.escapeHtml(i):this.sanitizeHtml(this.processInlineStyles(i)),l=this.templates.fallback;return`<section data-block="${t.type}" style="text-indent: 0px; margin-bottom: 8px;">\n      <div style="${l.container}">\n        <small style="${l.warning}">æœªçŸ¥å—ç±»å‹: ${t.type}</small>\n        <div style="${l.content}">${r}</div>\n      </div>\n    </section>`}processInlineStyles(t){if(!t)return"";let e=String(t);const n=this.templates.inlineStyles,o={"<b>":`<strong style="${n.bold}">`,"</b>":"</strong>","<strong>":`<strong style="${n.bold}">`,"<i>":`<em style="${n.italic}">`,"</i>":"</em>","<em>":`<em style="${n.italic}">`,"<u>":`<u style="${n.underline}">`,"<s>":`<s style="${n.strikethrough}">`,"<del>":`<del style="${n.strikethrough}">`,"<code>":`<code style="${n.code}">`,"<mark>":`<mark style="${n.mark}">`,"<small>":`<small style="${n.small}">`,"<sup>":`<sup style="${n.sup}">`,"<sub>":`<sub style="${n.sub}">`};return e=this.processLinkTags(e),Object.entries(o).forEach((([t,n])=>{n.includes("style=")&&e.includes(t)||(e=e.replace(new RegExp(t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g"),n))})),e}processLinkTags(t){const e=this.templates.inlineStyles.link;return t.replace(/<a\s+href=["']([^"']+)["']([^>]*)>/g,((t,n,o)=>{if(o.includes("style="))return t;try{const t=new URL(n);return"mp.weixin.qq.com"===t.hostname?`<a href="${n}" style="${e}"${o}>`:this.handleNonWeixinLink(n,o,e)}catch(i){return`<a href="${n}" style="${e}"${o}>`}}))}handleNonWeixinLink(t,e,n){return`<a href="${t}" style="${n}"${e}>`}sanitizeHtml(t){let e=t;return["script","iframe","object","embed","form"].forEach((t=>{const n=new RegExp(`<${t}[^>]*>.*?</${t}>`,"gi");e=e.replace(n,"")})),e}escapeHtml(t){return t?String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;"):""}parse(t,e={}){const{skipEmpty:n=!0}=e;if(!t||!Array.isArray(t.blocks))return console.warn("æ— æ•ˆçš„EditorJSæ•°æ®"),"";const o=t.blocks.map((t=>this.parseBlock(t))).filter((t=>!n||t.trim())).join("\n");return[this.templates.head||"",o,this.templates.ending||"",'<section><span leaf=""><br class="ProseMirror-trailingBreak"></span></section>'].filter((t=>t.trim())).join("\n")}registerTemplate(t,e,n="default"){this.templates[t]||(this.templates[t]={}),"string"==typeof e?this.templates[t][n]=e:"object"==typeof e&&(this.templates[t]={...this.templates[t],...e})}setTemplate(t,e,n){this.templates[t]||(this.templates[t]={}),this.templates[t][e]=n}renderDocument(t,e={}){const{skipEmpty:n=!0,wrapInContainer:o=!1}=e;if(!t||!Array.isArray(t.blocks))return console.warn("æ— æ•ˆçš„EditorJSæ•°æ®"),"";const i=t.blocks.map((t=>this.parseBlock(t))).filter((t=>!n||t.trim())).join("\n");return o?`<div class="editorjs-content" style="max-width: 800px; margin: 0 auto; padding: 20px;">\n${i}\n</div>`:i}getAvailableTemplates(){return{...this.templates}}setTemplates(t){this.templates={...t}}}function r(t,e={}){const n=document.createElement(t);return e.className&&(n.className=e.className),e.id&&(n.id=e.id),e.innerHTML&&(n.innerHTML=e.innerHTML),e.textContent&&(n.textContent=e.textContent),e.cssText&&(n.style.cssText=e.cssText),n}function l(t,e=document){try{return e.querySelector(t)}catch(n){return console.error(`æŸ¥è¯¢é€‰æ‹©å™¨å¤±è´¥: ${t}`,n),null}}async function s(t,e={}){try{const{targetSelector:o=n.editorContent,append:s=!0,insertPosition:a="cursor",styleOptions:c={}}=e,d=(new i).parse({blocks:t});console.log("ç”Ÿæˆçš„HTMLå†…å®¹:",d);const p=await async function(t,e={}){const{targetSelector:o=n.editorContent,append:i=!0,insertPosition:s="cursor"}=e;try{const e=l(o);if(!e)return console.error("æ‰¾ä¸åˆ°ç›®æ ‡ç¼–è¾‘å™¨:",o),!1;const n=r("div",{innerHTML:t});if(i)for(;n.firstChild;)e.appendChild(n.firstChild);else switch(s){case"start":for(;n.lastChild;)e.insertBefore(n.lastChild,e.firstChild);break;case"end":for(;n.firstChild;)e.appendChild(n.firstChild);break;default:e.innerHTML=t}return console.log("å†…å®¹æ’å…¥æˆåŠŸ"),!0}catch(a){return console.error("æ’å…¥å†…å®¹å¤±è´¥:",a),!1}}(d,{targetSelector:o,append:s,insertPosition:a});return p}catch(o){return console.error("ä¿å­˜åˆ°åŸç¼–è¾‘å™¨å¤±è´¥:",o),!1}}function a(){return!(!window.EditorJSBundle||!window.EditorJSBundle.EditorJS)}function c(t){if(!document.getElementById(t))throw new Error(`${t}å…ƒç´ ä¸å­˜åœ¨ï¼Œè¯·æ£€æŸ¥DOMç»“æ„`);try{const n={holder:t,tools:function(t){const e={};for(const[n,o]of Object.entries(t)){const{class:t,...i}=o;if(!window.EditorJSBundle||!window.EditorJSBundle[t]){console.warn(`å·¥å…·ç±» ${t} æœªæ‰¾åˆ°æˆ–æœªåŠ è½½ï¼Œè·³è¿‡å·¥å…· ${n}`);continue}const r=window.EditorJSBundle[t];r?e[n]={class:r,...i}:console.warn(`å·¥å…·ç±» ${t} æœªåŠ è½½ï¼Œè·³è¿‡å·¥å…· ${n}`)}return e}(e.tools),data:{blocks:[]},placeholder:e.placeholder,autofocus:e.autofocus,hideToolbar:e.hideToolbar,minHeight:e.minHeight,logLevel:e.logLevel,onReady:()=>{new window.EditorJSBundle.DragDrop(o)}},o=new window.EditorJSBundle.EditorJS(n);return o}catch(n){throw console.error("ç¼–è¾‘å™¨åˆå§‹åŒ–å¤±è´¥:",n),n}}async function d(t){if(!a())try{await new Promise(((t,e)=>{chrome.runtime.sendMessage("inject_editorjs_bundle",(n=>{n&&"injected"===n.status?setTimeout((()=>{a()?t():e(new Error("ç¼–è¾‘å™¨è„šæœ¬åŠ è½½å¤±è´¥"))}),100):e(new Error("ç¼–è¾‘å™¨æ³¨å…¥å¤±è´¥"))}))}))}catch(e){throw new Error("ç¼–è¾‘å™¨åŠ è½½å¤±è´¥: "+e.message)}return c(t)}new i;const p=Math.min,u=Math.max,f=Math.round,m=Math.floor,h=t=>({x:t,y:t}),g={left:"right",right:"left",bottom:"top",top:"bottom"},x={start:"end",end:"start"};function y(t,e,n){return u(t,p(e,n))}function w(t,e){return"function"==typeof t?t(e):t}function b(t){return t.split("-")[0]}function v(t){return t.split("-")[1]}function k(t){return"x"===t?"y":"x"}function E(t){return"y"===t?"height":"width"}function C(t){return["top","bottom"].includes(b(t))?"y":"x"}function z(t){return k(C(t))}function F(t){return t.replace(/start|end/g,(t=>x[t]))}function L(t){return t.replace(/left|right|bottom|top/g,(t=>g[t]))}function T(t){const{x:e,y:n,width:o,height:i}=t;return{width:o,height:i,top:n,left:e,right:e+o,bottom:n+i,x:e,y:n}}function $(t,e,n){let{reference:o,floating:i}=t;const r=C(e),l=z(e),s=E(l),a=b(e),c="y"===r,d=o.x+o.width/2-i.width/2,p=o.y+o.height/2-i.height/2,u=o[s]/2-i[s]/2;let f;switch(a){case"top":f={x:d,y:o.y-i.height};break;case"bottom":f={x:d,y:o.y+o.height};break;case"right":f={x:o.x+o.width,y:p};break;case"left":f={x:o.x-i.width,y:p};break;default:f={x:o.x,y:o.y}}switch(v(e)){case"start":f[l]-=u*(n&&c?-1:1);break;case"end":f[l]+=u*(n&&c?-1:1)}return f}async function S(t,e){var n;void 0===e&&(e={});const{x:o,y:i,platform:r,rects:l,elements:s,strategy:a}=t,{boundary:c="clippingAncestors",rootBoundary:d="viewport",elementContext:p="floating",altBoundary:u=!1,padding:f=0}=w(e,t),m=function(t){return"number"!=typeof t?function(t){return{top:0,right:0,bottom:0,left:0,...t}}(t):{top:t,right:t,bottom:t,left:t}}(f),h=s[u?"floating"===p?"reference":"floating":p],g=T(await r.getClippingRect({element:null==(n=await(null==r.isElement?void 0:r.isElement(h)))||n?h:h.contextElement||await(null==r.getDocumentElement?void 0:r.getDocumentElement(s.floating)),boundary:c,rootBoundary:d,strategy:a})),x="floating"===p?{x:o,y:i,width:l.floating.width,height:l.floating.height}:l.reference,y=await(null==r.getOffsetParent?void 0:r.getOffsetParent(s.floating)),b=await(null==r.isElement?void 0:r.isElement(y))&&await(null==r.getScale?void 0:r.getScale(y))||{x:1,y:1},v=T(r.convertOffsetParentRelativeRectToViewportRelativeRect?await r.convertOffsetParentRelativeRectToViewportRelativeRect({elements:s,rect:x,offsetParent:y,strategy:a}):x);return{top:(g.top-v.top+m.top)/b.y,bottom:(v.bottom-g.bottom+m.bottom)/b.y,left:(g.left-v.left+m.left)/b.x,right:(v.right-g.right+m.right)/b.x}}function A(){return"undefined"!=typeof window}function R(t){return I(t)?(t.nodeName||"").toLowerCase():"#document"}function M(t){var e;return(null==t||null==(e=t.ownerDocument)?void 0:e.defaultView)||window}function B(t){var e;return null==(e=(I(t)?t.ownerDocument:t.document)||window.document)?void 0:e.documentElement}function I(t){return!!A()&&(t instanceof Node||t instanceof M(t).Node)}function j(t){return!!A()&&(t instanceof Element||t instanceof M(t).Element)}function H(t){return!!A()&&(t instanceof HTMLElement||t instanceof M(t).HTMLElement)}function P(t){return!(!A()||"undefined"==typeof ShadowRoot)&&(t instanceof ShadowRoot||t instanceof M(t).ShadowRoot)}function O(t){const{overflow:e,overflowX:n,overflowY:o,display:i}=W(t);return/auto|scroll|overlay|hidden|clip/.test(e+o+n)&&!["inline","contents"].includes(i)}function _(t){return["table","td","th"].includes(R(t))}function N(t){return[":popover-open",":modal"].some((e=>{try{return t.matches(e)}catch(n){return!1}}))}function D(t){const e=q(),n=j(t)?W(t):t;return["transform","translate","scale","rotate","perspective"].some((t=>!!n[t]&&"none"!==n[t]))||!!n.containerType&&"normal"!==n.containerType||!e&&!!n.backdropFilter&&"none"!==n.backdropFilter||!e&&!!n.filter&&"none"!==n.filter||["transform","translate","scale","rotate","perspective","filter"].some((t=>(n.willChange||"").includes(t)))||["paint","layout","strict","content"].some((t=>(n.contain||"").includes(t)))}function q(){return!("undefined"==typeof CSS||!CSS.supports)&&CSS.supports("-webkit-backdrop-filter","none")}function V(t){return["html","body","#document"].includes(R(t))}function W(t){return M(t).getComputedStyle(t)}function J(t){return j(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function U(t){if("html"===R(t))return t;const e=t.assignedSlot||t.parentNode||P(t)&&t.host||B(t);return P(e)?e.host:e}function X(t){const e=U(t);return V(e)?t.ownerDocument?t.ownerDocument.body:t.body:H(e)&&O(e)?e:X(e)}function Y(t,e,n){var o;void 0===e&&(e=[]),void 0===n&&(n=!0);const i=X(t),r=i===(null==(o=t.ownerDocument)?void 0:o.body),l=M(i);if(r){const t=Q(l);return e.concat(l,l.visualViewport||[],O(i)?i:[],t&&n?Y(t):[])}return e.concat(i,Y(i,[],n))}function Q(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function Z(t){const e=W(t);let n=parseFloat(e.width)||0,o=parseFloat(e.height)||0;const i=H(t),r=i?t.offsetWidth:n,l=i?t.offsetHeight:o,s=f(n)!==r||f(o)!==l;return s&&(n=r,o=l),{width:n,height:o,$:s}}function G(t){return j(t)?t:t.contextElement}function K(t){const e=G(t);if(!H(e))return h(1);const n=e.getBoundingClientRect(),{width:o,height:i,$:r}=Z(e);let l=(r?f(n.width):n.width)/o,s=(r?f(n.height):n.height)/i;return l&&Number.isFinite(l)||(l=1),s&&Number.isFinite(s)||(s=1),{x:l,y:s}}const tt=h(0);function et(t){const e=M(t);return q()&&e.visualViewport?{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}:tt}function nt(t,e,n,o){void 0===e&&(e=!1),void 0===n&&(n=!1);const i=t.getBoundingClientRect(),r=G(t);let l=h(1);e&&(o?j(o)&&(l=K(o)):l=K(t));const s=function(t,e,n){return void 0===e&&(e=!1),!(!n||e&&n!==M(t))&&e}(r,n,o)?et(r):h(0);let a=(i.left+s.x)/l.x,c=(i.top+s.y)/l.y,d=i.width/l.x,p=i.height/l.y;if(r){const t=M(r),e=o&&j(o)?M(o):o;let n=t,i=Q(n);for(;i&&o&&e!==n;){const t=K(i),e=i.getBoundingClientRect(),o=W(i),r=e.left+(i.clientLeft+parseFloat(o.paddingLeft))*t.x,l=e.top+(i.clientTop+parseFloat(o.paddingTop))*t.y;a*=t.x,c*=t.y,d*=t.x,p*=t.y,a+=r,c+=l,n=M(i),i=Q(n)}}return T({width:d,height:p,x:a,y:c})}function ot(t,e){const n=J(t).scrollLeft;return e?e.left+n:nt(B(t)).left+n}function it(t,e,n){void 0===n&&(n=!1);const o=t.getBoundingClientRect();return{x:o.left+e.scrollLeft-(n?0:ot(t,o)),y:o.top+e.scrollTop}}function rt(t,e,n){let o;if("viewport"===e)o=function(t,e){const n=M(t),o=B(t),i=n.visualViewport;let r=o.clientWidth,l=o.clientHeight,s=0,a=0;if(i){r=i.width,l=i.height;const t=q();(!t||t&&"fixed"===e)&&(s=i.offsetLeft,a=i.offsetTop)}return{width:r,height:l,x:s,y:a}}(t,n);else if("document"===e)o=function(t){const e=B(t),n=J(t),o=t.ownerDocument.body,i=u(e.scrollWidth,e.clientWidth,o.scrollWidth,o.clientWidth),r=u(e.scrollHeight,e.clientHeight,o.scrollHeight,o.clientHeight);let l=-n.scrollLeft+ot(t);const s=-n.scrollTop;return"rtl"===W(o).direction&&(l+=u(e.clientWidth,o.clientWidth)-i),{width:i,height:r,x:l,y:s}}(B(t));else if(j(e))o=function(t,e){const n=nt(t,!0,"fixed"===e),o=n.top+t.clientTop,i=n.left+t.clientLeft,r=H(t)?K(t):h(1);return{width:t.clientWidth*r.x,height:t.clientHeight*r.y,x:i*r.x,y:o*r.y}}(e,n);else{const n=et(t);o={x:e.x-n.x,y:e.y-n.y,width:e.width,height:e.height}}return T(o)}function lt(t,e){const n=U(t);return!(n===e||!j(n)||V(n))&&("fixed"===W(n).position||lt(n,e))}function st(t,e,n){const o=H(e),i=B(e),r="fixed"===n,l=nt(t,!0,r,e);let s={scrollLeft:0,scrollTop:0};const a=h(0);function c(){a.x=ot(i)}if(o||!o&&!r)if(("body"!==R(e)||O(i))&&(s=J(e)),o){const t=nt(e,!0,r,e);a.x=t.x+e.clientLeft,a.y=t.y+e.clientTop}else i&&c();r&&!o&&i&&c();const d=!i||o||r?h(0):it(i,s);return{x:l.left+s.scrollLeft-a.x-d.x,y:l.top+s.scrollTop-a.y-d.y,width:l.width,height:l.height}}function at(t){return"static"===W(t).position}function ct(t,e){if(!H(t)||"fixed"===W(t).position)return null;if(e)return e(t);let n=t.offsetParent;return B(t)===n&&(n=n.ownerDocument.body),n}function dt(t,e){const n=M(t);if(N(t))return n;if(!H(t)){let e=U(t);for(;e&&!V(e);){if(j(e)&&!at(e))return e;e=U(e)}return n}let o=ct(t,e);for(;o&&_(o)&&at(o);)o=ct(o,e);return o&&V(o)&&at(o)&&!D(o)?n:o||function(t){let e=U(t);for(;H(e)&&!V(e);){if(D(e))return e;if(N(e))return null;e=U(e)}return null}(t)||n}const pt={convertOffsetParentRelativeRectToViewportRelativeRect:function(t){let{elements:e,rect:n,offsetParent:o,strategy:i}=t;const r="fixed"===i,l=B(o),s=!!e&&N(e.floating);if(o===l||s&&r)return n;let a={scrollLeft:0,scrollTop:0},c=h(1);const d=h(0),p=H(o);if((p||!p&&!r)&&(("body"!==R(o)||O(l))&&(a=J(o)),H(o))){const t=nt(o);c=K(o),d.x=t.x+o.clientLeft,d.y=t.y+o.clientTop}const u=!l||p||r?h(0):it(l,a,!0);return{width:n.width*c.x,height:n.height*c.y,x:n.x*c.x-a.scrollLeft*c.x+d.x+u.x,y:n.y*c.y-a.scrollTop*c.y+d.y+u.y}},getDocumentElement:B,getClippingRect:function(t){let{element:e,boundary:n,rootBoundary:o,strategy:i}=t;const r=[..."clippingAncestors"===n?N(e)?[]:function(t,e){const n=e.get(t);if(n)return n;let o=Y(t,[],!1).filter((t=>j(t)&&"body"!==R(t))),i=null;const r="fixed"===W(t).position;let l=r?U(t):t;for(;j(l)&&!V(l);){const e=W(l),n=D(l);n||"fixed"!==e.position||(i=null),(r?!n&&!i:!n&&"static"===e.position&&i&&["absolute","fixed"].includes(i.position)||O(l)&&!n&&lt(t,l))?o=o.filter((t=>t!==l)):i=e,l=U(l)}return e.set(t,o),o}(e,this._c):[].concat(n),o],l=r[0],s=r.reduce(((t,n)=>{const o=rt(e,n,i);return t.top=u(o.top,t.top),t.right=p(o.right,t.right),t.bottom=p(o.bottom,t.bottom),t.left=u(o.left,t.left),t}),rt(e,l,i));return{width:s.right-s.left,height:s.bottom-s.top,x:s.left,y:s.top}},getOffsetParent:dt,getElementRects:async function(t){const e=this.getOffsetParent||dt,n=this.getDimensions,o=await n(t.floating);return{reference:st(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:o.width,height:o.height}}},getClientRects:function(t){return Array.from(t.getClientRects())},getDimensions:function(t){const{width:e,height:n}=Z(t);return{width:e,height:n}},getScale:K,isElement:j,isRTL:function(t){return"rtl"===W(t).direction}};function ut(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}function ft(t,e,n,o){void 0===o&&(o={});const{ancestorScroll:i=!0,ancestorResize:r=!0,elementResize:l="function"==typeof ResizeObserver,layoutShift:s="function"==typeof IntersectionObserver,animationFrame:a=!1}=o,c=G(t),d=i||r?[...c?Y(c):[],...Y(e)]:[];d.forEach((t=>{i&&t.addEventListener("scroll",n,{passive:!0}),r&&t.addEventListener("resize",n)}));const f=c&&s?function(t,e){let n,o=null;const i=B(t);function r(){var t;clearTimeout(n),null==(t=o)||t.disconnect(),o=null}return function l(s,a){void 0===s&&(s=!1),void 0===a&&(a=1),r();const c=t.getBoundingClientRect(),{left:d,top:f,width:h,height:g}=c;if(s||e(),!h||!g)return;const x={rootMargin:-m(f)+"px "+-m(i.clientWidth-(d+h))+"px "+-m(i.clientHeight-(f+g))+"px "+-m(d)+"px",threshold:u(0,p(1,a))||1};let y=!0;function w(e){const o=e[0].intersectionRatio;if(o!==a){if(!y)return l();o?l(!1,o):n=setTimeout((()=>{l(!1,1e-7)}),1e3)}1!==o||ut(c,t.getBoundingClientRect())||l(),y=!1}try{o=new IntersectionObserver(w,{...x,root:i.ownerDocument})}catch(b){o=new IntersectionObserver(w,x)}o.observe(t)}(!0),r}(c,n):null;let h,g=-1,x=null;l&&(x=new ResizeObserver((t=>{let[o]=t;o&&o.target===c&&x&&(x.unobserve(e),cancelAnimationFrame(g),g=requestAnimationFrame((()=>{var t;null==(t=x)||t.observe(e)}))),n()})),c&&!a&&x.observe(c),x.observe(e));let y=a?nt(t):null;return a&&function e(){const o=nt(t);y&&!ut(y,o)&&n();y=o,h=requestAnimationFrame(e)}(),n(),()=>{var t;d.forEach((t=>{i&&t.removeEventListener("scroll",n),r&&t.removeEventListener("resize",n)})),null==f||f(),null==(t=x)||t.disconnect(),x=null,a&&cancelAnimationFrame(h)}}const mt=function(t){return void 0===t&&(t=0),{name:"offset",options:t,async fn(e){var n,o;const{x:i,y:r,placement:l,middlewareData:s}=e,a=await async function(t,e){const{placement:n,platform:o,elements:i}=t,r=await(null==o.isRTL?void 0:o.isRTL(i.floating)),l=b(n),s=v(n),a="y"===C(n),c=["left","top"].includes(l)?-1:1,d=r&&a?-1:1,p=w(e,t);let{mainAxis:u,crossAxis:f,alignmentAxis:m}="number"==typeof p?{mainAxis:p,crossAxis:0,alignmentAxis:null}:{mainAxis:p.mainAxis||0,crossAxis:p.crossAxis||0,alignmentAxis:p.alignmentAxis};return s&&"number"==typeof m&&(f="end"===s?-1*m:m),a?{x:f*d,y:u*c}:{x:u*c,y:f*d}}(e,t);return l===(null==(n=s.offset)?void 0:n.placement)&&null!=(o=s.arrow)&&o.alignmentOffset?{}:{x:i+a.x,y:r+a.y,data:{...a,placement:l}}}}},ht=function(t){return void 0===t&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:o,placement:i}=e,{mainAxis:r=!0,crossAxis:l=!1,limiter:s={fn:t=>{let{x:e,y:n}=t;return{x:e,y:n}}},...a}=w(t,e),c={x:n,y:o},d=await S(e,a),p=C(b(i)),u=k(p);let f=c[u],m=c[p];if(r){const t="y"===u?"bottom":"right";f=y(f+d["y"===u?"top":"left"],f,f-d[t])}if(l){const t="y"===p?"bottom":"right";m=y(m+d["y"===p?"top":"left"],m,m-d[t])}const h=s.fn({...e,[u]:f,[p]:m});return{...h,data:{x:h.x-n,y:h.y-o,enabled:{[u]:r,[p]:l}}}}}},gt=function(t){return void 0===t&&(t={}),{name:"flip",options:t,async fn(e){var n,o;const{placement:i,middlewareData:r,rects:l,initialPlacement:s,platform:a,elements:c}=e,{mainAxis:d=!0,crossAxis:p=!0,fallbackPlacements:u,fallbackStrategy:f="bestFit",fallbackAxisSideDirection:m="none",flipAlignment:h=!0,...g}=w(t,e);if(null!=(n=r.arrow)&&n.alignmentOffset)return{};const x=b(i),y=C(s),k=b(s)===s,T=await(null==a.isRTL?void 0:a.isRTL(c.floating)),$=u||(k||!h?[L(s)]:function(t){const e=L(t);return[F(t),e,F(e)]}(s)),A="none"!==m;!u&&A&&$.push(...function(t,e,n,o){const i=v(t);let r=function(t,e,n){const o=["left","right"],i=["right","left"],r=["top","bottom"],l=["bottom","top"];switch(t){case"top":case"bottom":return n?e?i:o:e?o:i;case"left":case"right":return e?r:l;default:return[]}}(b(t),"start"===n,o);return i&&(r=r.map((t=>t+"-"+i)),e&&(r=r.concat(r.map(F)))),r}(s,h,m,T));const R=[s,...$],M=await S(e,g),B=[];let I=(null==(o=r.flip)?void 0:o.overflows)||[];if(d&&B.push(M[x]),p){const t=function(t,e,n){void 0===n&&(n=!1);const o=v(t),i=z(t),r=E(i);let l="x"===i?o===(n?"end":"start")?"right":"left":"start"===o?"bottom":"top";return e.reference[r]>e.floating[r]&&(l=L(l)),[l,L(l)]}(i,l,T);B.push(M[t[0]],M[t[1]])}if(I=[...I,{placement:i,overflows:B}],!B.every((t=>t<=0))){var j,H;const t=((null==(j=r.flip)?void 0:j.index)||0)+1,e=R[t];if(e){if(!("alignment"===p&&y!==C(e))||I.every((t=>t.overflows[0]>0&&C(t.placement)===y)))return{data:{index:t,overflows:I},reset:{placement:e}}}let n=null==(H=I.filter((t=>t.overflows[0]<=0)).sort(((t,e)=>t.overflows[1]-e.overflows[1]))[0])?void 0:H.placement;if(!n)switch(f){case"bestFit":{var P;const t=null==(P=I.filter((t=>{if(A){const e=C(t.placement);return e===y||"y"===e}return!0})).map((t=>[t.placement,t.overflows.filter((t=>t>0)).reduce(((t,e)=>t+e),0)])).sort(((t,e)=>t[1]-e[1]))[0])?void 0:P[0];t&&(n=t);break}case"initialPlacement":n=s}if(i!==n)return{reset:{placement:n}}}return{}}}},xt=(t,e,n)=>{const o=new Map,i={platform:pt,...n},r={...i.platform,_c:o};return(async(t,e,n)=>{const{placement:o="bottom",strategy:i="absolute",middleware:r=[],platform:l}=n,s=r.filter(Boolean),a=await(null==l.isRTL?void 0:l.isRTL(e));let c=await l.getElementRects({reference:t,floating:e,strategy:i}),{x:d,y:p}=$(c,o,a),u=o,f={},m=0;for(let h=0;h<s.length;h++){const{name:n,fn:r}=s[h],{x:g,y:x,data:y,reset:w}=await r({x:d,y:p,initialPlacement:o,placement:u,strategy:i,middlewareData:f,rects:c,platform:l,elements:{reference:t,floating:e}});d=null!=g?g:d,p=null!=x?x:p,f={...f,[n]:{...f[n],...y}},w&&m<=50&&(m++,"object"==typeof w&&(w.placement&&(u=w.placement),w.rects&&(c=!0===w.rects?await l.getElementRects({reference:t,floating:e,strategy:i}):w.rects),({x:d,y:p}=$(c,u,a))),h=-1)}return{x:d,y:p,placement:u,strategy:i,middlewareData:f}})(t,e,{...i,platform:r})};let yt=null;let wt=null;async function bt(){try{await async function(){if(vt)return void console.debug("æ™ºèƒ½ç¼–è¾‘å™¨å·²ç»æ¿€æ´»");if(!l(n.editorContent))return void alert("æ‰¾ä¸åˆ°ç¼–è¾‘å™¨å®¹å™¨");try{!function(){const t=r("div",{id:"smart-editor-container",className:"flowedit-editor-container"}),e=l(n.editorContent);if(!e)throw console.error("æ— æ³•æ‰¾åˆ°åˆé€‚çš„å‚è€ƒå…ƒç´ æ¥å®šä½æ™ºèƒ½ç¼–è¾‘å™¨ï¼Œè¯·æ£€æŸ¥é¡µé¢ç»“æ„"),new Error("æ— æ³•æ‰¾åˆ°åˆé€‚çš„å‚è€ƒå…ƒç´ æ¥å®šä½æ™ºèƒ½ç¼–è¾‘å™¨");const o=l(n.editorWrapper);o?o.appendChild(t):document.body.appendChild(t);const i=async()=>{const{x:n,y:o}=await xt(e,t,{strategy:"fixed",middleware:[{name:"cover",fn:({rects:t})=>({x:t.reference.x,y:t.reference.y})},{name:"size",fn:({rects:t})=>({data:{width:t.reference.width,height:t.reference.height}})}]});Object.assign(t.style,{position:"fixed",left:n-50+"px",top:`${o}px`,width:`${e.offsetWidth+140}px`,height:`${e.offsetHeight}px`}),console.log("æ™ºèƒ½ç¼–è¾‘å™¨å®šä½æ¨¡å¼: å®Œå…¨è¦†ç›– (Floating UI)")};i(),yt=ft(e,t,i);const s=r("div",{id:"editor-holder",className:"flowedit-editor-holder"});t.appendChild(s),console.log("æ™ºèƒ½ç¼–è¾‘å™¨ç•Œé¢åˆ›å»ºå®Œæˆï¼Œä½¿ç”¨ Floating UI å®šä½")}(),kt=function(t={}){const{onSave:e,onCancel:o}=t,i=r("div",{className:"flowedit-editor-action-bar"}),s=r("button",{textContent:"ğŸ’¾ ä¿å­˜",className:"flowedit-editor-save-btn"}),a=r("button",{textContent:"â†©ï¸ å–æ¶ˆ",className:"flowedit-editor-cancel-btn"});i.appendChild(s),i.appendChild(a);const c=l(n.botBar)||l(n.buttonArea)||document.getElementById("smart-editor-container");if(c){document.body.appendChild(i);const t=()=>{xt(c,i,{placement:"top-start",middleware:[mt(0),gt(),ht({padding:10})]}).then((({x:t,y:e})=>{const n=c.getBoundingClientRect();Object.assign(i.style,{left:`${t}px`,top:`${e}px`,width:`${n.width}px`,height:`${n.height}px`})}))};t(),wt=ft(c,i,t)}else console.warn("æ‰¾ä¸åˆ°å‚è€ƒå…ƒç´ ï¼Œå°†æ§åˆ¶æ æ·»åŠ åˆ°bodyå¹¶ä½¿ç”¨é»˜è®¤å®šä½"),document.body.appendChild(i);return e&&"function"==typeof e&&s.addEventListener("click",e),o&&"function"==typeof o&&a.addEventListener("click",o),console.log("æ™ºèƒ½ç¼–è¾‘å™¨æ§åˆ¶æ åˆ›å»ºå®Œæˆï¼Œä½¿ç”¨ Floating UI å®šä½"),i}({onSave:Ft,onCancel:zt}),await new Promise((t=>setTimeout(t,50))),vt=await d("editor-holder"),console.log("æ™ºèƒ½ç¼–è¾‘å™¨æ¿€æ´»æˆåŠŸ")}catch(t){console.error("æ™ºèƒ½æ’å…¥åŠŸèƒ½å¯åŠ¨å¤±è´¥:",t),alert("æ™ºèƒ½æ’å…¥åŠŸèƒ½å¯åŠ¨å¤±è´¥"),zt()}}()}catch(t){console.error("æ™ºèƒ½æ’å…¥æŒ‰é’®ç‚¹å‡»å¤„ç†å¤±è´¥:",t)}}let vt=null,kt=null,Et=null;function Ct(t){if(Et)console.warn("æ™ºèƒ½ç¼–è¾‘å™¨åŠŸèƒ½å·²ç»åˆå§‹åŒ–");else try{Et=function(t){const e=r("button",{className:"flowedit-btn flowedit-smart-btn",textContent:"æ™ºèƒ½æ’å…¥"});Object.assign(e.style,{position:"fixed",zIndex:"100"}),e.addEventListener("click",bt),document.body.appendChild(e);const n=document.querySelector("#js_toolbar_0"),o=n?n.lastElementChild:t;return o&&xt(o,e,{placement:"right-start",middleware:[mt(o.offsetWidth),gt(),ht({padding:8})]}).then((({x:t,y:n})=>{Object.assign(e.style,{left:`${t}px`,top:`${n}px`})})),{element:e,cleanup:()=>{e.parentNode&&e.parentNode.removeChild(e)}}}(t),console.log("æ™ºèƒ½ç¼–è¾‘å™¨åŠŸèƒ½åˆå§‹åŒ–æˆåŠŸ")}catch(e){console.error("æ™ºèƒ½ç¼–è¾‘å™¨åŠŸèƒ½åˆå§‹åŒ–å¤±è´¥:",e)}}function zt(){var t;!function(){yt&&(yt(),yt=null);const t=document.getElementById("smart-editor-container");t&&(t.remove(),console.log("æ™ºèƒ½ç¼–è¾‘å™¨ç•Œé¢å·²ç§»é™¤"))}(),kt&&(t=kt,wt&&(wt(),wt=null),t&&(t.remove(),console.log("æ™ºèƒ½ç¼–è¾‘å™¨æ§åˆ¶æ å·²ç§»é™¤")),kt=null),vt&&(!function(t){if(t)try{t.destroy()}catch(e){console.warn("ç¼–è¾‘å™¨é”€æ¯é”™è¯¯:",e)}}(vt),vt=null),console.log("æ™ºèƒ½ç¼–è¾‘å™¨å·²åœç”¨")}async function Ft(t={}){if(vt)try{const e=await vt.save();console.log("ä¿å­˜çš„æ•°æ®:",e);await s(e.blocks,{...t})?console.log("å†…å®¹å·²æˆåŠŸä¿å­˜åˆ°åŸç¼–è¾‘å™¨"):console.error("ä¿å­˜åˆ°åŸç¼–è¾‘å™¨å¤±è´¥")}catch(e){console.error("ä¿å­˜å¤±è´¥:",e)}finally{zt()}else console.error("ç¼–è¾‘å™¨æœªåˆå§‹åŒ–")}const Lt={name:"smart-editor",initialize:async t=>{Ct(t)},cleanup:()=>{zt(),Et&&Et.cleanup&&(Et.cleanup(),Et=null,console.log("æ™ºèƒ½ç¼–è¾‘å™¨åŠŸèƒ½å·²æ¸…ç†"))},isEnabled:()=>!0,isActive:()=>null!==vt};function Tt(t){const e=document.querySelector(n.sidebar);if(e){const n="none"===e.style.display;if(e.style.display=n?"":"none",t&&t.currentTarget){const e=t.currentTarget;n?e.classList.add("on"):e.classList.remove("on")}}}let $t=null;function St(t){if($t)console.warn("ä¾§è¾¹æ åŠŸèƒ½å·²ç»åˆå§‹åŒ–");else try{$t=function(t){const e=r("button",{className:"flowedit-switch",innerHTML:'\n      <div class="flowedit-switch-track"></div>\n      <div class="flowedit-switch-thumb"></div>\n    '});Object.assign(e.style,{position:"fixed",zIndex:"100"}),e.addEventListener("click",Tt),document.body.appendChild(e);const n=document.querySelector("#js_toolbar_0"),o=n?n.firstElementChild:t;return o&&xt(o,e,{placement:"left-start",middleware:[mt(-o.offsetWidth),gt(),ht({padding:8})]}).then((({x:t,y:n})=>{Object.assign(e.style,{left:`${t}px`,top:`${n}px`})})),{element:e,cleanup:()=>{e.parentNode&&e.parentNode.removeChild(e)}}}(t),console.log("ä¾§è¾¹æ åŠŸèƒ½åˆå§‹åŒ–æˆåŠŸ")}catch(e){console.error("ä¾§è¾¹æ åŠŸèƒ½åˆå§‹åŒ–å¤±è´¥:",e)}}const At={name:"sidebar",initialize:async t=>{St(t)},cleanup:()=>{$t&&$t.cleanup&&($t.cleanup(),$t=null,console.log("ä¾§è¾¹æ åŠŸèƒ½å·²æ¸…ç†"))},isEnabled:()=>!0,isActive:()=>null!==$t};const Rt=new class{constructor(){this.config={},this.initialized=!1}async initialize(){try{console.log("åˆå§‹åŒ–ç”¨æˆ·é…ç½®ç®¡ç†å™¨..."),this.initialized=!0,console.log("ç”¨æˆ·é…ç½®ç®¡ç†å™¨åˆå§‹åŒ–å®Œæˆ")}catch(t){throw console.error("ç”¨æˆ·é…ç½®ç®¡ç†å™¨åˆå§‹åŒ–å¤±è´¥:",t),t}}getUserConfig(t){return this.initialized?t?this.config[t]:this.config:(console.warn("ç”¨æˆ·é…ç½®ç®¡ç†å™¨æœªåˆå§‹åŒ–"),null)}async setUserConfig(t,e){try{return this.initialized?("object"==typeof t?this.config={...this.config,...t}:this.config[t]=e,console.log("ç”¨æˆ·é…ç½®å·²æ›´æ–°:",t),!0):(console.warn("ç”¨æˆ·é…ç½®ç®¡ç†å™¨æœªåˆå§‹åŒ–"),!1)}catch(n){return console.error("è®¾ç½®ç”¨æˆ·é…ç½®å¤±è´¥:",n),!1}}},Mt=new class{constructor(){this.initialized=!1,this.styleCache={},this.syncInterval=null}async initialize(){try{console.log("åˆå§‹åŒ–è¿œç¨‹æ ·å¼åŒæ­¥æœåŠ¡..."),this.initialized=!0,console.log("è¿œç¨‹æ ·å¼åŒæ­¥æœåŠ¡åˆå§‹åŒ–å®Œæˆ")}catch(t){throw console.error("è¿œç¨‹æ ·å¼åŒæ­¥æœåŠ¡åˆå§‹åŒ–å¤±è´¥:",t),t}}async manualSync(){try{return this.initialized?(console.log("å¼€å§‹æ‰‹åŠ¨åŒæ­¥è¿œç¨‹æ ·å¼..."),console.log("è¿œç¨‹æ ·å¼åŒæ­¥å®Œæˆ"),!0):(console.warn("è¿œç¨‹æ ·å¼åŒæ­¥æœåŠ¡æœªåˆå§‹åŒ–"),!1)}catch(t){return console.error("è¿œç¨‹æ ·å¼åŒæ­¥å¤±è´¥:",t),!1}}startAutoSync(t=3e4){this.syncInterval&&clearInterval(this.syncInterval),this.syncInterval=setInterval((async()=>{await this.manualSync()}),t),console.log(`è¿œç¨‹æ ·å¼è‡ªåŠ¨åŒæ­¥å·²å¯åŠ¨ï¼Œé—´éš”: ${t}ms`)}stopAutoSync(){this.syncInterval&&(clearInterval(this.syncInterval),this.syncInterval=null,console.log("è¿œç¨‹æ ·å¼è‡ªåŠ¨åŒæ­¥å·²åœæ­¢"))}};async function Bt(t={}){try{return console.log("å¼€å§‹åˆå§‹åŒ–FlowEditåº”ç”¨æœåŠ¡..."),await Rt.initialize(),await async function(t={}){try{if(await Mt.initialize(),!1!==t.enableAutoSync){const e=t.syncInterval||3e4;Mt.startAutoSync(e)}!1!==t.initialSync&&await Mt.manualSync(),console.log("è¿œç¨‹æ ·å¼ç³»ç»Ÿåˆå§‹åŒ–å®Œæˆ")}catch(e){console.error("è¿œç¨‹æ ·å¼ç³»ç»Ÿåˆå§‹åŒ–å¤±è´¥:",e)}}(t),console.log("FlowEditåº”ç”¨æœåŠ¡åˆå§‹åŒ–å®Œæˆ"),!0}catch(e){return console.error("FlowEditåº”ç”¨æœåŠ¡åˆå§‹åŒ–å¤±è´¥:",e),!1}}async function It(){const e=document.querySelector("#js_toolbar_0");if(!e)return void console.log("FlowEdit æ’ä»¶åŠŸèƒ½æ¨¡å—åˆå§‹åŒ–å¤±è´¥ï¼šé¡µé¢å¯èƒ½æœªç™»å½•");!function(){const t="flow-editor-plugin-styles";if(!document.getElementById(t)){const e=document.createElement("style");e.id=t,e.setAttribute("data-flowedit-plugin-ui","true"),e.textContent="\n      /* FlowEdit æ’ä»¶UIæ ·å¼ */\n      \n  /* æ‰©å±•æŒ‰é’®åŸºç¡€æ ·å¼ */\n  .flowedit-btn {\n    display: inline-block;\n    height: 22px;\n    cursor: pointer;\n    border: none;\n    outline: none;\n    box-sizing: border-box;\n  }\n  \n  /* æ™ºèƒ½æ’å…¥æŒ‰é’®æ ·å¼ */\n  .flowedit-smart-btn {\n    background-color: #07c160;\n    color: white;\n    border-radius: 4px;\n    padding: 0 12px;\n    font-size: 12px;\n    line-height: 22px;\n    transition: all 0.3s ease;\n  }\n  \n  /* æ™ºèƒ½æ’å…¥æŒ‰é’®æ‚¬æµ®æ•ˆæœ */\n  .flowedit-smart-btn:hover {\n    background-color: #07c160;\n    background-image: linear-gradient(to bottom, #07C160 0, #07C160 100%);\n    border-color: #07C160;\n    color: #FFFFFF;\n    transform: translateY(-1px);\n    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n  }\n\n      \n  /* Switchå¼€å…³æ ·å¼ */\n  .flowedit-switch {\n    display: inline-block;\n    height: 22px;\n    cursor: pointer;\n    position: relative;\n    width: 40px;\n    border: none;\n    outline: none;\n    box-sizing: border-box;\n  }\n  \n  .flowedit-switch-track {\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    background-color: #ccc;\n    border-radius: 11px;\n    transition: all 0.3s ease;\n  }\n  \n  .flowedit-switch-thumb {\n    position: absolute;\n    width: 18px;\n    height: 18px;\n    left: 2px;\n    bottom: 2px;\n    background-color: white;\n    border-radius: 50%;\n    transition: transform 0.3s ease;\n  }\n  \n  .flowedit-switch.on .flowedit-switch-track {\n    background-color: #07c160;\n  }\n  \n  .flowedit-switch.on .flowedit-switch-thumb {\n    transform: translateX(18px);\n  }\n\n      \n  /* æ™ºèƒ½æ’å…¥ç¼–è¾‘å™¨å®¹å™¨æ ·å¼ */\n  .flowedit-editor-container {\n    position: fixed; /* ç»Ÿä¸€ä½¿ç”¨ fixed */\n    background: #fff;\n    border-radius: 4px;\n    box-sizing: border-box;\n    z-index: 100;\n    overflow: hidden;\n    padding: 0 0 0 40px;\n  }\n  \n  /* æ™ºèƒ½æ’å…¥ç¼–è¾‘å™¨å ä½å…ƒç´ æ ·å¼ */\n  .flowedit-editor-holder {\n    padding: 0;\n  }\n  \n  /* æ™ºèƒ½æ’å…¥æ§åˆ¶æ æ ·å¼ */\n  .flowedit-editor-action-bar {\n    padding: 10px 15px;\n    background-color: #ffffff;\n    display: flex;\n    justify-content: flex-end;\n    gap: 15px;\n  }\n  \n  /* æ™ºèƒ½æ’å…¥ä¿å­˜æŒ‰é’®æ ·å¼ */\n  .flowedit-editor-save-btn {\n    padding: 4px 12px;\n    height: 34px;\n    width: 98px;\n    display: inline-block;\n    background: #07c160;\n    color: white;\n    border: none;\n    border-radius: 4px;\n    cursor: pointer;\n    font-size: 14px;\n    transition: all 0.3s ease;\n  }\n  \n  /* æ™ºèƒ½æ’å…¥ä¿å­˜æŒ‰é’®æ‚¬æµ®æ•ˆæœ */\n  .flowedit-editor-save-btn:hover {\n    background-color: #07c160;\n    background-image: linear-gradient(to bottom, #07C160 0, #07C160 100%);\n    border-color: #07C160;\n    color: #FFFFFF;\n    transform: translateY(-1px);\n    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n  }\n  \n  /* æ™ºèƒ½æ’å…¥å–æ¶ˆæŒ‰é’®æ ·å¼ */\n  .flowedit-editor-cancel-btn {\n    padding: 4px 12px;\n    height: 34px;\n    width: 98px;\n    display: inline-block;\n    background: #999999;\n    color: white;\n    border: none;\n    border-radius: 4px;\n    cursor: pointer;\n    font-size: 14px;\n    transition: all 0.3s ease;\n  }\n  \n  /* æ™ºèƒ½æ’å…¥å–æ¶ˆæŒ‰é’®æ‚¬æµ®æ•ˆæœ */\n  .flowedit-editor-cancel-btn:hover {\n    background-color: #e7e7eb;\n    background-image: linear-gradient(to bottom, #E7E7EB 0, #E7E7EB 100%);\n    border-color: #DADBE0;\n    box-shadow: none;\n    -moz-box-shadow: none;\n    -webkit-box-shadow: none;\n    color: #353535;\n    transform: translateY(-1px);\n  }\n\n    ",document.head.appendChild(e),console.log("FlowEdit æ’ä»¶UIæ ·å¼å·²æ³¨å…¥")}}();const n=await t.initializeAll(e);n.success.length>0&&console.log(`æˆåŠŸåˆå§‹åŒ–åŠŸèƒ½æ¨¡å—: ${n.success.join(", ")}`),n.failed.length>0&&console.warn(`åˆå§‹åŒ–å¤±è´¥çš„åŠŸèƒ½æ¨¡å—: ${n.failed.join(", ")}`),console.log("FlowEdit æ’ä»¶åŠŸèƒ½æ¨¡å—åˆå§‹åŒ–å®Œæˆ")}t.register("smart-editor",Lt),t.register("sidebar",At),async function(){console.log("FlowEdit å†…å®¹è„šæœ¬å¯åŠ¨"),"loading"===document.readyState&&await new Promise((t=>{document.addEventListener("DOMContentLoaded",t)}));try{await Bt(),console.log("FlowEdit åº”ç”¨æœåŠ¡åˆå§‹åŒ–æˆåŠŸ")}catch(t){console.error("FlowEdit åº”ç”¨æœåŠ¡åˆå§‹åŒ–å¤±è´¥:",t)}await It()}().catch((t=>{console.error("FlowEdit å¯åŠ¨å¤±è´¥:",t)}))}();
