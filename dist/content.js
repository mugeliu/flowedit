!function(){"use strict";const e={enabled:!0,position:"last",editor:{placeholder:"在此输入内容...",tools:{header:{levels:[2,3,4],defaultLevel:2,placeholder:"请输入标题"}}}},t={toolbar:"#js_toolbar_0",editor:'div[contenteditable="true"].ProseMirror',proseMirror:"#ueditor_0 .ProseMirror",buttonArea:"#js_button_area",sidebar:"#js_side_article_list"};function n(e,t={}){const n=document.createElement(e);return t.className&&(n.className=t.className),t.id&&(n.id=t.id),t.innerHTML&&(n.innerHTML=t.innerHTML),t.textContent&&(n.textContent=t.textContent),t.cssText&&(n.style.cssText=t.cssText),n}function o(e,t=document){try{return t.querySelector(e)}catch(n){return console.error(`查询选择器失败: ${e}`,n),null}}const s={enableRemoteStyles:!1,remoteStyleUrl:null,cacheExpiry:864e5,autoInjectStyles:!0,wrapperClassName:"flow-editor-content",skipEmptyBlocks:!0,theme:"default",contentStyleId:"flowedit-content-styles",blockStyles:{paragraph:{className:"flow-paragraph",styles:{margin:"0 0 16px 0","line-height":"1.6",color:"#333"}},header:{className:"flow-header",styles:{margin:"24px 0 16px 0","font-weight":"bold",color:"#222"},levelStyles:{1:{"font-size":"2em"},2:{"font-size":"1.5em"},3:{"font-size":"1.25em"},4:{"font-size":"1.1em"},5:{"font-size":"1em"},6:{"font-size":"0.9em"}}},list:{className:"flow-list",styles:{margin:"0 0 16px 0","padding-left":"20px"}},quote:{className:"flow-quote",styles:{margin:"16px 0",padding:"16px","border-left":"4px solid #ddd","background-color":"#f9f9f9","font-style":"italic"}},code:{className:"flow-code",styles:{margin:"16px 0",padding:"16px","background-color":"#f5f5f5","border-radius":"4px","font-family":'Monaco, Consolas, "Courier New", monospace',"font-size":"14px","overflow-x":"auto"}}}},r={default:{name:"Default",description:"默认主题，平衡的设计风格",blockStyles:{paragraph:{styles:{color:"#333","line-height":"1.6"}},header:{styles:{color:"#222","font-weight":"bold"}},quote:{styles:{"border-left":"4px solid #007bff","background-color":"#f8f9fa"}}}},minimal:{name:"Minimal",description:"极简主题，简洁的设计风格",blockStyles:{paragraph:{styles:{color:"#000","line-height":"1.5"}},header:{styles:{color:"#000","font-weight":"600"}},quote:{styles:{"border-left":"2px solid #000","background-color":"#fff"}}}},modern:{name:"Modern",description:"现代主题，时尚的设计风格",blockStyles:{paragraph:{styles:{color:"#1a1a1a","line-height":"1.7"}},header:{styles:{color:"#1a1a1a","font-weight":"700"}},quote:{styles:{"border-left":"4px solid #6366f1","background-color":"#f8fafc"}}}}},i={enabled:!0,prefix:"flow_styles_",expiry:864e5},l={requiredBlockTypes:["paragraph","header"],forbiddenCssProperties:["javascript","expression","behavior","binding","import","include","moz-binding"],maxCssValueLength:200};const a=new class{constructor(){this.config={...s}}get(e){return e?this.config[e]:this.config}set(e,t){"object"==typeof e?this.config={...this.config,...e}:this.config[e]=t}reset(){this.config={...s}}applyTheme(e){const t=r[e];t&&(this.config.theme=e,Object.keys(t.blockStyles).forEach((e=>{this.config.blockStyles[e]&&(this.config.blockStyles[e].styles={...this.config.blockStyles[e].styles,...t.blockStyles[e].styles})})))}getCurrentTheme(){return r[this.config.theme]||r.default}getBlockStyles(e,t=null){const n=this.config.blockStyles[e];if(!n)return{};let o={...n.styles};return"header"===e&&t&&n.levelStyles&&n.levelStyles[t]&&(o={...o,...n.levelStyles[t]}),o}getBlockClassName(e){const t=this.config.blockStyles[e];return t?t.className:""}validate(){return"object"==typeof this.config&&null!==this.config&&"object"==typeof this.config.blockStyles}};const c=new class{constructor(){this.isInitialized=!1,this.syncTimer=null,this.lastSyncTime=null,this.currentVersion=null,this.syncInterval=36e5}async initialize(){if(this.isInitialized)return!0;try{if(!(await this.checkUserAuth()))return console.log("用户未登录，使用默认样式"),this.isInitialized=!0,!0;const e=await this.getCachedStyleVersion(),t=await this.getRemoteStyleVersion();if(e&&e===t)console.log("样式已是最新版本");else{console.log("检测到样式更新，开始同步...");await this.syncStyles()&&await this.setCachedStyleVersion(t)}return this.startPeriodicSync(),this.isInitialized=!0,this.lastSyncTime=Date.now(),!0}catch(e){return console.error("样式同步服务初始化失败:",e),this.isInitialized=!0,!1}}async checkUserAuth(){return!1}async getRemoteStyleVersion(){try{return"v1.0.0"}catch(e){return console.error("获取远程样式版本失败:",e),null}}async syncStyles(){try{return console.log("样式同步完成（模拟）"),!0}catch(e){return console.error("样式同步失败:",e),!1}}async manualSync(){console.log("开始手动同步样式...");try{const e=await this.getRemoteStyleVersion(),t=await this.getCachedStyleVersion();if(!e||e===t)return console.log("样式已是最新版本，无需同步"),!0;if(await this.syncStyles())return await this.setCachedStyleVersion(e),this.lastSyncTime=Date.now(),console.log("手动同步完成"),!0}catch(e){console.error("手动同步失败:",e)}return!1}startPeriodicSync(){this.syncTimer&&clearInterval(this.syncTimer),this.syncTimer=setInterval((async()=>{console.log("执行定时样式同步..."),await this.manualSync()}),this.syncInterval),console.log(`定时同步已启动，间隔: ${this.syncInterval/1e3/60} 分钟`)}stopPeriodicSync(){this.syncTimer&&(clearInterval(this.syncTimer),this.syncTimer=null,console.log("定时同步已停止"))}async getCachedStyleVersion(){try{return(await chrome.storage.local.get(["styleVersion"])).styleVersion||null}catch(e){return console.error("获取缓存样式版本失败:",e),null}}async setCachedStyleVersion(e){try{return await chrome.storage.local.set({styleVersion:e}),this.currentVersion=e,!0}catch(t){return console.error("设置缓存样式版本失败:",t),!1}}async cacheStyles(e){try{return await chrome.storage.local.set({userStyles:e,stylesCacheTime:Date.now()}),!0}catch(t){return console.error("缓存样式数据失败:",t),!1}}async getCachedStyles(){try{const e=await chrome.storage.local.get(["userStyles","stylesCacheTime"]),t=864e5;return e.stylesCacheTime&&Date.now()-e.stylesCacheTime>t?(console.log("样式缓存已过期"),null):e.userStyles||null}catch(e){return console.error("获取缓存样式数据失败:",e),null}}async clearCache(){try{return await chrome.storage.local.remove(["styleVersion","userStyles","stylesCacheTime"]),this.currentVersion=null,this.lastSyncTime=null,console.log("样式缓存已清除"),!0}catch(e){return console.error("清除样式缓存失败:",e),!1}}getSyncStatus(){return{isInitialized:this.isInitialized,currentVersion:this.currentVersion,lastSyncTime:this.lastSyncTime,isPeriodicSyncActive:!!this.syncTimer}}destroy(){this.stopPeriodicSync(),this.isInitialized=!1,this.currentVersion=null,this.lastSyncTime=null}},d={paragraph:{tag:"p",className:"flow-paragraph",styles:{margin:"0 0 16px 0","line-height":"1.6",color:"#333","font-size":"16px"}},header:{h1:{tag:"h1",className:"flow-header-1",styles:{"font-size":"32px","font-weight":"bold",margin:"0 0 24px 0","line-height":"1.2",color:"#1a1a1a"}},h2:{tag:"h2",className:"flow-header-2",styles:{"font-size":"24px","font-weight":"bold",margin:"0 0 20px 0","line-height":"1.3",color:"#1a1a1a"}},h3:{tag:"h3",className:"flow-header-3",styles:{"font-size":"20px","font-weight":"bold",margin:"0 0 16px 0","line-height":"1.4",color:"#1a1a1a"}}},list:{tag:"ul",className:"flow-list",styles:{margin:"0 0 16px 0","padding-left":"20px"},itemStyles:{margin:"0 0 8px 0","line-height":"1.6"}},quote:{tag:"blockquote",className:"flow-quote",styles:{margin:"0 0 16px 0",padding:"16px 20px","border-left":"4px solid #e0e0e0","background-color":"#f9f9f9","font-style":"italic",color:"#666"}},code:{tag:"pre",className:"flow-code",styles:{margin:"0 0 16px 0",padding:"16px","background-color":"#f5f5f5",border:"1px solid #e0e0e0","border-radius":"4px","font-family":'Monaco, Consolas, "Courier New", monospace',"font-size":"14px","overflow-x":"auto"}}};let h=new Map,y=!1;const p=new class{constructor(){this.styles={...d},this.remoteStyleUrl=null,this.cacheExpiry=a.get("cacheExpiry")}setRemoteStyleUrl(e){this.remoteStyleUrl=e}getBlockStyle(e,t={}){switch(e){case"paragraph":default:return this.styles.paragraph;case"header":const e=t.level||1;return this.styles.header[`h${e}`]||this.styles.header.h1;case"list":return this.styles.list;case"quote":return this.styles.quote;case"code":return this.styles.code}}async loadRemoteStyles(){try{const e=await c.getCachedStyles();if(e)return this.mergeStyles(e),y=!0,console.log("使用样式同步服务缓存的样式"),!0;if(this.remoteStyleUrl){const e=`${i.prefix}${this.remoteStyleUrl}`,t=this.getCachedStyles(e);if(t)return this.mergeStyles(t),y=!0,console.log("使用本地缓存的远程样式"),!0}if(!this.remoteStyleUrl)return console.warn("远程样式URL未设置，无法同步样式"),!1;console.log("触发样式同步...");if(await c.manualSync()){const e=await c.getCachedStyles();if(e)return this.mergeStyles(e),y=!0,!0}return console.warn("无法获取远程样式，将使用默认样式"),!1}catch(e){return console.error("加载远程样式失败:",e),!1}}mergeStyles(e){this.styles={...this.styles,...e}}validateStyleFormat(e){if(!e||"object"!=typeof e)return!1;if(!l.requiredBlockTypes.every((t=>e[t])))return!1;const t=e=>{if(!e||"object"!=typeof e)return!0;for(const[t,n]of Object.entries(e)){if(l.forbiddenCssProperties.some((e=>t.toLowerCase().includes(e.toLowerCase()))))return!1;if("string"==typeof n&&n.length>l.maxCssValueLength)return!1}return!0},n=e=>{for(const o of Object.values(e))if(o&&"object"==typeof o){if(o.styles&&!t(o.styles))return!1;if(!n(o))return!1}return!0};return n(e)}getCachedStyles(e){const t=h.get(e);return t&&Date.now()-t.timestamp<i.expiry?t.data:null}setCachedStyles(e,t){h.set(e,{data:t,timestamp:Date.now()})}clearCache(){h.clear(),y=!1}getAllStyles(){return this.styles}isRemoteStylesLoaded(){return y}async initialize(){try{await c.initialize();const e=await c.getCachedStyles();return e?(this.mergeStyles(e),y=!0,console.log("样式管理器初始化完成，已加载缓存样式")):console.log("样式管理器初始化完成，使用默认样式"),!0}catch(e){return console.error("样式管理器初始化失败:",e),!1}}};const u=new class{constructor(){this.processors={paragraph:this.processParagraph.bind(this),header:this.processHeader.bind(this),list:this.processList.bind(this),quote:this.processQuote.bind(this),code:this.processCode.bind(this),delimiter:this.processDelimiter.bind(this),image:this.processImage.bind(this),table:this.processTable.bind(this)}}processBlock(e){if(!e||!e.type)return console.warn("无效的块数据:",e),this.createEmptyBlock();const t=this.processors[e.type];if(!t)return console.warn(`未知的块类型: ${e.type}`),this.processParagraph(e);try{return t(e)}catch(n){return console.error(`处理块失败 (${e.type}):`,n),this.createEmptyBlock()}}processParagraph(e){const t=(e.data||{}).text||"",n=p.getBlockStyle("paragraph");return{type:"paragraph",tag:n.tag,className:n.className,styles:n.styles,content:this.sanitizeText(t),isEmpty:!t.trim()}}processHeader(e){const t=e.data||{},n=t.text||"",o=Math.min(Math.max(t.level||1,1),6),s=p.getBlockStyle("header",{level:o});return{type:"header",level:o,tag:s.tag,className:s.className,styles:s.styles,content:this.sanitizeText(n),isEmpty:!n.trim()}}processList(e){const t=e.data||{},n=t.items||[],o=t.style||"unordered",s=p.getBlockStyle("list"),r=n.map((e=>({content:this.sanitizeText(e),isEmpty:!e.trim()})));return{type:"list",listStyle:o,tag:"ordered"===o?"ol":"ul",className:s.className,styles:s.styles,itemStyles:s.itemStyles,items:r,isEmpty:0===r.length||r.every((e=>e.isEmpty))}}processQuote(e){const t=e.data||{},n=t.text||"",o=t.caption||"",s=p.getBlockStyle("quote");return{type:"quote",tag:s.tag,className:s.className,styles:s.styles,content:this.sanitizeText(n),caption:this.sanitizeText(o),isEmpty:!n.trim()}}processCode(e){const t=(e.data||{}).code||"",n=p.getBlockStyle("code");return{type:"code",tag:n.tag,className:n.className,styles:n.styles,content:this.escapeHtml(t),isEmpty:!t.trim()}}processDelimiter(e){return{type:"delimiter",tag:"hr",className:"flow-delimiter",styles:{margin:"32px 0",border:"none","border-top":"1px solid #e0e0e0",height:"1px"},content:"",isEmpty:!1}}processImage(e){var t;const n=e.data||{},o=(null==(t=n.file)?void 0:t.url)||n.url||"",s=n.caption||"",r=n.withBorder||!1,i=n.withBackground||!1,l=n.stretched||!1;return{type:"image",tag:"figure",className:"flow-image",styles:{margin:"0 0 16px 0","text-align":"center"},url:o,caption:this.sanitizeText(s),withBorder:r,withBackground:i,stretched:l,isEmpty:!o}}processTable(e){const t=e.data||{},n=t.content||[],o=t.withHeadings||!1,s=n.map((e=>e.map((e=>this.sanitizeText(e)))));return{type:"table",tag:"table",className:"flow-table",styles:{margin:"0 0 16px 0","border-collapse":"collapse",width:"100%",border:"1px solid #e0e0e0"},content:s,withHeadings:o,isEmpty:0===s.length}}createEmptyBlock(){return{type:"paragraph",tag:"p",className:"flow-paragraph",styles:{},content:"",isEmpty:!0}}sanitizeText(e){if("string"!=typeof e)return"";const t=["b","i","u","strong","em","mark","code","a"];return e.replace(/<\/?([a-zA-Z][a-zA-Z0-9]*)\b[^>]*>/g,((e,n)=>t.includes(n.toLowerCase())?e:""))}escapeHtml(e){if("string"!=typeof e)return"";const t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};return e.replace(/[&<>"']/g,(e=>t[e]))}processBlocks(e){return Array.isArray(e)?e.map((e=>this.processBlock(e))).filter((e=>e)):(console.warn("blocks必须是数组"),[])}registerProcessor(e,t){"function"==typeof t?this.processors[e]=t:console.warn("处理器必须是函数")}};const g=new class{constructor(){this.generators={paragraph:this.generateParagraph.bind(this),header:this.generateHeader.bind(this)}}generateBlockHtml(e){if(!e||e.isEmpty)return"";const t=this.generators[e.type];if(!t)return console.warn(`未知的块类型: ${e.type}`),this.generateParagraph(e);try{return`<section>${t(e)}</section>`}catch(n){return console.error(`生成HTML失败 (${e.type}):`,n),""}}generateParagraph(e){const{content:t}=e;return`<span leaf="">${t}</span>`}generateHeader(e){const{tag:t,className:n,content:o}=e;return`<${t} class="${n}">${o}</${t}>`}async generateHTML(e,t={}){const{skipEmpty:n=!0}=t;return u.processBlocks(e).map((e=>this.generateBlockHtml(e))).filter((e=>!n||e.trim())).join("\n")}registerGenerator(e,t){"function"==typeof t?this.generators[e]=t:console.warn("生成器必须是函数")}};async function f(e,s={}){try{const{targetSelector:r=t.editor,append:i=!0,insertPosition:l="cursor",styleOptions:a={}}=s,c=await g.generateHTML(e,{...a}),d=await async function(e,t={}){const{targetSelector:s='div[contenteditable="true"].ProseMirror',append:r=!0,insertPosition:i="cursor"}=t;try{const t=o(s);if(!t)return console.error("找不到目标编辑器:",s),!1;const l=n("div",{innerHTML:e});return l.querySelectorAll("section").forEach((e=>{if(r)t.appendChild(e.cloneNode(!0));else switch(i){case"start":t.insertBefore(e.cloneNode(!0),t.firstChild);break;case"end":t.appendChild(e.cloneNode(!0));break;default:t.innerHTML="",t.appendChild(e.cloneNode(!0))}})),console.log("内容插入成功"),!0}catch(l){return console.error("插入内容失败:",l),!1}}(c,{targetSelector:r,append:i,insertPosition:l});return d}catch(r){return console.error("保存到原编辑器失败:",r),!1}}function m(){return!!(window.EditorJS&&window.Paragraph&&window.Header)}async function w(e,t){if(!m())try{await new Promise(((e,t)=>{chrome.runtime.sendMessage("inject_editorjs_bundle",(n=>{n&&"injected"===n.status?setTimeout((()=>{m()?e():t(new Error("编辑器脚本加载失败"))}),100):t(new Error("编辑器注入失败"))}))}))}catch(n){throw new Error("编辑器加载失败: "+n.message)}return function(e,t){if(!document.getElementById(e))throw new Error(`${e}元素不存在，请检查DOM结构`);try{return new EditorJS({holder:e,tools:{paragraph:{class:Paragraph,inlineToolbar:!0},header:{class:Header,inlineToolbar:!0,config:{placeholder:t.tools.header.placeholder,levels:t.tools.header.levels,defaultLevel:t.tools.header.defaultLevel}}},data:{time:Date.now(),blocks:[{type:"paragraph",data:{text:"使用editor.js开始编写您的内容..."}}],version:"2.28.2"},placeholder:t.placeholder})}catch(n){throw console.error("编辑器初始化失败:",n),n}}(e,t)}let b=null,x={},S=[],k=null;async function v(){if(b)return void console.warn("智能编辑器已经激活");const s=o(t.editor);if(s)try{x=function(e){const t={};return e.forEach((e=>{const n=document.getElementById(e);n&&(t[e]=n.style.display,n.style.display="none")})),t}(["ueditor_0","article_setting_area"]),S=function(){const e=document.getElementById(t.buttonArea.replace("#",""));if(!e)return[];const n=Array.from(e.children),o=n.map((e=>({element:e,display:e.style.display})));return n.forEach((e=>{e.style.display="none"})),o}(),function(e){const t=n("div",{id:"smart-editor-container",className:"flowedit-editor-container"}),s=o("#edui1_iframeholder");s?s.appendChild(t):e.parentNode.insertBefore(t,e.nextSibling);const r=n("div",{id:"editor-holder",className:"flowedit-editor-holder"});t.appendChild(r),console.log("智能编辑器界面创建完成")}(s),k=function(e={}){const{onSave:s,onCancel:r}=e,i=n("div",{className:"flowedit-editor-action-bar"}),l=n("button",{textContent:"💾 保存",className:"flowedit-editor-save-btn"}),a=n("button",{textContent:"↩️ 取消",className:"flowedit-editor-cancel-btn"});i.appendChild(l),i.appendChild(a);const c=o(t.buttonArea);return c?c.appendChild(i):(console.warn("找不到按钮区域，将控制栏添加到body"),document.body.appendChild(i)),s&&"function"==typeof s&&l.addEventListener("click",s),r&&"function"==typeof r&&a.addEventListener("click",r),console.log("智能编辑器控制栏创建完成"),i}({onSave:E,onCancel:C}),await new Promise((e=>setTimeout(e,50))),b=await w("editor-holder",e.editor),console.log("智能编辑器激活成功")}catch(r){console.error("智能插入功能启动失败:",r),alert("智能插入功能启动失败"),C()}else alert("找不到编辑器容器")}function C(){var e,t;S.length>0&&(S.forEach((({element:e,display:t})=>{e.style.display=t})),S=[]),Object.keys(x).length>0&&(e=x,Object.entries(e).forEach((([e,t])=>{const n=document.getElementById(e);n&&(n.style.display=t)})),x={}),function(){const e=document.getElementById("smart-editor-container");e&&(e.remove(),console.log("智能编辑器界面已移除"))}(),k&&((t=k)&&(t.remove(),console.log("智能编辑器控制栏已移除")),k=null),b&&(!function(e){if(e)try{e.destroy()}catch(t){console.warn("编辑器销毁错误:",t)}}(b),b=null),console.log("智能编辑器已停用")}async function E(e={}){if(b)try{const t=await b.save();console.log("保存的数据:",t);await f(t.blocks,{usePreloadedStyles:!0,...e})?console.log("内容已成功保存到原编辑器"):console.error("保存到原编辑器失败")}catch(t){console.error("保存失败:",t)}finally{C()}else console.error("编辑器未初始化")}async function z(){try{await v()}catch(e){console.error("智能插入按钮点击处理失败:",e)}}function T(e){const n=document.querySelector(t.sidebar);if(n){const t="none"===n.style.display;n.style.display=t?"":"none";const o=e.currentTarget;t?o.classList.add("on"):o.classList.remove("on")}}function N(){const e=o(t.toolbar);if(!e)return console.debug("找不到工具栏区域，可能页面未登录"),!1;const s=function(){const e=n("button",{className:"flowedit-switch",innerHTML:'\n      <div class="flowedit-switch-track"></div>\n      <div class="flowedit-switch-thumb"></div>\n    '});return e.addEventListener("click",T),e}(),r=o(t.sidebar);s&&r?e.firstElementChild?e.insertBefore(s,e.firstElementChild):e.appendChild(s):console.warn("侧边栏切换按钮初始化失败：缺少必要的DOM元素");const i=function(){const e=n("button",{className:"flowedit-btn flowedit-smart-btn",textContent:"智能插入"});return e.addEventListener("click",z),e}(),l=o(t.sidebar);return i&&l?e.appendChild(i):console.warn("智能插入按钮初始化失败：缺少必要的DOM元素"),!0}const B=new class{constructor(){this.config={},this.initialized=!1}async initialize(){try{console.log("初始化用户配置管理器..."),this.initialized=!0,console.log("用户配置管理器初始化完成")}catch(e){throw console.error("用户配置管理器初始化失败:",e),e}}getUserConfig(e){return this.initialized?e?this.config[e]:this.config:(console.warn("用户配置管理器未初始化"),null)}async setUserConfig(e,t){try{return this.initialized?("object"==typeof e?this.config={...this.config,...e}:this.config[e]=t,console.log("用户配置已更新:",e),!0):(console.warn("用户配置管理器未初始化"),!1)}catch(n){return console.error("设置用户配置失败:",n),!1}}},I=new class{constructor(){this.initialized=!1,this.styleCache={},this.syncInterval=null}async initialize(){try{console.log("初始化远程样式同步服务..."),this.initialized=!0,console.log("远程样式同步服务初始化完成")}catch(e){throw console.error("远程样式同步服务初始化失败:",e),e}}async manualSync(){try{return this.initialized?(console.log("开始手动同步远程样式..."),console.log("远程样式同步完成"),!0):(console.warn("远程样式同步服务未初始化"),!1)}catch(e){return console.error("远程样式同步失败:",e),!1}}startAutoSync(e=3e4){this.syncInterval&&clearInterval(this.syncInterval),this.syncInterval=setInterval((async()=>{await this.manualSync()}),e),console.log(`远程样式自动同步已启动，间隔: ${e}ms`)}stopAutoSync(){this.syncInterval&&(clearInterval(this.syncInterval),this.syncInterval=null,console.log("远程样式自动同步已停止"))}};async function L(e={}){try{return console.log("开始初始化FlowEdit应用服务..."),await B.initialize(),await async function(e={}){try{if(await I.initialize(),!1!==e.enableAutoSync){const t=e.syncInterval||3e4;I.startAutoSync(t)}!1!==e.initialSync&&await I.manualSync(),console.log("远程样式系统初始化完成")}catch(t){console.error("远程样式系统初始化失败:",t)}}(e),console.log("FlowEdit应用服务初始化完成"),!0}catch(t){return console.error("FlowEdit应用服务初始化失败:",t),!1}}async function M(){N()?(!function(){const e="flow-editor-plugin-styles";if(!document.getElementById(e)){const t=document.createElement("style");t.id=e,t.setAttribute("data-flowedit-plugin-ui","true"),t.textContent="\n      /* FlowEdit 插件UI样式 */\n      \n  /* 扩展按钮基础样式 */\n  .flowedit-btn {\n    display: inline-block;\n    height: 22px;\n    margin: 1px 4px;\n    vertical-align: middle;\n    cursor: pointer;\n    border: none;\n    outline: none;\n    box-sizing: border-box;\n  }\n  \n  /* 智能插入按钮样式 */\n  .flowedit-smart-btn {\n    background-color: #07c160;\n    color: white;\n    border-radius: 4px;\n    padding: 0 12px;\n    font-size: 12px;\n    line-height: 22px;\n    transition: all 0.3s ease;\n  }\n  \n  /* 智能插入按钮悬浮效果 */\n  .flowedit-smart-btn:hover {\n    background-color: #07c160;\n    background-image: linear-gradient(to bottom, #07C160 0, #07C160 100%);\n    border-color: #07C160;\n    color: #FFFFFF;\n    transform: translateY(-1px);\n    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n  }\n\n      \n  /* Switch开关样式 */\n  .flowedit-switch {\n    display: inline-block;\n    height: 22px;\n    margin: 1px 4px;\n    vertical-align: middle;\n    cursor: pointer;\n    position: relative;\n    width: 40px;\n    border: none;\n    outline: none;\n    box-sizing: border-box;\n  }\n  \n  .flowedit-switch-track {\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    background-color: #ccc;\n    border-radius: 11px;\n    transition: all 0.3s ease;\n  }\n  \n  .flowedit-switch-thumb {\n    position: absolute;\n    width: 18px;\n    height: 18px;\n    left: 2px;\n    bottom: 2px;\n    background-color: white;\n    border-radius: 50%;\n    transition: transform 0.3s ease;\n  }\n  \n  .flowedit-switch.on .flowedit-switch-track {\n    background-color: #07c160;\n  }\n  \n  .flowedit-switch.on .flowedit-switch-thumb {\n    transform: translateX(18px);\n  }\n\n      \n  /* 智能插入编辑器容器样式 */\n  .flowedit-editor-container {\n    position: absolute;\n    top: 0;\n    left: 0;\n    z-index: 1;\n    width: calc(100% + 8px);\n    box-sizing: content-box;\n    margin-left: -95px;\n    padding: 0 91px;\n    background: #fff;\n  }\n  \n  /* 智能插入编辑器占位元素样式 */\n  .flowedit-editor-holder {\n    margin-left: -95px;\n    padding: 0 91px;\n  }\n  \n  /* 智能插入控制栏样式 */\n  .flowedit-editor-action-bar {\n    padding: 20px 20px 15px 20px;\n    margin: 0;\n    background-color: #ffffff;\n    color: rgb(53, 53, 53);\n    font-family: mp-quote, 'PingFang SC', system-ui, -apple-system, BlinkMacSystemFont, 'Helvetica Neue', 'Hiragino Sans GB', 'Microsoft YaHei UI', 'Microsoft YaHei', Arial, sans-serif;\n    font-size: 14px;\n    line-height: 22.4px;\n    word-break: break-all;\n    box-sizing: content-box;\n    display: flex;\n    justify-content: flex-end;\n    gap: 10px;\n    z-index: 1000;\n  }\n  \n  /* 智能插入保存按钮样式 */\n  .flowedit-editor-save-btn {\n    padding: 4px 12px;\n    height: 34px;\n    width: 98px;\n    display: inline-block;\n    background: #07c160;\n    color: white;\n    border: none;\n    border-radius: 4px;\n    cursor: pointer;\n    font-size: 14px;\n    transition: all 0.3s ease;\n  }\n  \n  /* 智能插入保存按钮悬浮效果 */\n  .flowedit-editor-save-btn:hover {\n    background-color: #07c160;\n    background-image: linear-gradient(to bottom, #07C160 0, #07C160 100%);\n    border-color: #07C160;\n    color: #FFFFFF;\n    transform: translateY(-1px);\n    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n  }\n  \n  /* 智能插入取消按钮样式 */\n  .flowedit-editor-cancel-btn {\n    padding: 4px 12px;\n    height: 34px;\n    width: 98px;\n    display: inline-block;\n    background: #999999;\n    color: white;\n    border: none;\n    border-radius: 4px;\n    cursor: pointer;\n    font-size: 14px;\n    transition: all 0.3s ease;\n  }\n  \n  /* 智能插入取消按钮悬浮效果 */\n  .flowedit-editor-cancel-btn:hover {\n    background-color: #e7e7eb;\n    background-image: linear-gradient(to bottom, #E7E7EB 0, #E7E7EB 100%);\n    border-color: #DADBE0;\n    box-shadow: none;\n    -moz-box-shadow: none;\n    -webkit-box-shadow: none;\n    color: #353535;\n    transform: translateY(-1px);\n  }\n\n    ",document.head.appendChild(t),console.log("FlowEdit 插件UI样式已注入")}}(),console.log("FlowEdit 插件功能模块初始化完成")):console.log("FlowEdit 插件功能模块初始化失败：页面可能未登录")}(async function(){console.log("FlowEdit 内容脚本启动"),"loading"===document.readyState&&await new Promise((e=>{document.addEventListener("DOMContentLoaded",e)}));try{await L(),console.log("FlowEdit 应用服务初始化成功")}catch(e){console.error("FlowEdit 应用服务初始化失败:",e)}await M()})().catch((e=>{console.error("FlowEdit 启动失败:",e)}))}();
